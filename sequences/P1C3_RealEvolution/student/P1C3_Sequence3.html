
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>1.3.3: Competition and Interaction Transform Optimization into Game Theory — Modern Foundations of Neuroscience</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
<link href="../../../genindex.html" rel="index" title="Index">
<link href="../../../search.html" rel="search" title="Search"/>
<link href="P1C3_Sequence4.html" rel="next" title="1.3.4: Learning and Evolution"/>
<link href="P1C3_Sequence2.html" rel="prev" title="1.3.2: Why Sex"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<h1 class="site-logo" id="site-title">Modern Foundations of Neuroscience</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Behaviour, Environments and Optimization, Evolution and Learning
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../P1C1_BehaviourAsPolicy/student/P1C1_Title.html">
   Behaviour As Policy (P1C1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../P1C1_BehaviourAsPolicy/student/P1C1_Sequence1.html">
<strong>
      1.1.1: Gridworld Introduction
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../P1C1_BehaviourAsPolicy/student/P1C1_Sequence2.html">
<strong>
      1.1.2: Thinking of What Receptors and Muscles Do as a Policy
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../P1C1_BehaviourAsPolicy/student/P1C1_Sequence3.html">
<strong>
      1.1.3: Abstraction and Reasoning with Policies
     </strong>
</a>
</li>
</ul>
</input></li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../P1C2_OptimizationAndEnvironment/student/P1C2_Title.html">
   Optimization And Environment (P1C2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../P1C2_OptimizationAndEnvironment/student/P1C2_Sequence1.html">
<strong>
      1.2.1: Optimization Makes you Better
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../P1C2_OptimizationAndEnvironment/student/P1C2_Sequence2.html">
<strong>
      1.2.2: What’s Good Depends on the Niche
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../P1C2_OptimizationAndEnvironment/student/P1C2_Sequence3.html">
<strong>
      1.2.3: Normative Thinking
     </strong>
</a>
</li>
</ul>
</input></li>
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="P1C3_Title.html">
   Real Evolution (P1C3)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="P1C3_Sequence1.html">
<strong>
      1.3.1: Populations and Inheritance
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="P1C3_Sequence2.html">
<strong>
      1.3.2: Why Sex
     </strong>
</a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
<strong>
      1.3.3: Competition and Interaction Transform Optimization into Game Theory
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="P1C3_Sequence4.html">
<strong>
      1.3.4: Learning and Evolution
     </strong>
</a>
</li>
</ul>
</input></li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../P1C4_LifeIsRL/student/P1C4_Title.html">
   Life Is RL (P1C4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../P1C4_LifeIsRL/student/P1C4_Sequence1.html">
<strong>
      1.4.1: Thinking of Life as a Markov Decision Process
     </strong>
</a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Supervised Learning
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../P2C1_Optimization/student/P2C1_Title.html">
   Optimization (P2C1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../P2C1_Optimization/student/P2C1_Sequence1.html">
<strong>
      2.1.1: Optimization in One Dimension: Developing Intuition
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../P2C1_Optimization/student/P2C1_Sequence2.html">
<strong>
      2.1.2: Optimization in Two Dimensions: Estimating Gradients
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../P2C1_Optimization/student/P2C1_Sequence3.html">
<strong>
      2.1.3: Optimization in Higher Dimensions: The Need for Speed
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../P2C1_Optimization/student/P2C1_Sequence4.html">
<strong>
      2.1.4: Learning Behaviour as a Form of High Dimensional Optimization
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../P2C1_Optimization/student/P2C1_Sequence5.html">
<strong>
      2.1.5: Learning Behaviour Quickly
     </strong>
</a>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/dcownden/PerennialProblemsOfLifeWithABrain" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/dcownden/PerennialProblemsOfLifeWithABrain/issues/new?title=Issue%20on%20page%20%2Fsequences/P1C3_RealEvolution/student/P1C3_Sequence3.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../../_sources/sequences/P1C3_RealEvolution/student/P1C3_Sequence3.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
<strong>
    1.3.3: Competition and Interaction Transform Optimization into Game Theory
   </strong>
</a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#objective">
     Objective:
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#dependencies-imports-and-setup">
     Dependencies, Imports and Setup
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#eat-and-be-eaten">
   1.3.3.1: Eat and Be Eaten
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interaction-try-to-eat-the-critter">
     Interaction: Try to Eat the Critter
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interaction-try-to-eat-food-and-not-get-eaten">
     Interaction: Try to Eat Food and Not Get Eaten
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interaction-play-as-both-predator-and-prey">
     Interaction: Play as Both Predator and Prey
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#simulation-watch-random-predator-and-prey">
   Simulation: Watch Random Predator and Prey
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#optimize-the-prey-optimize-the-predator">
   1.3.3.2: Optimize the Prey, Optimize the Predator
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-implement-predator-and-prey-policies">
     Coding Exercise: Implement Predator and Prey Policies
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#todo-algo-box-covariance-matrix-adaptation-evolutionary-strategy-cma-es">
<strong>
      TODO
     </strong>
     Algo Box: Covariance Matrix Adaptation Evolutionary Strategy (CMA-ES)
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#simulation-optimized-prey-policy-when-the-predator-drifts-randomly">
     Simulation: Optimized Prey Policy When the Predator Drifts Randomly
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#simulation-optimized-predator-policy-when-the-prey-drifts-randomly">
     Simulation: Optimized Predator Policy When the Prey Drifts Randomly
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#prey-and-predator-co-evolve">
   1.3.3.3: Prey and Predator Co-Evolve
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#simulation-co-optimized-prey-and-predator-policies">
     Simulation: Co-Optimized Prey and Predator Policies
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#todo-bio-box-evolutionarily-stable-strategy-ess-refines-nash-equilibria-for-evolutionary-settings">
<strong>
      TODO
     </strong>
     Bio Box: Evolutionarily Stable Strategy (ESS) Refines Nash Equilibria for Evolutionary Settings.
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#quiz">
   Quiz
  </a>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>1.3.3: Competition and Interaction Transform Optimization into Game Theory</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
<strong>
    1.3.3: Competition and Interaction Transform Optimization into Game Theory
   </strong>
</a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#objective">
     Objective:
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#dependencies-imports-and-setup">
     Dependencies, Imports and Setup
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#eat-and-be-eaten">
   1.3.3.1: Eat and Be Eaten
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interaction-try-to-eat-the-critter">
     Interaction: Try to Eat the Critter
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interaction-try-to-eat-food-and-not-get-eaten">
     Interaction: Try to Eat Food and Not Get Eaten
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interaction-play-as-both-predator-and-prey">
     Interaction: Play as Both Predator and Prey
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#simulation-watch-random-predator-and-prey">
   Simulation: Watch Random Predator and Prey
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#optimize-the-prey-optimize-the-predator">
   1.3.3.2: Optimize the Prey, Optimize the Predator
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-implement-predator-and-prey-policies">
     Coding Exercise: Implement Predator and Prey Policies
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#todo-algo-box-covariance-matrix-adaptation-evolutionary-strategy-cma-es">
<strong>
      TODO
     </strong>
     Algo Box: Covariance Matrix Adaptation Evolutionary Strategy (CMA-ES)
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#simulation-optimized-prey-policy-when-the-predator-drifts-randomly">
     Simulation: Optimized Prey Policy When the Predator Drifts Randomly
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#simulation-optimized-predator-policy-when-the-prey-drifts-randomly">
     Simulation: Optimized Predator Policy When the Prey Drifts Randomly
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#prey-and-predator-co-evolve">
   1.3.3.3: Prey and Predator Co-Evolve
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#simulation-co-optimized-prey-and-predator-policies">
     Simulation: Co-Optimized Prey and Predator Policies
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#todo-bio-box-evolutionarily-stable-strategy-ess-refines-nash-equilibria-for-evolutionary-settings">
<strong>
      TODO
     </strong>
     Bio Box: Evolutionarily Stable Strategy (ESS) Refines Nash Equilibria for Evolutionary Settings.
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#quiz">
   Quiz
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<p><a href="https://colab.research.google.com/github/dcownden/PerennialProblemsOfLifeWithABrain/blob/main/sequences/P1C3_RealEvolution/student/P1C3_Sequence3.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/dcownden/PerennialProblemsOfLifeWithABrain/main/sequences/P1C3_RealEvolution/student/P1C3_Sequence3.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg"/></a></p>
<p>The following is part of a test for an upcoming text book on computational neuroscience from an optimization and learning perspective. The book will start with evolution because ultimately, all aspects of the brain are shaped by evolution and, as we will see, evolution can also be seen as an optimization algorithm. We are sharing it now to get feedback on what works and what does not and the developments we should do.</p>
<hr class="docutils"/>
<div class="section" id="competition-and-interaction-transform-optimization-into-game-theory">
<h1><strong>1.3.3: Competition and Interaction Transform Optimization into Game Theory</strong><a class="headerlink" href="#competition-and-interaction-transform-optimization-into-game-theory" title="Permalink to this headline">¶</a></h1>
<div class="section" id="objective">
<h2>Objective:<a class="headerlink" href="#objective" title="Permalink to this headline">¶</a></h2>
<p>In the last chapter we saw how alignment with environmental context is key to the effectiveness of a policy and how a changing environment thus creates a challenge to producing effective behaviour. In this sequence we will expand on this theme by considering a major source of ‘environmental’ variation: the adaptive behaviours of other organisms. One organism’s policy is another organism’s environment! In this sequence you will:</p>
<ul class="simple">
<li><p>Extend our ‘propose-accept-reject’ algorithm and our basic ‘Parameterized Weights’ policy function to allow different organisms to adapt to each other’s behaviour in a shared environment.</p></li>
<li><p>Investigate this mutual behaviour adaption process in a scenario where organisms play by fundamentally different rules, in this case a prey organism trying to eat plants and avoid being eaten, and a predator trying to consume the prey.</p></li>
<li><p>Learn a tiny bit about Nash Equilibria and how they relate to optimization, dynamical systems and evolution.</p></li>
</ul>
</div>
</div>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<p>Run the following cell to setup and install the various dependencies and helper functions for this .</p>
<div class="section" id="dependencies-imports-and-setup">
<h2>Dependencies, Imports and Setup<a class="headerlink" href="#dependencies-imports-and-setup" title="Permalink to this headline">¶</a></h2>
<p>You don’t need to worry about how this code works – but you do need to <strong>run the cell</strong></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Dependencies, Imports and Setup</span>
<span class="c1"># @markdown You don't need to worry about how this code works – but you do need to **run the cell**</span>

<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>ipympl<span class="w"> </span>vibecheck<span class="w"> </span>datatops<span class="w"> </span>jupyterquiz<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span>#google.colab

<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">requests.exceptions</span> <span class="kn">import</span> <span class="n">RequestException</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
<span class="kn">from</span> <span class="nn">matplotlib.animation</span> <span class="kn">import</span> <span class="n">FuncAnimation</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">cdist</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span><span class="p">,</span> <span class="n">Markdown</span><span class="p">,</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">jupyterquiz</span> <span class="kn">import</span> <span class="n">display_quiz</span>
<span class="kn">from</span> <span class="nn">vibecheck</span> <span class="kn">import</span> <span class="n">DatatopsContentReviewContainer</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>


<span class="c1"># random seed settings and</span>
<span class="c1"># getting torch to use gpu if it's there</span>


<span class="k">def</span> <span class="nf">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed_torch</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Function that controls randomness. NumPy and random modules must be imported.</span>

<span class="sd">  Args:</span>
<span class="sd">    seed : Integer</span>
<span class="sd">      A non-negative integer that defines the random state. Default is `None`.</span>
<span class="sd">    seed_torch : Boolean</span>
<span class="sd">      If `True` sets the random seed for pytorch tensors, so pytorch module</span>
<span class="sd">      must be imported. Default is `True`.</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>
  <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">seed_torch</span><span class="p">:</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed_all</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Random seed </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s1"> has been set.'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">seed_worker</span><span class="p">(</span><span class="n">worker_id</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  DataLoader will reseed workers following randomness in</span>
<span class="sd">  multi-process data loading algorithm.</span>

<span class="sd">  Args:</span>
<span class="sd">    worker_id: integer</span>
<span class="sd">      ID of subprocess to seed. 0 means that</span>
<span class="sd">      the data will be loaded in the main process</span>
<span class="sd">      Refer: https://pytorch.org/docs/stable/data.html#data-loading-randomness for more details</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">worker_seed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">initial_seed</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">set_device</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Set the device. CUDA if available, CPU otherwise</span>

<span class="sd">  Args:</span>
<span class="sd">    None</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">device</span> <span class="o">=</span> <span class="s2">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span>
  <span class="k">if</span> <span class="n">device</span> <span class="o">!=</span> <span class="s2">"cuda"</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"This notebook isn't using and doesn't need a GPU. Good."</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"GPU is enabled in this notebook but not needed."</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"If possible, in the menu under `Runtime` -&gt; "</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"`Change runtime type.`  select `CPU`"</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">device</span>


<span class="n">SEED</span> <span class="o">=</span> <span class="mi">2021</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">DEVICE</span> <span class="o">=</span> <span class="n">set_device</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">printmd</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
  <span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>


<span class="c1"># the different utility .py files used in this notebook</span>
<span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'gw_plotting.py'</span><span class="p">,</span> <span class="s1">'gw_board.py'</span><span class="p">,</span> <span class="s1">'gw_game.py'</span><span class="p">,</span>
             <span class="s1">'gw_widgets.py'</span><span class="p">,</span> <span class="s1">'gw_NN_RL.py'</span><span class="p">]</span>
<span class="c1">#filenames = []</span>
<span class="c1"># just run the code straight out of the response, no local copies needed!</span>
<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
  <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'https://raw.githubusercontent.com/dcownden/PerennialProblemsOfLifeWithABrain/main/utils/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">'</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
  <span class="c1"># Check that we got a valid response</span>
  <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="n">code</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="n">exec</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Failed to download </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>

<span class="c1"># environment contingent imports</span>
<span class="k">try</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'Running in colab'</span><span class="p">)</span>
  <span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">output</span>
  <span class="n">output</span><span class="o">.</span><span class="n">enable_custom_widget_manager</span><span class="p">()</span>
  <span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">data_table</span>
  <span class="n">data_table</span><span class="o">.</span><span class="n">disable_dataframe_formatter</span><span class="p">()</span>
  <span class="c1">#from google.colab import output as colab_output</span>
  <span class="c1">#colab_output.enable_custom_widget_manager()</span>
  <span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span><span class="p">:</span>
  <span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'Not running in colab'</span><span class="p">)</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="o">%</span><span class="k">matplotlib</span> widget
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/dcownden/PerennialProblemsOfLifeWithABrain/main/pplb.mplstyle"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span> <span class="c1">#need to use plt.show() or display explicitly</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">'matplotlib.font_manager'</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">content_review</span><span class="p">(</span><span class="n">notebook_section</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DatatopsContentReviewContainer</span><span class="p">(</span>
    <span class="s2">""</span><span class="p">,</span>  <span class="c1"># No text prompt</span>
    <span class="n">notebook_section</span><span class="p">,</span>
    <span class="p">{</span>
      <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"https://pmyvdlilci.execute-api.us-east-1.amazonaws.com/klab"</span><span class="p">,</span>
      <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"neuro_book"</span><span class="p">,</span>
      <span class="s2">"user_key"</span><span class="p">:</span> <span class="s2">"xuk960xj"</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="n">feedback_prefix</span> <span class="o">=</span> <span class="s2">"P1C3_S3"</span>




<span class="c1">################################################################</span>
<span class="c1"># refactor Monte Carlo for boards that support multiple critters</span>
<span class="c1">################################################################</span>




<span class="k">class</span> <span class="nc">MonteCarlo</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Implementation of Monte Carlo Algorithm</span>
<span class="sd">  """</span>


  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">nnet</span><span class="p">,</span> <span class="n">default_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Initialize Monte Carlo Parameters</span>

<span class="sd">    Args:</span>
<span class="sd">      game: Gridworld Game instance</span>
<span class="sd">        Instance of the gridworldGame class above;</span>
<span class="sd">      nnet: gridworldNet instance</span>
<span class="sd">        Instance of the gridworldNNet class above;</span>
<span class="sd">      args: dictionary</span>
<span class="sd">        Instantiates number of iterations and episodes, controls temperature threshold, queue length,</span>
<span class="sd">        arena, checkpointing, and neural network parameters:</span>
<span class="sd">        learning-rate: 0.001, dropout: 0.3, epochs: 10, batch_size: 64,</span>
<span class="sd">        num_channels: 512</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span> <span class="o">=</span> <span class="n">nnet</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_depth</span> <span class="o">=</span> <span class="n">default_depth</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_seed</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">pis_vs_from_board</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="p">):</span>
    <span class="c1">#helper function, to put board in canonical form that nn was trained on</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">co_pieces</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">this_critter_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">co_pieces</span> <span class="o">==</span> <span class="n">critter</span><span class="p">)</span>
    <span class="n">all_critter_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">co_pieces</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># other critters are invisible to this player</span>
    <span class="n">co_pieces</span><span class="p">[</span><span class="n">all_critter_locs</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># nnet trained to see self as 1</span>
    <span class="n">co_pieces</span><span class="p">[</span><span class="n">this_critter_locs</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">scalar_rounds_left</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">co_rounds_left</span> <span class="o">=</span> <span class="n">scalar_rounds_left</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">num_critters</span>
    <span class="k">if</span> <span class="n">critter</span><span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">scalar_rounds_left</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">num_critters</span><span class="p">:</span>
       <span class="c1"># add an extra if we haven't had this players turn yet in the round cycle</span>
       <span class="n">co_rounds_left</span> <span class="o">=</span> <span class="n">co_rounds_left</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">co_rounds_left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">co_rounds_left</span><span class="p">]</span><span class="o">*</span><span class="n">batch_size</span><span class="p">)</span>
    <span class="n">pis</span><span class="p">,</span> <span class="n">vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">co_pieces</span><span class="p">,</span>
                                <span class="n">board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][:,</span><span class="n">critter</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                <span class="n">co_rounds_left</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pis</span><span class="p">,</span> <span class="n">vs</span>


  <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">action_indexes</span><span class="p">,</span> <span class="n">critter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Helper function to simulate one Monte Carlo rollout</span>

<span class="sd">    Args:</span>
<span class="sd">      board: triple (batch_size x x_size x y_size np.array of board position,</span>
<span class="sd">                     scalar of current score,</span>
<span class="sd">                     scalar of rounds left</span>
<span class="sd">      actions: batch size list/array of integer indexes for moves on each board</span>
<span class="sd">      these are assumed to be legal, no check for validity of moves</span>
<span class="sd">    Returns:</span>
<span class="sd">      temp_v:</span>
<span class="sd">        Terminal State</span>
<span class="sd">    """</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">x_size</span><span class="p">,</span> <span class="n">y_size</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">next_board</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_next_state</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="p">,</span>
                                          <span class="n">actions</span><span class="p">,</span> <span class="n">action_indexes</span><span class="p">)</span>
    <span class="c1"># in this version of the mc player, the existence of other players is</span>
    <span class="c1"># ignored, in another version of mc other players moves might be simulated</span>
    <span class="n">next_board</span><span class="p">[</span><span class="s1">'active_player'</span><span class="p">]</span> <span class="o">=</span> <span class="n">critter</span><span class="o">-</span><span class="mi">1</span>

    <span class="k">if</span> <span class="n">depth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_depth</span>
    <span class="c1"># potentially expand the game tree here,</span>
    <span class="c1"># but just do straight rollouts after this</span>
    <span class="c1"># doesn't expand to deal with all random food generation possibilities</span>
    <span class="c1"># just expands based on the actions given</span>
    <span class="n">expand_bs</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">next_board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">depth</span><span class="p">):</span>  <span class="c1"># maxDepth</span>
      <span class="k">if</span> <span class="n">next_board</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># check that game isn't over</span>
        <span class="c1"># assumes all boards have the same rounds left</span>
        <span class="c1"># no rounds left return scores as true values</span>
        <span class="n">terminal_vs</span> <span class="o">=</span> <span class="n">next_board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][:,</span><span class="n">critter</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">terminal_vs</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1">#pis, vs = self.nnet.predict(next_board['pieces'], next_board['scores'], next_board['rounds_left'])</span>
        <span class="n">pis</span><span class="p">,</span> <span class="n">vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pis_vs_from_board</span><span class="p">(</span><span class="n">next_board</span><span class="p">,</span> <span class="n">critter</span><span class="p">)</span>
        <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_valid_actions</span><span class="p">(</span><span class="n">next_board</span><span class="p">,</span> <span class="n">critter</span><span class="p">)</span>
        <span class="n">masked_pis</span> <span class="o">=</span> <span class="n">pis</span> <span class="o">*</span> <span class="n">valids</span>
        <span class="n">sum_pis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">masked_pis</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">masked_pi</span> <span class="o">/</span> <span class="n">masked_pi</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">if</span> <span class="n">masked_pi</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
             <span class="k">else</span> <span class="n">valid</span> <span class="o">/</span> <span class="n">valid</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
             <span class="k">for</span> <span class="n">valid</span><span class="p">,</span> <span class="n">masked_pi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">valids</span><span class="p">,</span> <span class="n">masked_pis</span><span class="p">)])</span>
        <span class="n">samp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="n">expand_bs</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">expand_bs</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">sampled_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">probs</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">samp</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">next_board</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_next_state</span><span class="p">(</span><span class="n">next_board</span><span class="p">,</span> <span class="n">critter</span><span class="p">,</span>
                                            <span class="n">sampled_actions</span><span class="p">)</span>
      <span class="c1"># in this version of the mc player, existence of other players is ignored</span>
      <span class="c1"># in another better version other players moves might be simulated, either</span>
      <span class="c1"># as copies of self, or as distinct environmental dynamics</span>
      <span class="n">next_board</span><span class="p">[</span><span class="s1">'active_player'</span><span class="p">]</span> <span class="o">=</span> <span class="n">critter</span><span class="o">-</span><span class="mi">1</span>


    <span class="n">pis</span><span class="p">,</span> <span class="n">vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pis_vs_from_board</span><span class="p">(</span><span class="n">next_board</span><span class="p">,</span> <span class="n">critter</span><span class="p">)</span>
    <span class="c1">#pis, vs = self.nnet.predict(next_board['pieces'], next_board['scores'],</span>
    <span class="c1">#                            next_board['rounds_left'])</span>
    <span class="c1">#print(vs.shape)</span>
    <span class="k">return</span> <span class="n">vs</span>




<span class="c1"># @title plotting functions</span>
<span class="c1">#################################################</span>
<span class="c1"># More plotting functions</span>
<span class="c1">#################################################</span>


<span class="k">def</span> <span class="nf">plot_directions</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">loc_prob_dict</span><span class="p">,</span> <span class="n">critter</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Plot vector field indicating critter direction probabilities.</span>

<span class="sd">  Args:</span>
<span class="sd">    fig, ax (matplotlib objects): Figure and axes objects for plotting.</span>
<span class="sd">    loc_prob_dict (dict): Dictionary with keys as (row, col) location tuples</span>
<span class="sd">      and values as lists of direction probabilities corresponding to the</span>
<span class="sd">      directions ['right', 'down', 'left', 'up'].</span>
<span class="sd">    critter (int): Identifier for which critter directions are associated with.</span>
<span class="sd">    deterministic (bool, optional): If True, the probabilities array is</span>
<span class="sd">      converted to 1-hot, and the arrows are plotted at the center of the cell</span>
<span class="sd">      and are larger. Defaults to False.</span>
<span class="sd">  """</span>

  <span class="c1">#looks like direction ignores inverted axis</span>
  <span class="n">direction_vectors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'right'</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">'down'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                       <span class="s1">'left'</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">'up'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)}</span>
  <span class="c1"># but offsets need to be aware of inverted</span>
  <span class="n">direction_offsets</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'right'</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">'down'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
                       <span class="s1">'left'</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">'up'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">)}</span>
  <span class="c1"># Offsets for each critter type 1 and 2 to be used together, 0 by itself</span>
  <span class="n">critter_offsets</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">),</span> <span class="mi">2</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)}</span>
  <span class="c1"># same logic for colors</span>
  <span class="n">critter_colors</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">'black'</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">'red'</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">'blue'</span><span class="p">}</span>
  <span class="c1"># Get the offset and color for this critter</span>
  <span class="n">critter_offset</span> <span class="o">=</span> <span class="n">critter_offsets</span><span class="p">[</span><span class="n">critter</span><span class="p">]</span>
  <span class="n">critter_color</span> <span class="o">=</span> <span class="n">critter_colors</span><span class="p">[</span><span class="n">critter</span><span class="p">]</span>

  <span class="c1"># Add legend only if critter is not 0</span>
  <span class="n">custom_leg_handles</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">if</span> <span class="n">critter</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'Critter </span><span class="si">{</span><span class="n">critter</span><span class="si">}</span><span class="s1">'</span>
    <span class="n">legend_patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">critter_color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="c1"># Add the legend for this critter</span>
    <span class="n">custom_leg_handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend_patch</span><span class="p">)</span>

  <span class="n">C</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

  <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">loc_prob_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">loc</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="n">loc_prob_dict</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">dir_key</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">probs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
      <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="n">critter_offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">direction_offsets</span><span class="p">[</span><span class="n">dir_key</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
      <span class="n">R</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="n">critter_offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">direction_offsets</span><span class="p">[</span><span class="n">dir_key</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
      <span class="n">U</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">direction_vectors</span><span class="p">[</span><span class="n">dir_key</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
      <span class="n">V</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">direction_vectors</span><span class="p">[</span><span class="n">dir_key</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

      <span class="k">if</span> <span class="n">deterministic</span><span class="p">:</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">prob</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">probs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>

  <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="k">if</span> <span class="n">deterministic</span> <span class="k">else</span> <span class="mf">0.5</span>
  <span class="n">scale</span> <span class="o">=</span> <span class="mi">15</span> <span class="k">if</span> <span class="n">deterministic</span> <span class="k">else</span> <span class="mi">30</span>

  <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">critter_color</span><span class="p">,</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">custom_leg_handles</span>


<span class="k">def</span> <span class="nf">make_grid</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""Plots an n_rows by n_cols grid with cells centered on integer indices and</span>
<span class="sd">  returns fig and ax handles for further use</span>
<span class="sd">  Args:</span>
<span class="sd">    num_rows (int): number of rows in the grid (vertical dimension)</span>
<span class="sd">    num_cols (int): number of cols in the grid (horizontal dimension)</span>

<span class="sd">  Returns:</span>
<span class="sd">    fig (matplotlib.figure.Figure): figure handle for the grid</span>
<span class="sd">    ax: (matplotlib.axes._axes.Axes): axes handle for the grid</span>
<span class="sd">  """</span>
  <span class="c1"># Create a new figure and axes with given figsize</span>
  <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s1">'constrained'</span><span class="p">)</span>
  <span class="c1"># Set width and height padding, remove horizontal and vertical spacing</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">w_pad</span><span class="o">=</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">72</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">72</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="c1"># Show right and top borders (spines) of the plot</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[[</span><span class="s1">'right'</span><span class="p">,</span> <span class="s1">'top'</span><span class="p">]]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="c1"># Set major ticks (where grid lines will be) on x and y axes</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
  <span class="c1"># Set labels for major ticks with font size of 8</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
  <span class="c1"># Set minor ticks (no grid lines here) to be between major ticks</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">num_cols</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">num_rows</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="c1"># Move x-axis ticks to the top of the plot</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_top</span><span class="p">()</span>
  <span class="c1"># Set grid lines based on minor ticks, make them grey, dashed, and half transparent</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">'minor'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'grey'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'-'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
  <span class="c1"># Remove minor ticks (not the grid lines)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">'minor'</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="c1"># Set limits of x and y axes</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">num_cols</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">num_rows</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
  <span class="c1"># Invert y axis direction</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
  <span class="c1"># If title is provided, set it as the figure title</span>
  <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
  <span class="c1"># Hide header and footer, disable toolbar and resizing of the figure</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">header_visible</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">toolbar_visible</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">resizable</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">footer_visible</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="c1"># Redraw the figure with these settings</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
  <span class="c1"># Return figure and axes handles for further customization</span>
  <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>


<span class="k">def</span> <span class="nf">plot_food</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">rc_food_loc</span><span class="p">,</span> <span class="n">food</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Plots "food" on a grid implied by the given fig, ax arguments</span>

<span class="sd">  Args:</span>
<span class="sd">    fig, ax: matplotlib figure and axes objects</span>
<span class="sd">    rc_food_loc: ndarry(int) of shape (N:num_food x 2:row,col)</span>
<span class="sd">    food: a handle for the existing food matplotlib PatchCollection object</span>
<span class="sd">    if one exists</span>
<span class="sd">  Returns:</span>
<span class="sd">    a handle for matplotlib PathCollection object of food scatter plot, either</span>
<span class="sd">    new if no handle was passed or updated if it was</span>
<span class="sd">  """</span>
  <span class="c1"># if no PathCollection handle passed in:</span>
  <span class="k">if</span> <span class="n">food</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">food</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Food'</span><span class="p">)</span>
  <span class="n">rc_food_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rc_food_loc</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
  <span class="c1">#matrix indexing convention is is [row-vertical, col-horizontal]</span>
  <span class="c1">#plotting indexing convention is (x-horizontal,y-vertical), hence flip</span>
  <span class="n">food</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">rc_food_loc</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">food</span>


<span class="k">def</span> <span class="nf">plot_critters</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">critter_specs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]]:</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Plots multiple types of "critters" on a grid implied by the given</span>
<span class="sd">  fig, ax arguments.</span>

<span class="sd">  Args:</span>
<span class="sd">    fig, ax: matplotlib figure and axes objects.</span>
<span class="sd">    critter_specs: List of dictionaries with keys 'location', 'name', 'color',</span>
<span class="sd">    'marker', 'int_id', 'rc_critter_loc' and optionally 'handle' for each</span>
<span class="sd">    critter.</span>

<span class="sd">  Returns:</span>
<span class="sd">    Updated critter_specs with handles.</span>
<span class="sd">  """</span>
  <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">critter_specs</span><span class="p">:</span>
    <span class="c1"># Ensure required keys are present</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'marker'</span><span class="p">,</span> <span class="s1">'color'</span><span class="p">,</span> <span class="s1">'name'</span><span class="p">,</span> <span class="s1">'rc_loc'</span><span class="p">]:</span>
      <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Key '</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">' missing in critter spec."</span><span class="p">)</span>
    <span class="n">handle_</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'handle'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">handle_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">handle_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">s</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">spec</span><span class="p">[</span><span class="s1">'marker'</span><span class="p">],</span>
                           <span class="n">color</span><span class="o">=</span><span class="n">spec</span><span class="p">[</span><span class="s1">'color'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">spec</span><span class="p">[</span><span class="s1">'name'</span><span class="p">])</span>
    <span class="n">handle_</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="s1">'rc_loc'</span><span class="p">]))</span>
    <span class="n">spec</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">'handle'</span><span class="p">:</span> <span class="n">handle_</span><span class="p">})</span>
  <span class="k">return</span> <span class="n">critter_specs</span>


<span class="k">def</span> <span class="nf">plot_critter</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">rc_critter_loc</span><span class="p">,</span>
                 <span class="n">critter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">critter_name</span><span class="o">=</span><span class="s1">'Critter'</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Plots "critter" on a grid implied by the given fig, ax arguments</span>

<span class="sd">  Args:</span>
<span class="sd">    fig, ax: matplotlib figure and axes objects</span>
<span class="sd">    rc_critter_loc: ndarry(int) of shape (N:num_critters x 2:row,col)</span>
<span class="sd">    critter: a handle for the existing food matplotlib PatchCollection object</span>
<span class="sd">    if one exists</span>
<span class="sd">  Returns:</span>
<span class="sd">    a handle for matplotlib PathCollection object of critter scatter plot,</span>
<span class="sd">    either new if no handle was passed in or updated if it was.</span>
<span class="sd">  """</span>
  <span class="k">if</span> <span class="n">critter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">critter</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">s</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'h'</span><span class="p">,</span>
                         <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">critter_name</span><span class="p">)</span>
  <span class="c1"># matrix indexing convention is is [row-vertical, col-horizontal]</span>
  <span class="c1"># plotting indexing convention is (x-horizontal,y-vertical), hence flip</span>
  <span class="n">critter</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">rc_critter_loc</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">critter</span>


<span class="k">def</span> <span class="nf">plot_fov</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">rc_critter</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">has_fov</span><span class="p">,</span>
             <span class="n">opaque</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fov</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Plots a mask on a grid implied by the given fig, ax arguments</span>

<span class="sd">  Args:</span>
<span class="sd">    fig, ax: matplotlib figure and axes objects</span>
<span class="sd">    rc_critter: ndarry(int) (row,col) of the critter</span>
<span class="sd">    mask: a handle for the existing mask matplotlib Image object if one exists</span>
<span class="sd">  Returns:</span>
<span class="sd">    a handle for matplotlib Image object of mask, either new if no handle</span>
<span class="sd">    was passed in or updated if it was.</span>
<span class="sd">  """</span>

  <span class="c1"># Initialize mask as a semi-transparent overlay for the entire grid</span>
  <span class="n">mask_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
  <span class="n">mask_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># light grey color</span>
  <span class="k">if</span> <span class="n">has_fov</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">opaque</span><span class="p">:</span>
      <span class="n">mask_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># 50% opacity</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">mask_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># 50% opacity</span>
    <span class="c1"># Create arrays representing the row and column indices</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_rows</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_cols</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
    <span class="c1"># Iterate over each critter location</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">rows</span> <span class="o">-</span> <span class="n">rc_critter</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="n">rc_critter</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># Set the region within the specified radius around the critter to transparent</span>
    <span class="n">mask_array</span><span class="p">[</span><span class="n">dist</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">mask_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="k">if</span> <span class="n">fov</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">fov</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask_array</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">fov</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">mask_array</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">fov</span>


<span class="k">def</span> <span class="nf">remove_ip_clutter</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">header_visible</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">toolbar_visible</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">resizable</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">footer_visible</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>




<span class="c1"># @title GridworldBoard class</span>
<span class="c1">#######################################################################</span>
<span class="c1"># extend GridworldGame class locally before integrating in shared utils</span>
<span class="c1">#######################################################################</span>




<span class="k">class</span> <span class="nc">GridworldBoard</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  A collection methods and parameters of a gridworld game board that</span>
<span class="sd">  define the logic of the game, and allows for multiple critters on the same</span>
<span class="sd">  board</span>

<span class="sd">  board state is represented by primarily by pieces, score, and rounds left</span>
<span class="sd">  pieces is a batch x n_rows x n_cols numpy array positive integers are critter</span>
<span class="sd">  locations 0's are empty space and -1's are food.</span>

<span class="sd">  For pieces first dim is batch, second dim row , third is col,</span>
<span class="sd">  so pieces[0][1][7] is the square in row 2, in column 8 of the first board in</span>
<span class="sd">  the batch of boards.</span>

<span class="sd">  scores is a batchsize x num_critters numpy array giving the scores for each</span>
<span class="sd">  critter on each board in the batch (note off by one indexing)</span>

<span class="sd">  rounds_left is how many rounds are left in the game.</span>

<span class="sd">  active_player keeps track of which players turn it is</span>

<span class="sd">  Note:</span>
<span class="sd">    In 2d np.array first dim is row (vertical), second dim is col (horizontal),</span>
<span class="sd">    i.e. top left corner is (0,0), so take care when visualizing/plotting</span>
<span class="sd">    as np.array visualization inline with typical tensor notation but at odds</span>
<span class="sd">    with conventional plotting where (0,0) is bottom left, first dim, x, is</span>
<span class="sd">    horizontal, second dim, y, is vertical</span>
<span class="sd">  """</span>


  <span class="k">class</span> <span class="nc">CritterFoodType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">FOOD</span> <span class="o">=</span> <span class="s2">"food"</span>
    <span class="n">PREY</span> <span class="o">=</span> <span class="s2">"prey"</span>
    <span class="n">PREDATOR</span> <span class="o">=</span> <span class="s2">"predator"</span>

  <span class="n">ARRAY_PAD_VALUE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">n_rows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
               <span class="n">num_food</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">lifetime</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Set the parameters of the game."""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span> <span class="o">=</span> <span class="n">n_rows</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span> <span class="o">=</span> <span class="n">n_cols</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_food</span> <span class="o">=</span> <span class="n">num_food</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_prey</span> <span class="o">=</span> <span class="n">num_prey</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_pred</span> <span class="o">=</span> <span class="n">num_pred</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span> <span class="o">=</span> <span class="n">num_pred</span> <span class="o">+</span> <span class="n">num_prey</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lifetime</span> <span class="o">=</span> <span class="n">lifetime</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pred_prey_threshold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_prey</span>
    <span class="k">if</span> <span class="n">rng</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">rng</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">check_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">num_food</span><span class="p">,</span>
                                      <span class="n">stop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>


  <span class="k">def</span> <span class="nf">init_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Samples random 2d grid locations without replacement</span>

<span class="sd">    Args:</span>
<span class="sd">      n_rows: int, number of rows in the grid</span>
<span class="sd">      n_cols: int, number of columns in the grid</span>
<span class="sd">      num:    int, number of samples to generate. Should throw an error if num &gt; n_rows x n_cols</span>
<span class="sd">      rng:    instance of numpy.random's default rng. Used for reproducibility.</span>

<span class="sd">    Returns:</span>
<span class="sd">      int_loc: ndarray(int) of shape (num,), flat indices for a 2D grid flattened into 1D</span>
<span class="sd">      rc_index: tuple(ndarray(int), ndarray(int)), a pair of arrays with the first giving</span>
<span class="sd">        the row indices and the second giving the col indices. Useful for indexing into</span>
<span class="sd">        an n_rows by n_cols numpy array.</span>
<span class="sd">      rc_plotting: ndarray(int) of shape (num, 2), 2D coordinates suitable for matplotlib plotting</span>
<span class="sd">    """</span>

    <span class="c1"># Set up default random generator, use the boards default if none explicitly given</span>
    <span class="k">if</span> <span class="n">rng</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">rng</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span>
    <span class="c1"># Choose 'num' unique random indices from a flat 1D array of size n_rows*n_cols</span>
    <span class="n">int_loc</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">n_rows</span> <span class="o">*</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Convert the flat indices to 2D indices based on the original shape (n_rows, n_cols)</span>
    <span class="n">rc_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">int_loc</span><span class="p">,</span> <span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">))</span>
    <span class="c1"># Transpose indices to get num x 2 array for easy plotting with matplotlib</span>
    <span class="n">rc_plotting</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rc_index</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="c1"># Return 1D flat indices, 2D indices for numpy array indexing and 2D indices for plotting</span>
    <span class="k">return</span> <span class="n">int_loc</span><span class="p">,</span> <span class="n">rc_index</span><span class="p">,</span> <span class="n">rc_plotting</span>


  <span class="k">def</span> <span class="nf">get_init_board_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Set up starting board using game parameters"""</span>
    <span class="c1">#set rounds_left and score</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rounds_left</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)</span> <span class="o">*</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">lifetime</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_over</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span><span class="p">))</span>
    <span class="c1"># create an empty board array.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">),</span>
                           <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="c1"># Place critter and initial food items on the board randomly</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">):</span>
      <span class="c1"># num_food+num_critter because we want critter and food locations</span>
      <span class="n">int_loc</span><span class="p">,</span> <span class="n">rc_idx</span><span class="p">,</span> <span class="n">rc_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_loc</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_food</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span><span class="p">)</span>
      <span class="c1"># critter random start locations</span>
      <span class="k">for</span> <span class="n">c_</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="p">[(</span><span class="n">ii</span><span class="p">,</span> <span class="n">rc_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">c_</span><span class="p">],</span> <span class="n">rc_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">c_</span><span class="p">])]</span> <span class="o">=</span> <span class="n">c_</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="c1"># food random start locations</span>
      <span class="k">for</span> <span class="n">f_</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_food</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="p">[(</span><span class="n">ii</span><span class="p">,</span> <span class="n">rc_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span> <span class="o">+</span> <span class="n">f_</span><span class="p">],</span>
                         <span class="n">rc_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span> <span class="o">+</span> <span class="n">f_</span><span class="p">])]</span> <span class="o">=</span> <span class="o">-</span><span class="n">f_</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">state</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'pieces'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
             <span class="s1">'scores'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">scores</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
             <span class="s1">'rounds_left'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rounds_left</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
             <span class="s1">'is_over'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_over</span><span class="o">.</span><span class="n">copy</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">state</span>


  <span class="k">def</span> <span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" board is dictionary giving game state a triple of np arrays</span>
<span class="sd">      pieces:        numpy array (batch_size x n_rows x n_cols),</span>
<span class="sd">      scores:        numpy array (batch_size x num_critters)</span>
<span class="sd">      rounds_left:   numpy array (batch_size)</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scores</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rounds_left</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_over</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'is_over'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>


  <span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" returns a board state, which is a triple of np arrays</span>
<span class="sd">    pieces,       - batch_size x n_rows x n_cols</span>
<span class="sd">    scores,       - batch_size</span>
<span class="sd">    rounds_left   - batch_size</span>
<span class="sd">    """</span>
    <span class="n">state</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'pieces'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
             <span class="s1">'scores'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">scores</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
             <span class="s1">'rounds_left'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rounds_left</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
             <span class="s1">'is_over'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_over</span><span class="o">.</span><span class="n">copy</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">state</span>


  <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>


  <span class="c1">################# CORE GAME STATE UPDATE LOGIC ##############################</span>
  <span class="c1">################# execute_moves is main, uses these helper functions ########</span>
  <span class="k">def</span> <span class="nf">get_critter_food_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">critter_food</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">critter_food</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">critter_food_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CritterFoodType</span><span class="o">.</span><span class="n">FOOD</span>
    <span class="k">elif</span> <span class="n">critter_food</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">pred_prey_threshold</span><span class="p">:</span>
        <span class="n">critter_food_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CritterFoodType</span><span class="o">.</span><span class="n">PREDATOR</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">critter_food_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CritterFoodType</span><span class="o">.</span><span class="n">PREY</span>
    <span class="k">return</span> <span class="n">critter_food_type</span>


  <span class="k">def</span> <span class="nf">get_type_masks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Returns masks indicating the position types on the board.</span>
<span class="sd">    Returns:</span>
<span class="sd">        tuple: Tuple containing masks for empty spaces, food, prey, and predator.</span>
<span class="sd">    """</span>
    <span class="n">empt_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">food_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">prey_mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pieces</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pred_prey_threshold</span><span class="p">)</span>
    <span class="n">pred_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pred_prey_threshold</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span>
    <span class="k">return</span> <span class="n">empt_mask</span><span class="p">,</span> <span class="n">food_mask</span><span class="p">,</span> <span class="n">prey_mask</span><span class="p">,</span> <span class="n">pred_mask</span>


  <span class="k">def</span> <span class="nf">get_collisions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moves</span><span class="p">,</span> <span class="n">critter_food</span><span class="p">,</span> <span class="n">critter_food_type</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Determine the collision results and update scores accordingly.</span>
<span class="sd">    Args:</span>
<span class="sd">        moves (tuple): Tuple of arrays indicating the moves.</span>
<span class="sd">        critter_food (int): Index to identify the critter or food.</span>
<span class="sd">        critter_food_type (enum): Type of the critter or food</span>
<span class="sd">    Returns:</span>
<span class="sd">        tuple: Tuple containing move collision messages and separates out the</span>
<span class="sd">        moves by where they land i.e., empty spaces, food, prey, and predator.</span>
<span class="sd">    """</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">move_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">move_mask</span><span class="p">[</span><span class="n">moves</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">(</span><span class="n">empt_mask</span><span class="p">,</span> <span class="n">food_mask</span><span class="p">,</span>
     <span class="n">prey_mask</span><span class="p">,</span> <span class="n">pred_mask</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_masks</span><span class="p">()</span>

    <span class="n">move_coll_msg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    <span class="n">empt_moves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">empt_mask</span> <span class="o">&amp;</span> <span class="n">move_mask</span><span class="p">)</span>
    <span class="n">food_moves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">food_mask</span> <span class="o">&amp;</span> <span class="n">move_mask</span><span class="p">)</span>
    <span class="n">prey_moves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">prey_mask</span> <span class="o">&amp;</span> <span class="n">move_mask</span><span class="p">)</span>
    <span class="n">pred_moves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pred_mask</span> <span class="o">&amp;</span> <span class="n">move_mask</span><span class="p">)</span>
    <span class="n">move_coll_msg</span><span class="p">[</span><span class="n">empt_moves</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">critter_food_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">CritterFoodType</span><span class="o">.</span><span class="n">PREY</span><span class="p">:</span>
      <span class="n">move_coll_msg</span><span class="p">[</span><span class="n">food_moves</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">critter_food_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">CritterFoodType</span><span class="o">.</span><span class="n">PREDATOR</span><span class="p">:</span>
      <span class="n">move_coll_msg</span><span class="p">[</span><span class="n">food_moves</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">3</span>
      <span class="n">move_coll_msg</span><span class="p">[</span><span class="n">prey_moves</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="c1"># all collision types are blocking for food types</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">move_coll_msg</span><span class="p">,</span> <span class="n">empt_moves</span><span class="p">,</span> <span class="n">food_moves</span><span class="p">,</span> <span class="n">prey_moves</span><span class="p">,</span> <span class="n">pred_moves</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">update_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">move_coll_msg</span><span class="p">,</span> <span class="n">critter_food</span><span class="p">,</span>
                    <span class="n">critter_food_type</span><span class="p">,</span> <span class="n">prey_moves</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">critter_food_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">CritterFoodType</span><span class="o">.</span><span class="n">PREY</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">scores</span><span class="p">[:,</span> <span class="n">critter_food</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">move_coll_msg</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">critter_food_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">CritterFoodType</span><span class="o">.</span><span class="n">PREDATOR</span><span class="p">:</span>
      <span class="c1"># predators that eat get a point</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">scores</span><span class="p">[:,</span> <span class="n">critter_food</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">move_coll_msg</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span>
      <span class="c1"># prey that are eaten lose 10 points</span>
      <span class="n">who_eaten</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="p">[</span><span class="n">prey_moves</span><span class="p">]</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">scores</span><span class="p">[</span><span class="n">prey_moves</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">who_eaten</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">10</span>
    <span class="c1"># food types don't get a score, it's a neuro book</span>


  <span class="k">def</span> <span class="nf">move_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">critter_food</span><span class="p">,</span> <span class="n">move_coll_msg</span><span class="p">,</span> <span class="n">moves</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Move the pieces on the board based on the collision messages.</span>

<span class="sd">    Args:</span>
<span class="sd">        critter_food (int): Index to identify the critter or food.</span>
<span class="sd">        move_coll_msg (np.array): Array of collision messages.</span>
<span class="sd">        moves (tuple): Tuple of arrays indicating the moves.</span>
<span class="sd">    """</span>
    <span class="n">old_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pieces</span> <span class="o">==</span> <span class="n">critter_food</span><span class="p">)</span>
    <span class="n">vacated_old_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span><span class="n">old_locs</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">move_coll_msg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
    <span class="n">vacated_old_locs_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">vacated_old_locs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                            <span class="n">vacated_old_locs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
                            <span class="n">vacated_old_locs</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="p">[</span><span class="n">vacated_old_locs_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">new_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span><span class="n">moves</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">move_coll_msg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
    <span class="n">new_locs_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">new_locs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">new_locs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">new_locs</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="p">[</span><span class="n">new_locs_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">critter_food</span>


  <span class="k">def</span> <span class="nf">replace_destroyed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">destroying_moves</span><span class="p">,</span> <span class="n">old_pieces</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Replace the destroyed pieces on the board.</span>

<span class="sd">    Args:</span>
<span class="sd">        destroying_moves (tuple): Tuple of arrays indicating the moves that</span>
<span class="sd">        resulted in destruction.</span>
<span class="sd">    """</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">old_pieces</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">g_gone</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    <span class="n">g_gone</span><span class="p">[</span><span class="n">destroying_moves</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">which_gone</span> <span class="o">=</span> <span class="n">old_pieces</span><span class="p">[</span><span class="n">destroying_moves</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">g_gone</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">num_empty_after</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_rows</span><span class="o">*</span><span class="n">n_cols</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_food</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
      <span class="n">p_new_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">g_gone</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
      <span class="n">food_sample_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">num_empty_after</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">g_gone</span><span class="p">)))</span>
      <span class="n">food_sample</span> <span class="o">=</span> <span class="n">food_sample_</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">g_gone</span><span class="p">)))</span><span class="o">*</span><span class="n">num_empty_after</span>
      <span class="n">new_loc_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="p">[(</span><span class="n">p_new_locs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">food_sample</span><span class="p">],</span>
                   <span class="n">p_new_locs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">food_sample</span><span class="p">],</span>
                   <span class="n">p_new_locs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">food_sample</span><span class="p">])]</span>
      <span class="c1"># this requires that p_new_locs and destroying moves are both</span>
      <span class="c1"># lexographically sorted... but they are not always</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="p">[(</span><span class="n">p_new_locs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">food_sample</span><span class="p">],</span>
                   <span class="n">p_new_locs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">food_sample</span><span class="p">],</span>
                   <span class="n">p_new_locs</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">food_sample</span><span class="p">])]</span> <span class="o">=</span> <span class="n">which_gone</span>


  <span class="k">def</span> <span class="nf">execute_moves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moves</span><span class="p">,</span> <span class="n">critter_food</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Execute the moves on the board, handle collisions, update scores,</span>
<span class="sd">    and replace destroyed/eaten pieces.</span>

<span class="sd">    Args:</span>
<span class="sd">      moves (tuple): Tuple of arrays indicating the moves.</span>
<span class="sd">      critter_food (int): Index to identify the critter or food.</span>
<span class="sd">    """</span>
    <span class="c1"># what type of critter is moving</span>
    <span class="n">critter_food_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_critter_food_type</span><span class="p">(</span><span class="n">critter_food</span><span class="p">)</span>
    <span class="c1"># what do they land on when the move</span>
    <span class="p">(</span><span class="n">move_coll_msg</span><span class="p">,</span> <span class="n">empt_moves</span><span class="p">,</span> <span class="n">food_moves</span><span class="p">,</span>
     <span class="n">prey_moves</span><span class="p">,</span> <span class="n">pred_moves</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_collisions</span><span class="p">(</span>
        <span class="n">moves</span><span class="p">,</span> <span class="n">critter_food</span><span class="p">,</span> <span class="n">critter_food_type</span><span class="p">)</span>
    <span class="c1"># based on what they move onto increment/decrement scores</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_scores</span><span class="p">(</span><span class="n">move_coll_msg</span><span class="p">,</span> <span class="n">critter_food</span><span class="p">,</span>
                       <span class="n">critter_food_type</span><span class="p">,</span> <span class="n">prey_moves</span><span class="p">)</span>
    <span class="c1"># move the pieces</span>
    <span class="n">old_pieces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">move_pieces</span><span class="p">(</span><span class="n">critter_food</span><span class="p">,</span> <span class="n">move_coll_msg</span><span class="p">,</span> <span class="n">moves</span><span class="p">)</span>
    <span class="c1"># eaten food and prey respawn</span>
    <span class="k">if</span> <span class="n">critter_food_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">CritterFoodType</span><span class="o">.</span><span class="n">PREY</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">replace_destroyed</span><span class="p">(</span><span class="n">food_moves</span><span class="p">,</span> <span class="n">old_pieces</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">critter_food_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">CritterFoodType</span><span class="o">.</span><span class="n">PREDATOR</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">replace_destroyed</span><span class="p">(</span><span class="n">food_moves</span><span class="p">,</span> <span class="n">old_pieces</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">replace_destroyed</span><span class="p">(</span><span class="n">prey_moves</span><span class="p">,</span> <span class="n">old_pieces</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_sum</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">'something went terribly wrong'</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">old_pieces</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">critter_food</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">moves</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">get_neighbor_grc_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">critter_food</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Returns all grid positions within a certain cityblock distance radius from</span>
<span class="sd">    the place corresponding to critter_food.</span>

<span class="sd">    Args:</span>
<span class="sd">        critter_food (int): The idex of the focal critter_food.</span>
<span class="sd">        radius (int): The cityblock distance.</span>
<span class="sd">        pad (bool): whether or not to pad the array, if padded all row, col</span>
<span class="sd">          indexes are valid for the padded array, useful for getting percept</span>
<span class="sd">          if not all indexes are correct for the original array, useful for</span>
<span class="sd">          figuring out legal moves.</span>

<span class="sd">    Returns:</span>
<span class="sd">        an array of indices, each row is a g, r, c index for the neighborhoods</span>
<span class="sd">        around the critters, can use the g value to know which board you are in.</span>
<span class="sd">        if pad=True also returns the padded array (the indices in that case) are</span>
<span class="sd">        for the padded array, so won't work on self.pieces, whereas if pad is</span>
<span class="sd">        False the indices will be for the offsets in reference to the original</span>
<span class="sd">        self.pieces, but note that some of these will be invalid, and will</span>
<span class="sd">        need to be filtered out (as we do in get_legal)</span>
<span class="sd">    """</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">shape</span>
    <span class="c1"># Create meshgrid for offsets</span>
    <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">padded_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="p">,</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">radius</span><span class="p">),</span>
        <span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">radius</span><span class="p">)),</span> <span class="n">constant_values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ARRAY_PAD_VALUE</span><span class="p">)</span>
      <span class="n">batch</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">padded_arr</span> <span class="o">==</span> <span class="n">critter_food</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">batch</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pieces</span> <span class="o">==</span> <span class="n">critter_food</span><span class="p">)</span>
    <span class="n">row_offsets</span><span class="p">,</span> <span class="n">col_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">radius</span><span class="p">,</span> <span class="n">radius</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">radius</span><span class="p">,</span> <span class="n">radius</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">indexing</span><span class="o">=</span><span class="s1">'ij'</span><span class="p">)</span>

    <span class="c1"># Filter for valid cityblock distances</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">row_offsets</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">col_offsets</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">radius</span>
    <span class="n">valid_row_offsets</span> <span class="o">=</span> <span class="n">row_offsets</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">valid_col_offsets</span> <span class="o">=</span> <span class="n">col_offsets</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
    <span class="c1"># Extend rows and cols dimensions for broadcasting</span>
    <span class="n">extended_rows</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="n">extended_cols</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="c1"># Compute all neighbors for each position in the batch</span>
    <span class="n">neighbors_rows</span> <span class="o">=</span> <span class="n">extended_rows</span> <span class="o">+</span> <span class="n">valid_row_offsets</span>
    <span class="n">neighbors_cols</span> <span class="o">=</span> <span class="n">extended_cols</span> <span class="o">+</span> <span class="n">valid_col_offsets</span>

    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span>
                                         <span class="n">neighbors_rows</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                               <span class="n">neighbors_rows</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
                               <span class="n">neighbors_cols</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span>
    <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">indices</span>
    <span class="k">elif</span> <span class="n">pad</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">indices</span><span class="p">,</span> <span class="n">padded_arr</span>


  <span class="k">def</span> <span class="nf">get_legal_moves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">critter_food</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Identifies all legal moves for the critter, taking into acount which moves</span>
<span class="sd">    are blocking based on type.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A numpy int array of size batch x 3(g,x,y) x 4(possible moves)</span>

<span class="sd">    Note:</span>
<span class="sd">      moves[0,1,3] is the x coordinate of the move corresponding to the</span>
<span class="sd">      fourth offset on the first board.</span>
<span class="sd">      moves[1,:,1] will give the g,x,y triple corresponding to the</span>
<span class="sd">      move on the second board and the second offset, actions are integers</span>
<span class="sd">    """</span>

    <span class="n">critter_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pieces</span> <span class="o">==</span> <span class="n">critter_food</span><span class="p">))</span>
    <span class="c1"># turn those row, col offsets into a set of legal offsets</span>
    <span class="n">legal_offsets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_neighbor_grc_indices</span><span class="p">(</span><span class="n">critter_food</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
    <span class="n">legal_offsets</span> <span class="o">=</span> <span class="p">{</span><span class="nb">tuple</span><span class="p">(</span><span class="n">m_</span><span class="p">)</span> <span class="k">for</span> <span class="n">m_</span> <span class="ow">in</span> <span class="n">legal_offsets</span><span class="p">}</span>

    <span class="c1"># Apply logic of where a successful move can be made, by which</span>
    <span class="c1"># type of critter, be they food, prey, predator or something else</span>
    <span class="n">empt_mask</span><span class="p">,</span> <span class="n">food_mask</span><span class="p">,</span> <span class="n">prey_mask</span><span class="p">,</span> <span class="n">pred_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_masks</span><span class="p">()</span>
    <span class="n">critter_food_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_critter_food_type</span><span class="p">(</span><span class="n">critter_food</span><span class="p">)</span>
    <span class="c1">#print(critter_food_type)</span>
    <span class="k">if</span> <span class="n">critter_food_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">CritterFoodType</span><span class="o">.</span><span class="n">FOOD</span><span class="p">:</span>
      <span class="c1">#food only drifts into empty places</span>
      <span class="n">legal_destinations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">empt_mask</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">critter_food_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">CritterFoodType</span><span class="o">.</span><span class="n">PREY</span><span class="p">:</span>
      <span class="n">legal_destinations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">empt_mask</span> <span class="o">|</span> <span class="n">food_mask</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">critter_food_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">CritterFoodType</span><span class="o">.</span><span class="n">PREDATOR</span><span class="p">:</span>
      <span class="n">legal_destinations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">empt_mask</span> <span class="o">|</span> <span class="n">food_mask</span> <span class="o">|</span> <span class="n">prey_mask</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Unexpected value for critter_food_type."</span><span class="p">)</span>
    <span class="n">legal_destinations</span> <span class="o">=</span> <span class="p">{</span><span class="nb">tuple</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span> <span class="k">for</span> <span class="n">coords</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">legal_destinations</span><span class="p">)}</span>
    <span class="c1"># Add the current locations of the critters to legal_destinations</span>
    <span class="n">current_locations</span> <span class="o">=</span> <span class="p">{</span><span class="nb">tuple</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span> <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">critter_locs</span><span class="o">.</span><span class="n">T</span><span class="p">}</span>
    <span class="n">legal_destinations</span> <span class="o">=</span> <span class="n">legal_destinations</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">current_locations</span><span class="p">)</span>

    <span class="c1"># legal moves are both legal offsets and legal destinations</span>
    <span class="n">legal_moves</span> <span class="o">=</span> <span class="n">legal_offsets</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">legal_destinations</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">legal_moves</span>


  <span class="k">def</span> <span class="nf">get_legal_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">critter_food</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Identifies all legal offsets for a critter or food, so filter out moves</span>
<span class="sd">    that are off the board, but does not filter out collisions that would be</span>
<span class="sd">    blocking. For a random valid player likely better to use get_legal_moves,</span>
<span class="sd">    but this is much quicker, because it doesn't check collision types, for</span>
<span class="sd">    use by RL agents in training loops</span>

<span class="sd">    Returns:</span>
<span class="sd">      A numpy int array of size batch x 3(g,x,y) x 4(possible moves)</span>

<span class="sd">    Note:</span>
<span class="sd">      moves[0,1,3] is the x coordinate of the move corresponding to the</span>
<span class="sd">      fourth offset on the first board.</span>
<span class="sd">      moves[1,:,1] will give the g,x,y triple corresponding to the</span>
<span class="sd">      move on the second board and the second offset, actions are integers</span>
<span class="sd">    """</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pieces</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">batch</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pieces</span> <span class="o">==</span> <span class="n">critter_food</span><span class="p">)</span>
    <span class="n">row_offsets</span><span class="p">,</span> <span class="n">col_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">radius</span><span class="p">,</span> <span class="n">radius</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">radius</span><span class="p">,</span> <span class="n">radius</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">indexing</span><span class="o">=</span><span class="s1">'ij'</span><span class="p">)</span>
    <span class="c1"># Filter for valid cityblock distances</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">row_offsets</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">col_offsets</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">radius</span>
    <span class="n">valid_row_offsets</span> <span class="o">=</span> <span class="n">row_offsets</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
    <span class="n">valid_col_offsets</span> <span class="o">=</span> <span class="n">col_offsets</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
    <span class="c1"># Extend rows and cols dimensions for broadcasting</span>
    <span class="n">extended_rows</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="n">extended_cols</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="c1"># Compute all neighbors for each position in the batch</span>
    <span class="n">potential_moves_rows</span> <span class="o">=</span> <span class="n">extended_rows</span> <span class="o">+</span> <span class="n">valid_row_offsets</span>
    <span class="n">potential_moves_cols</span> <span class="o">=</span> <span class="n">extended_cols</span> <span class="o">+</span> <span class="n">valid_col_offsets</span>

    <span class="c1"># Filter offsets that would take the critter outside the board</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">potential_moves_rows</span> <span class="o">&gt;=</span> <span class="mi">0</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="n">potential_moves_rows</span> <span class="o">&lt;=</span> <span class="n">n_rows</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">c3</span> <span class="o">=</span> <span class="n">potential_moves_cols</span> <span class="o">&gt;=</span> <span class="mi">0</span>
    <span class="n">c4</span> <span class="o">=</span> <span class="n">potential_moves_cols</span> <span class="o">&lt;=</span> <span class="n">n_cols</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">valid_move_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span><span class="p">])</span>

    <span class="n">legal_offsets_rows</span> <span class="o">=</span> <span class="n">potential_moves_rows</span><span class="p">[</span><span class="n">valid_move_mask</span><span class="p">]</span>
    <span class="n">legal_offsets_cols</span> <span class="o">=</span> <span class="n">potential_moves_cols</span><span class="p">[</span><span class="n">valid_move_mask</span><span class="p">]</span>
    <span class="n">batch_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">valid_row_offsets</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">legal_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">batch_indexes</span><span class="p">[</span><span class="n">valid_move_mask</span><span class="o">.</span><span class="n">ravel</span><span class="p">()],</span>
                                     <span class="n">legal_offsets_rows</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
                                     <span class="n">legal_offsets_cols</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">legal_offsets</span><span class="p">,</span> <span class="n">valid_move_mask</span>


  <span class="k">def</span> <span class="nf">get_perceptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">critter_food</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
    <span class="n">idx</span><span class="p">,</span> <span class="n">pad_pieces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_neighbor_grc_indices</span><span class="p">(</span><span class="n">critter_food</span><span class="p">,</span>
                                                    <span class="n">radius</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1">#percept_mask = np.zeros(pad_pieces.shape, dtype=bool)</span>
    <span class="c1">#percept_mask[idx[:,0], idx[:,1]], idx[:,2]] = True</span>
    <span class="n">percept</span> <span class="o">=</span> <span class="n">pad_pieces</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">idx</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">percept</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>




<span class="c1"># @title GridworldGame class</span>
<span class="c1">#######################################################################</span>
<span class="c1"># extend GridworldGame class locally before integrating in shared utils</span>
<span class="c1">#######################################################################</span>



<span class="k">class</span> <span class="nc">GridworldGame</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  A collection methods and parameters of a gridworld game that allow</span>
<span class="sd">  for interaction with and display of GridwordlBoard objects.</span>
<span class="sd">  """</span>


  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
               <span class="n">num_food</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">lifetime</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">drift_player</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Initializes an instance of the class with the specified parameters.</span>
<span class="sd">    Args:</span>
<span class="sd">      batch_size (int, optional): Number of instances in a batch. Default is 1.</span>
<span class="sd">      n_rows (int, optional): Number of rows in the grid. Default is 7.</span>
<span class="sd">      n_cols (int, optional): Number of columns in the grid. Default is 7.</span>
<span class="sd">      num_food (int, optional): Number of food items. Default is 10.</span>
<span class="sd">      num_prey (int, optional): Number of different agents running around</span>
<span class="sd">        on each board in the batch eating food. Default is 1.</span>
<span class="sd">      num_pred (int, optional): Number of different agents running around</span>
<span class="sd">        on each board in the batch eating prey. Default is 1.</span>
<span class="sd">      lifetime (int, optional): Time before critter's life ends, in terms of</span>
<span class="sd">        time steps. Default is 30.</span>
<span class="sd">      rng (numpy random number generator, optional): Random number generator</span>
<span class="sd">        for reproducibility. If None, uses default RNG with a preset seed.</span>
<span class="sd">      drift_player (player object, optional): a 'player' who moves the food</span>
<span class="sd">        pieces around (drifting) if none, skip food movement</span>
<span class="sd">    """</span>

    <span class="c1"># Check for positive integer inputs</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span>
               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">num_food</span><span class="p">,</span> <span class="n">num_prey</span><span class="p">,</span> <span class="n">num_pred</span><span class="p">,</span>
                         <span class="n">lifetime</span><span class="p">]),</span> <span class="s2">"All inputs must be non-negative integers."</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span> <span class="o">=</span> <span class="n">n_rows</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span> <span class="o">=</span> <span class="n">n_cols</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_food</span> <span class="o">=</span> <span class="n">num_food</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_prey</span> <span class="o">=</span> <span class="n">num_prey</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_pred</span> <span class="o">=</span> <span class="n">num_pred</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span> <span class="o">=</span> <span class="n">num_pred</span> <span class="o">+</span> <span class="n">num_prey</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pred_prey_threshold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_prey</span>
    <span class="c1"># Check for num_food exceeding maximum possible value</span>
    <span class="n">max_food</span> <span class="o">=</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="n">n_cols</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span>
    <span class="k">if</span> <span class="n">num_food</span> <span class="o">&gt;</span> <span class="n">max_food</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'num_food is too large, setting it to maximum possible value: </span><span class="si">{</span><span class="n">max_food</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
      <span class="n">num_food</span> <span class="o">=</span> <span class="n">max_food</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_food</span> <span class="o">=</span> <span class="n">num_food</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lifetime</span> <span class="o">=</span> <span class="n">lifetime</span>
    <span class="c1"># Set up random number generator</span>
    <span class="k">if</span> <span class="n">rng</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">rng</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">drift_player</span> <span class="o">=</span> <span class="n">drift_player</span>


  <span class="k">def</span> <span class="nf">get_init_board</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates a starting board given the parameters of the game.</span>
<span class="sd">    Returns a tuple giving current state of the game</span>
<span class="sd">    """</span>
    <span class="c1"># current score, and rounds left in the episode</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">GridworldBoard</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span>
                       <span class="n">n_cols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_food</span><span class="p">,</span>
                       <span class="n">num_prey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_prey</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_pred</span><span class="p">,</span>
                       <span class="n">lifetime</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lifetime</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">get_init_board_state</span><span class="p">()</span>


  <span class="k">def</span> <span class="nf">get_board_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Shape of a single board, doesn't give batch size"""</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">get_action_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Returns the number of all possible actions, even though only  2-4 of</span>
<span class="sd">    these will ever be valid on a given turn.</span>
<span class="sd">    Actions correspond to integer indexes of board locations,</span>
<span class="sd">    moves to g,r,c coordinate indexes of board locations</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span>


  <span class="k">def</span> <span class="nf">get_batch_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Returns the number of actions, only 0-4 of these will ever be valid.</span>
<span class="sd">    Actions correspond to integer indexes of board locations,</span>
<span class="sd">    moves to r,c indexes of board locations</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span>


  <span class="k">def</span> <span class="nf">string_rep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" A bytestring representation board g's state in the batch of boards"""</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">][</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span> <span class="o">+</span> <span class="n">board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span> <span class="o">+</span>
            <span class="n">board</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">][</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>


  <span class="k">def</span> <span class="nf">get_square_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">piece</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" Translate integer piece value to symbol for display"""</span>
    <span class="k">if</span> <span class="n">piece</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
      <span class="k">return</span> <span class="s2">"X"</span>
    <span class="k">elif</span> <span class="n">piece</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">return</span> <span class="s2">"-"</span>
    <span class="k">elif</span> <span class="n">piece</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
      <span class="k">return</span> <span class="s2">"0"</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="s2">"???????????????????????????"</span>


  <span class="k">def</span> <span class="nf">string_rep_readable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" A human readable representation of g-th board's state in the batch"""</span>
    <span class="n">board_s</span> <span class="o">=</span> <span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">get_square_symbol</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">][</span><span class="n">g</span><span class="p">]</span>
                          <span class="k">for</span> <span class="n">square</span> <span class="ow">in</span> <span class="n">row</span><span class="p">])</span>
    <span class="n">board_s</span> <span class="o">=</span> <span class="n">board_s</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][</span><span class="n">g</span><span class="p">])</span>
    <span class="n">board_s</span> <span class="o">=</span> <span class="n">board_s</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">][</span><span class="n">g</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">board_s</span>


  <span class="k">def</span> <span class="nf">get_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>


  <span class="k">def</span> <span class="nf">get_rounds_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">board</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>


  <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Displays the g-th games in the batch of boards"""</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"   "</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">c_</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">" "</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"-----------------------"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">c_</span><span class="p">,</span> <span class="s2">"|"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span>    <span class="c1"># Print the row</span>
      <span class="k">for</span> <span class="n">r_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">):</span>
        <span class="n">piece</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">][</span><span class="n">g</span><span class="p">,</span><span class="n">c_</span><span class="p">,</span><span class="n">r_</span><span class="p">]</span>    <span class="c1"># Get the piece to print</span>
        <span class="c1">#print(piece)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_square_symbol</span><span class="p">(</span><span class="n">piece</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">" "</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">"|"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"-----------------------"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Rounds Left: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">][</span><span class="n">g</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Score: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][</span><span class="n">g</span><span class="p">]))</span>


  <span class="k">def</span> <span class="nf">get_critter_rc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">critter_index</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">][</span><span class="n">g</span><span class="p">]</span><span class="o">==</span><span class="n">critter_index</span><span class="p">)))</span>


  <span class="k">def</span> <span class="nf">plot_moves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">player0</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">player1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p0_name</span><span class="o">=</span><span class="s1">'Player 0'</span><span class="p">,</span> <span class="n">p1_name</span><span class="o">=</span><span class="s1">'Player 1'</span><span class="p">,</span>
                 <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">critter_name</span><span class="o">=</span><span class="s1">'Critter'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">deterministic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Uses plotting functions to make picture of the current board state, and what</span>
<span class="sd">    a critter would do at each non-food location in the current board state</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="nf">make_prob_dict</span><span class="p">(</span><span class="n">critter_locs</span><span class="p">,</span> <span class="n">play</span><span class="p">):</span>
      <span class="n">offset_dict</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="s1">'right'</span><span class="p">,</span>
                     <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="s1">'left'</span><span class="p">,</span>
                     <span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="s1">'down'</span><span class="p">,</span>
                     <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="s1">'up'</span><span class="p">}</span>
      <span class="n">index_probs</span> <span class="o">=</span> <span class="n">play</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
      <span class="n">loc_prob_dict</span> <span class="o">=</span> <span class="p">{}</span>
      <span class="c1"># for each non food locations</span>
      <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">loc_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">critter_locs</span><span class="p">):</span>
        <span class="c1"># this is the location as an r, c tuple</span>
        <span class="n">rc_tup</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">((</span><span class="n">loc_</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">loc_</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="c1"># the relevant probabilities</span>
        <span class="n">raw_probs</span> <span class="o">=</span> <span class="n">index_probs</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
        <span class="n">probs</span> <span class="o">=</span> <span class="n">raw_probs</span><span class="p">[</span><span class="n">raw_probs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">raw_probs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># turn the probability indexes into r, c coords</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">indexes</span><span class="p">,</span> <span class="n">gwg</span><span class="o">.</span><span class="n">n_cols</span><span class="p">)</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">indexes</span><span class="p">,</span> <span class="n">gwg</span><span class="o">.</span><span class="n">n_cols</span><span class="p">)</span>
        <span class="n">moves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">z</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">)]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#compute the offsets and turn them to strings</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="n">moves</span> <span class="o">-</span> <span class="n">loc_</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">str_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">offset_dict</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">offsets</span><span class="p">))))</span>
        <span class="c1"># update the loc_prob_dict for plotting</span>
        <span class="n">prob_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">str_offsets</span><span class="p">,</span> <span class="n">probs</span><span class="p">))</span>
        <span class="n">loc_prob_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">rc_tup</span><span class="p">:</span> <span class="n">prob_dict</span><span class="p">})</span>
      <span class="k">return</span> <span class="n">loc_prob_dict</span>

    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">make_grid</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>

    <span class="n">rc_food_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">][</span><span class="n">g</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">rc_food_plotting</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rc_food_index</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">food</span> <span class="o">=</span> <span class="n">plot_food</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">rc_food_plotting</span><span class="p">)</span>

    <span class="n">expanded_board</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">critter_everywhere_state_expansion</span><span class="p">(</span>
      <span class="n">board</span><span class="p">,</span> <span class="n">player0</span><span class="o">.</span><span class="n">critter_index</span><span class="p">,</span> <span class="n">to_expand</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
    <span class="n">critter_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">expanded_board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">==</span><span class="n">player0</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>
    <span class="c1">#play the expanded state</span>
    <span class="n">p0_play</span> <span class="o">=</span> <span class="n">player0</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">expanded_board</span><span class="p">)</span>
    <span class="c1">#get the prob dict</span>
    <span class="n">p0_loc_prob_dict</span> <span class="o">=</span> <span class="n">make_prob_dict</span><span class="p">(</span><span class="n">critter_locs</span><span class="p">,</span> <span class="n">p0_play</span><span class="p">)</span>
    <span class="c1"># same for player1 if there is one</span>
    <span class="k">if</span> <span class="n">player1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">p1_play</span> <span class="o">=</span> <span class="n">player1</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">expanded_board</span><span class="p">)</span>
      <span class="n">p1_loc_prob_dict</span> <span class="o">=</span> <span class="n">make_prob_dict</span><span class="p">(</span><span class="n">critter_locs</span><span class="p">,</span> <span class="n">p1_play</span><span class="p">)</span>

    <span class="n">existing_handels</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">player1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">leg_handles_0</span> <span class="o">=</span> <span class="n">plot_directions</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">p0_loc_prob_dict</span><span class="p">,</span>
        <span class="n">critter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="n">deterministic</span><span class="p">)</span>
      <span class="n">leg_handles</span> <span class="o">=</span> <span class="n">existing_handels</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">leg_handles_0</span> <span class="o">=</span> <span class="n">plot_directions</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">p0_loc_prob_dict</span><span class="p">,</span>
        <span class="n">critter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="n">deterministic</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">p0_name</span><span class="p">)</span>
      <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">leg_handles_1</span> <span class="o">=</span> <span class="n">plot_directions</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">p1_loc_prob_dict</span><span class="p">,</span>
        <span class="n">critter</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="n">deterministic</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">p1_name</span><span class="p">)</span>
      <span class="n">leg_handles</span> <span class="o">=</span> <span class="n">existing_handels</span> <span class="o">+</span> <span class="n">leg_handles_0</span> <span class="o">+</span> <span class="n">leg_handles_1</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">leg_handles</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">"outside right upper"</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>


  <span class="k">def</span> <span class="nf">plot_board</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">critter_specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">food</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fov</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">legend_type</span><span class="o">=</span><span class="s1">'included'</span><span class="p">,</span>
                 <span class="n">has_fov</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1">#fog_of_war feild_of_view</span>
                 <span class="n">fov_opaque</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1">#let human see trhough fog of war or not</span>
                 <span class="n">radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">name</span><span class="o">=</span><span class="s1">'Critter'</span><span class="p">,</span>
                 <span class="n">focal_critter_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Uses plotting functions to make picture of the current board state"""</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">make_grid</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># generate critter plotting specs if we don't already have them</span>
    <span class="k">if</span> <span class="n">critter_specs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">critter_specs</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'h'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">]</span>  <span class="c1"># hexagon and diamond</span>
      <span class="n">colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">"colorblind"</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span><span class="p">):</span>
        <span class="n">critter_name</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">'</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'marker'</span><span class="p">:</span> <span class="n">markers</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">markers</span><span class="p">)],</span>
                <span class="s1">'color'</span><span class="p">:</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="nb">len</span><span class="p">(</span><span class="n">markers</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)],</span>
                <span class="s1">'name'</span><span class="p">:</span> <span class="n">critter_name</span><span class="p">,</span>
                <span class="s1">'int_id'</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span>
        <span class="n">critter_specs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
    <span class="c1"># get critter locs and plot them</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">critter_specs</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span><span class="p">,</span> <span class="s2">"More/fewer specs than critters"</span>
    <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">critter_specs</span><span class="p">:</span>
      <span class="n">rc_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">][</span><span class="n">g</span><span class="p">]</span> <span class="o">==</span> <span class="n">spec</span><span class="p">[</span><span class="s1">'int_id'</span><span class="p">]))</span><span class="o">.</span><span class="n">T</span>
      <span class="n">spec</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">'rc_loc'</span><span class="p">:</span> <span class="n">rc_loc</span><span class="p">})</span>
    <span class="n">critter_specs</span> <span class="o">=</span> <span class="n">plot_critters</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">critter_specs</span><span class="p">)</span>

    <span class="c1"># get food locs and plot them</span>
    <span class="n">rc_food_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">][</span><span class="n">g</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">rc_food_plotting</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rc_food_index</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="k">if</span> <span class="n">food</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">food</span> <span class="o">=</span> <span class="n">plot_food</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">rc_food_plotting</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">food</span> <span class="o">=</span> <span class="n">plot_food</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">rc_food_plotting</span><span class="p">,</span> <span class="n">food</span><span class="p">)</span>

    <span class="c1">#plot field of view if doing that</span>
    <span class="k">if</span> <span class="n">has_fov</span><span class="p">:</span>
      <span class="c1"># plot field of view around the 'active player'</span>
      <span class="k">if</span> <span class="n">fov</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fov</span> <span class="o">=</span> <span class="n">plot_fov</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">critter_specs</span><span class="p">[</span><span class="n">focal_critter_index</span><span class="p">][</span><span class="s1">'rc_loc'</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">has_fov</span><span class="p">,</span> <span class="n">opaque</span><span class="o">=</span><span class="n">fov_opaque</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">fov</span> <span class="o">=</span> <span class="n">plot_fov</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">critter_specs</span><span class="p">[</span><span class="n">focal_critter_index</span><span class="p">][</span><span class="s1">'rc_loc'</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">has_fov</span><span class="p">,</span> <span class="n">opaque</span><span class="o">=</span><span class="n">fov_opaque</span><span class="p">,</span> <span class="n">fov</span><span class="o">=</span><span class="n">fov</span><span class="p">)</span>
    <span class="c1"># make legend and draw and return figure</span>
    <span class="k">if</span> <span class="n">legend_type</span> <span class="o">==</span> <span class="s1">'included'</span><span class="p">:</span>
      <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s2">"outside right upper"</span><span class="p">,</span> <span class="n">markerscale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
      <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
      <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">critter_specs</span><span class="p">,</span> <span class="n">food</span><span class="p">,</span> <span class="n">fov</span>
    <span class="k">elif</span> <span class="n">legend_type</span> <span class="o">==</span> <span class="s1">'separate'</span><span class="p">:</span>
      <span class="n">fig_legend</span><span class="p">,</span> <span class="n">ax_legend</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">'constrained'</span><span class="p">)</span>
      <span class="n">fig_legend</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">w_pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
      <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
      <span class="n">ax_legend</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">markerscale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
      <span class="n">ax_legend</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
      <span class="n">fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">header_visible</span> <span class="o">=</span> <span class="kc">False</span>
      <span class="n">fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">toolbar_visible</span> <span class="o">=</span> <span class="kc">False</span>
      <span class="n">fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">resizable</span> <span class="o">=</span> <span class="kc">False</span>
      <span class="n">fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">footer_visible</span> <span class="o">=</span> <span class="kc">False</span>
      <span class="n">fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
      <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">critter_specs</span><span class="p">,</span> <span class="n">food</span><span class="p">,</span> <span class="n">fov</span><span class="p">,</span> <span class="n">fig_legend</span><span class="p">,</span> <span class="n">ax_legend</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#no legend</span>
      <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
      <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">critter_specs</span><span class="p">,</span> <span class="n">food</span><span class="p">,</span> <span class="n">fov</span>


  <span class="k">def</span> <span class="nf">get_legal_moves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    A Helper function to get the legal moves, as set of batch, row, col triples</span>
<span class="sd">    giving for the given board. Does return moves that are technically legal</span>
<span class="sd">    but that will result in a blocking move, this is good for a random valid</span>
<span class="sd">    player, so that the don't have a high probability of staying still if</span>
<span class="sd">    there are lots of blocking moves.</span>

<span class="sd">    Args:</span>
<span class="sd">      board: a triple of np arrays representing board state</span>
<span class="sd">        pieces,       - batch_size x n_rows x n_cols</span>
<span class="sd">        scores,       - batch_size</span>
<span class="sd">        rounds_left   - batch_size</span>
<span class="sd">      critter (int): value of critter we are getting the valid actions for</span>
<span class="sd">      radius (int): how far, in city block distance the critter can move</span>

<span class="sd">    Returns:</span>
<span class="sd">      moves: set or tuples (g, r, c)</span>
<span class="sd">    """</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">GridworldBoard</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span>
                       <span class="n">n_cols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_food</span><span class="p">,</span>
                       <span class="n">num_prey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_prey</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_pred</span><span class="p">,</span>
                       <span class="n">lifetime</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lifetime</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="n">legal_moves</span> <span class="o">=</span>  <span class="n">b</span><span class="o">.</span><span class="n">get_legal_moves</span><span class="p">(</span><span class="n">critter</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">legal_moves</span>


  <span class="k">def</span> <span class="nf">get_legal_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    A Helper function to the legal moves, as an array where each row is</span>
<span class="sd">    a batch, row, col index giving legal moves on a given board. Includes</span>
<span class="sd">    blocking moves, but excludes offsets that will take the critter off the</span>
<span class="sd">    board</span>

<span class="sd">    Args:</span>
<span class="sd">      board: a triple of np arrays representing board state</span>
<span class="sd">        pieces,       - batch_size x n_rows x n_cols</span>
<span class="sd">        scores,       - batch_size</span>
<span class="sd">        rounds_left   - batch_size</span>
<span class="sd">      critter (int): value of critter we are getting the valid actions for</span>
<span class="sd">      radius (int): how far, in city block distance the critter can move</span>

<span class="sd">    Returns:</span>
<span class="sd">      moves: set or tuples (g, r, c)</span>
<span class="sd">    """</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">GridworldBoard</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span>
                       <span class="n">n_cols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_food</span><span class="p">,</span>
                       <span class="n">num_prey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_prey</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_pred</span><span class="p">,</span>
                       <span class="n">lifetime</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lifetime</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="n">legal_offsets</span><span class="p">,</span> <span class="n">valid_moves_mask</span> <span class="o">=</span>  <span class="n">b</span><span class="o">.</span><span class="n">get_legal_offsets</span><span class="p">(</span><span class="n">critter</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">legal_offsets</span><span class="p">,</span> <span class="n">valid_moves_mask</span>


  <span class="k">def</span> <span class="nf">get_valid_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    A Helper function to translate the g,x,y, tuples provided the</span>
<span class="sd">    GridworldBoard.get_legal_moves method into valid actions, represented</span>
<span class="sd">    as binary vectors of len num_actions.</span>

<span class="sd">    Args:</span>
<span class="sd">      board: a triple of np arrays representing board state</span>
<span class="sd">        pieces,       - batch_size x n_rows x n_cols</span>
<span class="sd">        scores,       - batch_size</span>
<span class="sd">        rounds_left   - batch_size</span>
<span class="sd">      critter (int): value of critter we are getting the valid actions for</span>
<span class="sd">      radius (int): how far, in city block distance the critter can move</span>

<span class="sd">    Returns:</span>
<span class="sd">      valids: np.ndarray(binary) batch_size x num_actions, 1's represent</span>
<span class="sd">              valid moves</span>
<span class="sd">    """</span>
    <span class="n">legal_moves</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">get_legal_moves</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
    <span class="n">g</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">legal_moves</span><span class="p">)</span>
    <span class="n">valids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">))</span>
    <span class="n">valids</span><span class="p">[</span><span class="n">g</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">valids</span>


  <span class="k">def</span> <span class="nf">display_moves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Displays possible moves for the g-th games in the batch of boards"""</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_valid_actions</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="p">)[</span><span class="n">g</span><span class="p">],</span>
                 <span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"  "</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"possible moves"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"   "</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">" "</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"-----------------------"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s2">"|"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span>    <span class="c1"># Print the row</span>
      <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">):</span>
        <span class="n">piece</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">row</span><span class="p">]</span>    <span class="c1"># Get the piece to print</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_square_symbol</span><span class="p">(</span><span class="n">piece</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">" "</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">"|"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"-----------------------"</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">get_perceptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">critter</span><span class="p">):</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">GridworldBoard</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span>
                       <span class="n">n_cols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_food</span><span class="p">,</span>
                       <span class="n">num_prey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_prey</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_pred</span><span class="p">,</span>
                       <span class="n">lifetime</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lifetime</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get_perceptions</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">critter</span><span class="p">))</span>


  <span class="k">def</span> <span class="nf">get_next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">a_indx</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Helper function using GridworldBoard.execute_moves to update board state</span>
<span class="sd">    given actions on a batch of boards, for a given critter</span>

<span class="sd">    Args:</span>
<span class="sd">      board: a triple of np arrays representing board state</span>
<span class="sd">        pieces,       - batch_size x n_rows x n_cols</span>
<span class="sd">        scores,       - batch_size</span>
<span class="sd">        rounds_left   - batch_size</span>
<span class="sd">      critter: integer index of the critter type</span>
<span class="sd">      actions: list of flat integer indexes of critter's new board positions</span>
<span class="sd">      a_indx: list of integer indexes indicating which actions are being taken</span>
<span class="sd">        on which boards in the batch</span>

<span class="sd">    Returns:</span>
<span class="sd">      a board triple signifying next state</span>

<span class="sd">    Note:</span>
<span class="sd">      if len(actions) &gt; batch_size of board the returned board state will have</span>
<span class="sd">      an expanded batch size, allowing multiple paths in the game tree to be</span>
<span class="sd">      explored in parallel</span>

<span class="sd">    """</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
      <span class="c1"># assumes all boards in the batch have the same rounds left</span>
      <span class="c1"># no rounds left return the board unchanged</span>
      <span class="k">return</span> <span class="n">board</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">b</span> <span class="o">=</span> <span class="n">GridworldBoard</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">),</span> <span class="n">n_rows</span><span class="o">=</span><span class="n">n_rows</span><span class="p">,</span>
                         <span class="n">n_cols</span><span class="o">=</span><span class="n">n_cols</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_food</span><span class="p">,</span>
                         <span class="n">num_prey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_prey</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_pred</span><span class="p">,</span>
                         <span class="n">lifetime</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lifetime</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>

      <span class="k">if</span> <span class="n">a_indx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># just one move on each board in the batch</span>
        <span class="k">assert</span> <span class="n">batch_size</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">b</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1"># potentially multiple moves on each board, expand the batch</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_indx</span><span class="p">)</span>
        <span class="n">new_pieces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">][</span><span class="n">ai</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="n">a_indx</span><span class="p">])</span>
        <span class="n">new_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][</span><span class="n">ai</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="n">a_indx</span><span class="p">])</span>
        <span class="n">new_rounds_left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">board</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">][</span><span class="n">ai</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="n">a_indx</span><span class="p">])</span>
        <span class="n">new_active_player</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'active_player'</span><span class="p">])</span>
        <span class="n">new_state</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'pieces'</span><span class="p">:</span> <span class="n">new_pieces</span><span class="p">,</span>
                     <span class="s1">'scores'</span><span class="p">:</span> <span class="n">new_scores</span><span class="p">,</span>
                     <span class="s1">'rounds_left'</span><span class="p">:</span> <span class="n">new_rounds_left</span><span class="p">,</span>
                     <span class="s1">'active_player'</span><span class="p">:</span> <span class="n">new_active_player</span><span class="p">}</span>
        <span class="n">b</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">new_state</span><span class="p">)</span>
      <span class="n">moves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions_to_moves</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
      <span class="n">b</span><span class="o">.</span><span class="n">execute_moves</span><span class="p">(</span><span class="n">moves</span><span class="p">,</span> <span class="n">critter</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span>


  <span class="k">def</span> <span class="nf">actions_to_moves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Args:</span>
<span class="sd">      actions: a batch length list of integer indexes for the flattened boards,</span>
<span class="sd">      i.e. in the range(n_cols * n_rows) actions are often much easier to use</span>
<span class="sd">      as training targets for NN based RL agents.</span>
<span class="sd">    Returns</span>
<span class="sd">      moves: a 3-tuple of 1-d arrays each of length batch_size,</span>
<span class="sd">        the first array gives the specific board within the batch,</span>
<span class="sd">        the second array in the tuple gives the new row coord for each critter</span>
<span class="sd">        on each board and the third gives the new col coord. Note this is</span>
<span class="sd">        exactly the format expected by GridworldBoard.execute_moves, and</span>
<span class="sd">        is a canonical way of indexing arrays for quick numpy operations.</span>
<span class="sd">    """</span>
    <span class="n">moves</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)),</span>
             <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">),</span>
             <span class="n">np</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">moves</span>


  <span class="k">def</span> <span class="nf">moves_to_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moves</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Args:</span>
<span class="sd">      moves: a 3-tuple of 1-d arrays each of length batch_size,</span>
<span class="sd">        the first array gives the specific board within the batch,</span>
<span class="sd">        the second array in the tuple gives the new row coord for each critter</span>
<span class="sd">        on each board and the third gives the new col coord. Note this is</span>
<span class="sd">        exactly the format expected by GridworldBoard.execute_moves, and</span>
<span class="sd">        is a canonical way of indexing arrays for quick numpy operations.</span>
<span class="sd">    Returns:</span>
<span class="sd">      actions: a batch length list of integer indexes for the flattened boards,</span>
<span class="sd">      i.e. in the range(n_cols * n_rows) actions are often much easier to use</span>
<span class="sd">      as training targets for NN based RL agents.</span>
<span class="sd">    """</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">moves</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="n">rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span> <span class="o">+</span> <span class="n">cols</span>
    <span class="k">return</span> <span class="n">actions</span>


  <span class="k">def</span> <span class="nf">critter_oriented_get_next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="p">,</span> <span class="n">offsets</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Translates directions in reference to the critter's location into</span>
<span class="sd">    moves on the board in absolute terms, while checking for</span>
<span class="sd">    bouncing/reflecting then get's the next state.</span>

<span class="sd">    Args:</span>
<span class="sd">      board: a triple of np arrays representing board state</span>
<span class="sd">        pieces,       - batch_size x n_rows x n_cols</span>
<span class="sd">        scores,       - batch_size</span>
<span class="sd">        rounds_left   - batch_size</span>
<span class="sd">      offsets: batch length list of strings one 'up', 'down', 'left', 'right'</span>

<span class="sd">    Returns:</span>
<span class="sd">      a board triple signifying next state</span>

<span class="sd">    Note:</span>
<span class="sd">      Unlike get_next_state, this method does not allow for expansion</span>
<span class="sd">      of the game tree, i.e. len(offsets)==batch_size required</span>
<span class="sd">    """</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">offsets</span><span class="p">)</span> <span class="o">==</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">GridworldBoard</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span>
                       <span class="n">n_cols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_food</span><span class="p">,</span>
                       <span class="n">num_prey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_prey</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_pred</span><span class="p">,</span>
                       <span class="n">lifetime</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lifetime</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="n">moves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">critter_direction_to_move</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">offsets</span><span class="p">,</span> <span class="n">critter</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">execute_moves</span><span class="p">(</span><span class="n">moves</span><span class="p">,</span> <span class="n">critter</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get_state</span><span class="p">())</span>


  <span class="k">def</span> <span class="nf">critter_direction_to_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">offsets</span><span class="p">,</span> <span class="n">critter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Translates directions in reference to the critter's location into</span>
<span class="sd">    moves on the board in absolute terms, while checking for</span>
<span class="sd">    bouncing/reflecting then returns moves. Doesn't check for collisions with</span>
<span class="sd">    other critters though. In general player's move methods should be checking</span>
<span class="sd">    valid moves and only making legal ones.</span>

<span class="sd">    Args:</span>
<span class="sd">      board: dict of np arrays representing board state</span>
<span class="sd">        'pieces':       batch_size x n_rows x n_cols</span>
<span class="sd">        'scores':       batch_size</span>
<span class="sd">        'rounds_left':  batch_size</span>
<span class="sd">      offsets: batch length list of strings,</span>
<span class="sd">        one of 'up', 'down', 'left', 'right'</span>
<span class="sd">      critter: integer index for the critter we want moves for</span>

<span class="sd">    Returns:</span>
<span class="sd">      moves: a 3-tuple of 1-d arrays each of length batch_size,</span>
<span class="sd">        the first array gives the specific board within the batch,</span>
<span class="sd">        the second array in the tuple gives the new row coord for each critter</span>
<span class="sd">        on each board and the third gives the new col coord. Note this is</span>
<span class="sd">        exactly the format expected by GridworldBoard.execute_moves, and</span>
<span class="sd">        is a canonical way of indexing arrays for numpy.</span>

<span class="sd">    Note:</span>
<span class="sd">      Unlike get_next_state, this method does not allow for expansion</span>
<span class="sd">      of the game tree, i.e. len(offsets)==batch_size required</span>
<span class="sd">    """</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">offsets</span><span class="p">)</span> <span class="o">==</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">offset_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'up'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                   <span class="s1">'down'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                   <span class="s1">'left'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                   <span class="s1">'right'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                   <span class="s1">'still'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)}</span>
    <span class="n">this_critter_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span> <span class="o">==</span> <span class="n">critter</span><span class="p">)</span>
    <span class="n">all_critter_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">offsets_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offset_dict</span><span class="p">[</span><span class="n">ost_</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
                           <span class="k">for</span> <span class="n">ost_</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">])</span>
    <span class="n">new_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">this_critter_locs</span><span class="p">)</span> <span class="o">+</span> <span class="n">offsets_array</span>
    <span class="c1">#check bounces at boundaries</span>
    <span class="n">new_locs</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">new_locs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span>
                               <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">new_locs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">new_locs</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">new_locs</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">&gt;=</span>
                               <span class="n">n_cols</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">new_locs</span><span class="p">[</span><span class="mi">2</span><span class="p">,:])</span>
    <span class="n">new_locs</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">new_locs</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">new_locs</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>
    <span class="n">new_locs</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">new_locs</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">new_locs</span><span class="p">[</span><span class="mi">2</span><span class="p">,:])</span>
    <span class="n">moves</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_locs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">moves</span>


  <span class="k">def</span> <span class="nf">direction_probs_to_flat_probs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">direction_probs</span><span class="p">,</span> <span class="n">critter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Converts direction probabilities in reference to the critter's location into</span>
<span class="sd">    probability arrays on the flattened board.</span>

<span class="sd">    Args:</span>
<span class="sd">      board: dict of np arrays representing board state</span>
<span class="sd">        'pieces':       batch_size x n_rows x n_cols</span>
<span class="sd">        'scores':       batch_size</span>
<span class="sd">        'rounds_left':  batch_size</span>
<span class="sd">      direction_probs: batch length list of dictionaries with keys</span>
<span class="sd">        ['up', 'down', 'left', 'right'] and corresponding probabilities.</span>

<span class="sd">    Returns:</span>
<span class="sd">      probs_arrays: list of arrays, where each array is of length n_rows*n_cols</span>
<span class="sd">                    and represents the flattened probability distribution for</span>
<span class="sd">                    board in the batch.</span>
<span class="sd">    """</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">offset_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">'up'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
        <span class="s1">'down'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
        <span class="s1">'left'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
        <span class="s1">'right'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))}</span>
    <span class="n">critter_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span> <span class="o">==</span> <span class="n">critter</span><span class="p">)</span>
    <span class="n">probs_arrays</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="n">n_cols</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">batch_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">):</span>
      <span class="n">prob_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_rows</span> <span class="o">*</span> <span class="n">n_cols</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">direction</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">direction_probs</span><span class="p">[</span><span class="n">batch_index</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
          <span class="n">offset</span> <span class="o">=</span> <span class="n">offset_dict</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span>
          <span class="n">new_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">critter_locs</span><span class="p">)[:,</span> <span class="n">batch_index</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span>
          <span class="c1"># Check bounces at boundaries</span>
          <span class="n">new_loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">new_loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">new_loc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
          <span class="n">new_loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">new_loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">new_loc</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
          <span class="n">new_loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">new_loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">new_loc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
          <span class="n">new_loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">new_loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">new_loc</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
          <span class="c1"># Convert 2D location to flattened index</span>
          <span class="n">flattened_index</span> <span class="o">=</span> <span class="n">new_loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_cols</span> <span class="o">+</span> <span class="n">new_loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
          <span class="n">prob_array</span><span class="p">[</span><span class="n">flattened_index</span><span class="p">]</span> <span class="o">+=</span> <span class="n">prob</span>
      <span class="n">probs_arrays</span><span class="p">[</span><span class="n">batch_index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">prob_array</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">probs_arrays</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">action_to_critter_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Translates an integer index action into up/down/left/right</span>

<span class="sd">    Args:</span>
<span class="sd">      board: a triple of np arrays representing board state</span>
<span class="sd">        pieces,       - batch_size x n_rows x n_cols</span>
<span class="sd">        scores,       - batch_size</span>
<span class="sd">        rounds_left   - batch_size</span>
<span class="sd">      actions: a batch size ndarry of integer indexes for actions on each board</span>

<span class="sd">    Returns:</span>
<span class="sd">      offsets: a batch length list of strings 'up', 'down', 'left', 'right', 'still'</span>
<span class="sd">    """</span>
    <span class="n">offset_dict</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="s1">'still'</span><span class="p">,</span>
                   <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="s1">'right'</span><span class="p">,</span>
                   <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="s1">'left'</span><span class="p">,</span>
                   <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="s1">'down'</span><span class="p">,</span>
                   <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="s1">'up'</span><span class="p">}</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">critter_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span> <span class="o">==</span> <span class="n">critter</span><span class="p">)</span>
    <span class="n">moves</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)),</span>
               <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">),</span>
               <span class="n">np</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">))</span>
    <span class="c1"># need to reverse this from above, moves is equiv to new_locs</span>
    <span class="c1"># new_locs = np.array(critter_locs) + offsets_array</span>
    <span class="n">offsets_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">moves</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">critter_locs</span><span class="p">)</span>
    <span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span><span class="n">offset_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">o_</span><span class="p">)]</span> <span class="k">for</span> <span class="n">o_</span> <span class="ow">in</span> <span class="n">offsets_array</span><span class="o">.</span><span class="n">T</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">offsets</span>


  <span class="k">def</span> <span class="nf">get_valid_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Transforms output of get_valid_actions to a list of the valid directions</span>
<span class="sd">    for each board in the batch for a given critter.</span>
<span class="sd">    """</span>
    <span class="n">offset_dict</span> <span class="o">=</span> <span class="p">{(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="s1">'right'</span><span class="p">,</span>
                   <span class="p">(</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="s1">'left'</span><span class="p">,</span>
                   <span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="s1">'down'</span><span class="p">,</span>
                   <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="s1">'up'</span><span class="p">,</span>
                   <span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="s1">'still'</span><span class="p">}</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">valid_actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_valid_actions</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">batch_size</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_actions</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Need Exactly one set of valid actions per board in batch"</span><span class="p">)</span>
    <span class="n">critter_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span> <span class="o">==</span> <span class="n">critter</span><span class="p">))</span>
    <span class="n">valid_directions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">batch_valid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">valid_actions</span><span class="p">):</span>
      <span class="n">valid_int_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">batch_valid</span><span class="o">==</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
      <span class="n">critter_loc</span> <span class="o">=</span> <span class="n">critter_locs</span><span class="p">[</span><span class="n">critter_locs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">g</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
      <span class="c1"># critter_loc shape is (1, 2)</span>
      <span class="n">critter_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">critter_loc</span><span class="p">)</span>
      <span class="n">moves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">valid_int_indices</span> <span class="o">//</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">valid_int_indices</span> <span class="o">%</span> <span class="n">n_cols</span><span class="p">])</span>
      <span class="n">offsets</span> <span class="o">=</span> <span class="n">moves</span> <span class="o">-</span> <span class="n">critter_loc</span>
      <span class="n">batch_valid_directions</span> <span class="o">=</span> <span class="p">[</span><span class="n">offset_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">offset</span><span class="p">)]</span> <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">]</span>
      <span class="n">valid_directions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_valid_directions</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">valid_directions</span>


  <span class="k">def</span> <span class="nf">get_game_ended</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Helper function to signify if game has ended</span>
<span class="sd">    Returns a batch size np.array of -1 if not ended, and scores for each game</span>
<span class="sd">    in the batch if it is ended, note only returns scores if all games in the</span>
<span class="sd">    batch have ended</span>
<span class="sd">    """</span>
    <span class="n">rounds_left</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">]</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">rounds_left</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">scores</span>


  <span class="k">def</span> <span class="nf">critter_everywhere_state_expansion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board_state</span><span class="p">,</span>
                                         <span class="n">critter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">to_expand</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Expand a given board state by placing a critter at each non-food location.</span>

<span class="sd">    The function takes a game state and returns an expanded version of it. For</span>
<span class="sd">    each board in the state, it creates a new version of the board for every</span>
<span class="sd">    non-food location, placing a critter at that location. The scores and</span>
<span class="sd">    remaining rounds are copied for each new board. The result is a new game state</span>
<span class="sd">    with a larger number of boards, each representing a possible configuration</span>
<span class="sd">    with a critter at a different location.</span>

<span class="sd">    Args:</span>
<span class="sd">      board_state (dict): A dictionary containing the current game state.</span>
<span class="sd">      It should have the following keys:</span>
<span class="sd">        - 'pieces': a 3D numpy array (batch x n_col x n_row) representing the game</span>
<span class="sd">          board. -1 -&gt; food, 0 -&gt; empty cell, and 1 -&gt; critter.</span>
<span class="sd">        - 'scores': 1D numpy array of the score for each board in the batch.</span>
<span class="sd">        - 'rounds_left': a 1D numpy array of the rounds left for</span>
<span class="sd">          each board in the batch.</span>
<span class="sd">      critter: integer index to place on the expanded board state</span>
<span class="sd">      to_expand (list (int)): list of batch indices to have state expanded</span>

<span class="sd">    Returns:</span>
<span class="sd">      dict: A dictionary containing the expanded game state with the same keys</span>
<span class="sd">        as the input. The number of boards will be larger than the input state.</span>
<span class="sd">    """</span>
    <span class="n">pieces</span> <span class="o">=</span> <span class="n">board_state</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">board_state</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">rounds_left</span> <span class="o">=</span> <span class="n">board_state</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">active_player</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'active_player'</span><span class="p">])</span>
    <span class="c1"># Determine non-food locations</span>
    <span class="n">non_food_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">pieces</span><span class="p">[</span><span class="n">to_expand</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1">#scrub all existing critter locations,</span>
    <span class="c1"># maybe later only scrub specific critter type</span>
    <span class="n">pieces</span><span class="p">[</span><span class="n">pieces</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># lists to store expanded states</span>
    <span class="n">expanded_pieces</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">expanded_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">expanded_rounds_left</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Iterate over each non-food location</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">non_food_locs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
      <span class="c1"># Create a copy of the board</span>
      <span class="n">expanded_board</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pieces</span><span class="p">[</span><span class="n">to_expand</span><span class="p">])</span>
      <span class="c1"># Place the critter at the non-food location</span>
      <span class="c1"># later consider only placing at non-food,</span>
      <span class="c1"># non-other critter locs</span>
      <span class="n">expanded_board</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">non_food_locs</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span> <span class="o">=</span> <span class="n">critter</span>
      <span class="c1"># Add the expanded board to the list along score and rounds_left</span>
      <span class="n">expanded_pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expanded_board</span><span class="p">)</span>
      <span class="n">expanded_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">to_expand</span><span class="p">])</span>
      <span class="n">expanded_rounds_left</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rounds_left</span><span class="p">[</span><span class="n">to_expand</span><span class="p">])</span>
    <span class="c1"># Convert to arrays and create expanded board state</span>
    <span class="n">expanded_state</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'pieces'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">expanded_pieces</span><span class="p">),</span>
                      <span class="s1">'scores'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">expanded_scores</span><span class="p">),</span>
                      <span class="s1">'rounds_left'</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">expanded_rounds_left</span><span class="p">),</span>
                      <span class="s1">'active_player'</span><span class="p">:</span> <span class="n">active_player</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">expanded_state</span>


  <span class="k">def</span> <span class="nf">play_game</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">players</span><span class="o">=</span><span class="p">[],</span> <span class="n">collect_fov_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">visualize</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""This method takes a list of players the same length as num_critters,</span>
<span class="sd">        and then plays a batch of games with them and returns the final board</span>
<span class="sd">        state"""</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">players</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_critters</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"number of players different than expected"</span><span class="p">)</span>

    <span class="n">board</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_init_board</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">visualize</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">collect_fov_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
      <span class="n">b</span> <span class="o">=</span> <span class="n">GridworldBoard</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span>
                         <span class="n">n_cols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_food</span><span class="p">,</span>
                         <span class="n">num_prey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_prey</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_pred</span><span class="p">,</span>
                         <span class="n">lifetime</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lifetime</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p_idx</span><span class="p">,</span> <span class="n">player_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">players</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">player_</span><span class="o">.</span><span class="n">critter_index</span> <span class="o">!=</span> <span class="n">p_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">player_</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"player order does not match assigned critter index"</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lifetime</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">player_</span> <span class="ow">in</span> <span class="n">players</span><span class="p">:</span>
        <span class="n">old_scores</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">collect_fov_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
          <span class="n">b</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
          <span class="n">percepts</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get_perceptions</span><span class="p">(</span><span class="n">fov_radius</span><span class="p">)</span>

        <span class="n">a_player</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">player_</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
        <span class="n">board</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_state</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">player_</span><span class="o">.</span><span class="n">critter_index</span><span class="p">,</span> <span class="n">a_player</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">visualize</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">board</span>




<span class="c1"># @title player zoo</span>
<span class="c1">###########################################################################</span>
<span class="c1"># make a separate player zoo</span>
<span class="c1">###########################################################################</span>

<span class="k">class</span> <span class="nc">FoodDriftPlayer</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  A player the executes the drifting pattern of the food,</span>
<span class="sd">  Treating move made by the environment as though maybe by another player as</span>
<span class="sd">  a convenient coding abstraction... also just a good way to think about things</span>
<span class="sd">  This will drift the food on the board based on the given offsets probabilities.</span>
<span class="sd">  Collisions are handled by the execute moves logic of the board object</span>

<span class="sd">  Parameters:</span>
<span class="sd">  - offset_probs: Probabilities corresponding to each offset, note implicit</span>
<span class="sd">    order dependence here</span>
<span class="sd">  - wrapping, a boolean indicating whether drifting food can fall off the edge</span>
<span class="sd">    of the board and re-appear on the other side of the board.</span>


<span class="sd">  The play method returns a batch of moves</span>
<span class="sd">    - nothing, just updates self.pieces</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">offset_probs</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
               <span class="n">wrapping</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wrap_type</span><span class="o">=</span><span class="s1">'random'</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span> <span class="o">=</span> <span class="n">critter_index</span>
    <span class="k">assert</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">critter_index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">num_food</span>  <span class="o">&lt;=</span> <span class="n">critter_index</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s2">"Value is not a negative integer or exceeds the limit."</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">offset_probs</span> <span class="o">=</span> <span class="n">offset_probs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wrapping</span> <span class="o">=</span> <span class="n">wrapping</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wrap_type</span> <span class="o">=</span> <span class="n">wrap_type</span>


  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
    <span class="n">possible_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span> <span class="c1"># up</span>
                                 <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span> <span class="c1"># down</span>
                                 <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="c1"># left</span>
                                 <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span> <span class="c1"># right</span>
                                 <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]])</span> <span class="c1"># still</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="c1"># original food locations</span>
    <span class="n">food_locations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>
    <span class="c1"># Sample offsets for each food location</span>
    <span class="n">num_food</span> <span class="o">=</span> <span class="n">food_locations</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sampled_offsets</span> <span class="o">=</span> <span class="n">possible_offsets</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">possible_offsets</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="n">size</span><span class="o">=</span><span class="n">num_food</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_probs</span><span class="p">)]</span>
    <span class="c1"># Possible new food locations</span>
    <span class="n">p_new_locs</span> <span class="o">=</span> <span class="n">food_locations</span> <span class="o">+</span> <span class="n">sampled_offsets</span>

    <span class="c1">#out of bounds rows and cols</span>
    <span class="n">oob_rows</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_new_locs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">n_rows</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">p_new_locs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">oob_cols</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_new_locs</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">n_cols</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">p_new_locs</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapping</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_type</span> <span class="o">==</span> <span class="s1">'random'</span><span class="p">:</span>
        <span class="n">p_wrap_row_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_rows</span><span class="p">),</span>
                                             <span class="n">size</span><span class="o">=</span><span class="n">num_food</span><span class="p">)</span>
        <span class="n">p_wrap_col_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_cols</span><span class="p">),</span>
                                             <span class="n">size</span><span class="o">=</span><span class="n">num_food</span><span class="p">)</span>
        <span class="n">p_new_locs</span><span class="p">[</span><span class="n">oob_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_wrap_row_indexes</span><span class="p">[</span><span class="n">oob_rows</span><span class="p">]</span>
        <span class="n">p_new_locs</span><span class="p">[</span><span class="n">oob_cols</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_wrap_col_indexes</span><span class="p">[</span><span class="n">oob_cols</span><span class="p">]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1">#deterministic wrapping</span>
        <span class="n">p_new_locs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">p_new_locs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">n_rows</span><span class="p">)</span>
        <span class="n">p_new_locs</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">p_new_locs</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">n_cols</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1"># they don't move if they hit an edge</span>
      <span class="n">p_new_locs</span><span class="p">[</span><span class="n">oob_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">food_locations</span><span class="p">[</span><span class="n">oob_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
      <span class="n">p_new_locs</span><span class="p">[</span><span class="n">oob_cols</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">food_locations</span><span class="p">[</span><span class="n">oob_cols</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">p_new_locs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_cols</span> <span class="o">+</span> <span class="n">p_new_locs</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">a_1hots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">*</span><span class="n">n_rows</span><span class="p">))</span>
    <span class="n">a_1hots</span><span class="p">[(</span><span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">a</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">a_1hots</span><span class="p">,</span> <span class="n">a_1hots</span><span class="p">,</span> <span class="n">p_new_locs</span>


<span class="k">class</span> <span class="nc">RandomValidPlayer</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Instantiate random player for GridWorld, could be prey or pred... or even food</span>
<span class="sd">  It leans hard on the game's get valid method and then just samples from there</span>
<span class="sd">  """</span>


  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span> <span class="o">=</span> <span class="n">critter_index</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="n">speed</span>
    <span class="k">assert</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">critter_index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span>
        <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">critter_index</span> <span class="o">&lt;=</span> <span class="n">game</span><span class="o">.</span><span class="n">num_critters</span><span class="p">),</span> <span class="s2">"Value is not a positive integer or exceeds the upper limit."</span>


  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Simulates a batch of random game plays based on the given board state.</span>

<span class="sd">    This function computes the probability of each valid move being played</span>
<span class="sd">    (uniform for valid moves, 0 for others), then selects a move randomly for</span>
<span class="sd">    each game in the batch based on these probabilities.</span>

<span class="sd">    Args:</span>
<span class="sd">      board (dict): A dictionary representing the state of the game. It</span>
<span class="sd">          contains:</span>
<span class="sd">          - 'pieces': A (batch_size, x_size, y_size) numpy array indicating</span>
<span class="sd">                      the pieces on the board.</span>
<span class="sd">          - 'scores' (not used directly in this function, but expected in dict)</span>
<span class="sd">          - 'rounds_left' (not used directly in this function, but expected in dict)</span>

<span class="sd">    Returns:</span>
<span class="sd">      tuple:</span>
<span class="sd">      - a (numpy array): An array of shape (batch_size,) containing randomly</span>
<span class="sd">                         chosen actions for each game in the batch.</span>
<span class="sd">      - a_1hots (numpy array): An array of shape (batch_size, action_size)</span>
<span class="sd">                               with one-hot encoded actions.</span>
<span class="sd">      - probs (numpy array): An array of the same shape as 'valids' containing</span>
<span class="sd">                             the probability of each move being played.</span>
<span class="sd">    """</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">x_size</span><span class="p">,</span> <span class="n">y_size</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_valid_actions</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">)</span>
    <span class="n">action_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_action_size</span><span class="p">()</span>

    <span class="n">probs</span> <span class="o">=</span> <span class="n">valids</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">valids</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">action_size</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">probs</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                                <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)]</span>
    <span class="n">a_1hots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">action_size</span><span class="p">))</span>
    <span class="n">a_1hots</span><span class="p">[(</span><span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">a</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">a_1hots</span><span class="p">,</span> <span class="n">probs</span>




<span class="k">class</span> <span class="nc">GeneralLinearPlayer</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  A Player playing a linear policy defined by the given weights. Content and</span>
<span class="sd">  size of percept is parameterized, as is speed. Whether it is treated as a</span>
<span class="sd">  prey or predator type by the game depends on the critter_index, specifically</span>
<span class="sd">  0 &lt; critter_index &lt;= game.pred_prey_threshold --&gt; prey type</span>
<span class="sd">  game.pred_prey_threshold &lt; critter_index --&gt; predator type</span>
<span class="sd">  note that many game loops re-assign critter index based on the order of the</span>
<span class="sd">  player list handed to the game loop.</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">has_food_percept</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>  <span class="n">has_edge_percept</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">has_prey_percept</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">has_pred_percept</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">get_probs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Args:</span>
<span class="sd">      game: Gridworld Game instance</span>
<span class="sd">        Instance of the gridworldGame class above;</span>
<span class="sd">      weights: a numpy array that gives the connection strengths between the</span>
<span class="sd">      'perception' neurons and the direction 'neurons'</span>
<span class="sd">      fov_radius: int how far around itself the critter perceives</span>
<span class="sd">      speed: int how many grid cells a critter can move in a round</span>
<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>
    <span class="c1"># all critters need these things</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span> <span class="o">=</span> <span class="n">critter_index</span>
    <span class="k">assert</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">critter_index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span>
        <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">critter_index</span> <span class="o">&lt;=</span> <span class="n">game</span><span class="o">.</span><span class="n">num_critters</span><span class="p">),</span> <span class="s2">"Value is not a positive integer or exceeds the upper limit."</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_probs</span> <span class="o">=</span> <span class="n">get_probs</span>
    <span class="c1"># these things are specific to this kind of critter</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="n">deterministic</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span> <span class="o">=</span> <span class="n">fov_radius</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="n">speed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">W_out_shape</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">W_in_shape</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_food_percept</span> <span class="o">=</span> <span class="n">has_food_percept</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_edge_percept</span> <span class="o">=</span> <span class="n">has_edge_percept</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_prey_percept</span> <span class="o">=</span> <span class="n">has_prey_percept</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_pred_percept</span> <span class="o">=</span> <span class="n">has_pred_percept</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">W_layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">has_food_percept</span><span class="p">,</span> <span class="n">has_edge_percept</span><span class="p">,</span>
                            <span class="n">has_prey_percept</span><span class="p">,</span> <span class="n">has_pred_percept</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">W_layers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_out_shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_in_shape</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">weights</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W_layers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_out_shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_in_shape</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Weights don't match expected shape given fov, speed, and percepts"</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_softmax_temp</span> <span class="o">=</span> <span class="mf">0.05</span>


  <span class="k">def</span> <span class="nf">direction_value_from_percept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percepts</span><span class="p">,</span> <span class="n">W</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Determine an action based on perception.</span>

<span class="sd">    Args:</span>
<span class="sd">      percept: A batch by self.W_in_shape array representing the perceptions of</span>
<span class="sd">        the organism. Indices correspond to spaces around the organism. The</span>
<span class="sd">        values in the array can be -200 (out-of-bounds), 0 (empty space),</span>
<span class="sd">        or negative integers (food), or positive integers below or equal</span>
<span class="sd">        game.pred_prey_threshold for prey organisms or positive integers above</span>
<span class="sd">        game.predy_prey_threshold for predator organisms</span>
<span class="sd">      W: a W_layers x W_out_shape x W_in_shape weight matrix of parameters</span>
<span class="sd">        representing the connection strengths between the perception inputs and</span>
<span class="sd">        the possible output actions.</span>

<span class="sd">    Returns:</span>
<span class="sd">      output: raw output activations, these filtered by which moves are valid</span>
<span class="sd">        and then softmax normalized later</span>
<span class="sd">    """</span>
    <span class="n">expanded_percepts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_food_percept</span><span class="p">:</span>
      <span class="n">x_food</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">((</span><span class="n">percepts</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">percepts</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">200</span><span class="p">),</span> <span class="nb">float</span><span class="p">)</span> <span class="c1"># batch x len W_in</span>
      <span class="n">expanded_percepts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_food</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_edge_percept</span><span class="p">:</span>
      <span class="n">x_edge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">percepts</span> <span class="o">==</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="c1"># batch x len W_in</span>
      <span class="n">expanded_percepts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_edge</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_prey_percept</span><span class="p">:</span>
      <span class="n">x_prey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">((</span><span class="n">percepts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span>
       <span class="p">(</span><span class="n">percepts</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">pred_prey_threshold</span><span class="p">),</span> <span class="nb">float</span><span class="p">)</span> <span class="c1"># batch x len W_in</span>
      <span class="n">expanded_percepts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_prey</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_pred_percept</span><span class="p">:</span>
      <span class="n">x_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">percepts</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">pred_prey_threshold</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="c1"># batch x len W_in</span>
      <span class="n">expanded_percepts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_pred</span><span class="p">)</span>
    <span class="n">percept_stack</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">expanded_percepts</span><span class="p">)</span> <span class="c1"># W_layers x batch x len_W_in</span>

    <span class="n">output_activations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">percept_stack</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
    <span class="c1"># output activations is batch by W_out, so each row gives the raw output</span>
    <span class="c1"># activations for that batch.</span>
    <span class="k">return</span> <span class="n">output_activations</span>


  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Simulate Play on a Board</span>

<span class="sd">    Args:</span>
<span class="sd">      board: dict {'pieces':</span>
<span class="sd">      (batch x num_rows x num_cols) np.ndarray of board position,</span>
<span class="sd">                  'scores': batch len array of current scores,</span>
<span class="sd">                  'rounds_left': batch len array of rounds left</span>

<span class="sd">    Returns:</span>
<span class="sd">      sampled_actions: a batch, row, col index of the move taken</span>
<span class="sd">      by each player on each board</span>
<span class="sd">      a_1hots: a batch nrow*ncol array of 1hot indices of those same moves</span>
<span class="sd">      v_probs: sampling probabilities for those 1hots (If the policy</span>
<span class="sd">      is deterministic a_1hots is returned here as well... or if getting the</span>
<span class="sd">      probs is an un-needed fuss to compute)</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">temp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_softmax_temp</span>
    <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">W</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">W</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">perceptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_perceptions</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span><span class="p">)</span>
    <span class="n">direction_v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction_value_from_percept</span><span class="p">(</span><span class="n">perceptions</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
    <span class="c1">#direction_v is batch x w_out, i.e. number of different moves</span>
    <span class="n">legal_offsets</span><span class="p">,</span> <span class="n">valid_moves_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_legal_offsets</span><span class="p">(</span>
        <span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">)</span>
    <span class="n">flat_dv</span> <span class="o">=</span> <span class="n">direction_v</span><span class="p">[</span><span class="n">valid_moves_mask</span><span class="p">]</span>
    <span class="n">batch_indexes</span> <span class="o">=</span> <span class="n">legal_offsets</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># turn offsets into flat indexes, i.e. ints in range(n_rows*n_cols)</span>
    <span class="n">action_indexes</span> <span class="o">=</span> <span class="n">legal_offsets</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_cols</span> <span class="o">+</span> <span class="n">legal_offsets</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># Set invalid positions to -inf</span>
    <span class="n">value_expand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">*</span><span class="n">n_cols</span><span class="p">))</span> <span class="o">*</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="c1"># Fragile order dependency here in how legal offsets and flat_dv 'line up'</span>
    <span class="c1"># and we can slot the direction values into value expand like this</span>
    <span class="n">value_expand</span><span class="p">[(</span><span class="n">batch_indexes</span><span class="p">,</span> <span class="n">action_indexes</span><span class="p">)]</span> <span class="o">=</span> <span class="n">flat_dv</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deterministic</span><span class="p">:</span>
      <span class="n">sampled_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">value_expand</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">a_1Hots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="n">n_cols</span><span class="p">))</span>
      <span class="n">a_1Hots</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">sampled_actions</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
      <span class="n">v_probs</span> <span class="o">=</span> <span class="n">a_1Hots</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1"># Subtract max for numerical stability</span>
      <span class="n">value_expand_shift</span> <span class="o">=</span> <span class="n">value_expand</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">value_expand</span><span class="p">,</span>
                                                 <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="c1"># softmax temp scaling</span>
      <span class="n">value_expand_scale</span> <span class="o">=</span> <span class="n">value_expand_shift</span><span class="o">/</span><span class="n">temp</span>
      <span class="n">exp_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">value_expand_scale</span><span class="p">)</span>
      <span class="c1"># Normalize by the sum of the exponentiated values for each row</span>
      <span class="n">v_probs</span> <span class="o">=</span> <span class="n">exp_value</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">exp_value</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="n">v_probs</span> <span class="o">=</span> <span class="n">v_probs</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">v_probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="n">samp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="n">batch_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">sampled_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">v_probs</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">samp</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">a_1Hots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">*</span><span class="n">n_cols</span><span class="p">))</span>
      <span class="n">a_1Hots</span><span class="p">[(</span><span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">sampled_actions</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">sampled_actions</span><span class="p">,</span> <span class="n">a_1Hots</span><span class="p">,</span> <span class="n">v_probs</span>




<span class="k">class</span> <span class="nc">EatNearPredPlayer</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  A Player playing a parameterized policy defined by the given weights</span>
<span class="sd">  """</span>


  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
               <span class="n">get_probs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Args:</span>
<span class="sd">      game: Gridworld Game instance</span>
<span class="sd">        Instance of the gridworldGame class above;</span>
<span class="sd">      weights: 4 x 12 numpy array (assumes fov_radius = 2), that gives the</span>
<span class="sd">        connection strengths between the 'perception' neurons and the direction</span>
<span class="sd">        'neurons'</span>
<span class="sd">      fov_radius: int how far around itself the critter perceives, weights is</span>
<span class="sd">        expecting fov_radius = 1</span>
<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>
    <span class="c1"># all critters need these things</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span> <span class="o">=</span> <span class="n">critter_index</span>
    <span class="k">assert</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">critter_index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span>
        <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">critter_index</span> <span class="o">&lt;=</span> <span class="n">game</span><span class="o">.</span><span class="n">num_critters</span><span class="p">),</span> <span class="s2">"Value is not a positive integer or exceeds the upper limit."</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_probs</span> <span class="o">=</span> <span class="n">get_probs</span>
    <span class="c1"># these things are specific to this kind of critter</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="n">deterministic</span>
    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[[</span><span class="mf">20.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">]])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">weights</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span> <span class="o">=</span> <span class="n">fov_radius</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_softmax_temp</span> <span class="o">=</span> <span class="mf">0.05</span>


  <span class="k">def</span> <span class="nf">direction_value_from_percept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percepts</span><span class="p">,</span> <span class="n">W</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Determine an action based on perception.</span>

<span class="sd">    Args:</span>
<span class="sd">      percept: A batch by 1D len 12 array representing the perceptions of the</span>
<span class="sd">      organism. Indices correspond to spaces around the organism. The values in</span>
<span class="sd">      the array can be -2 (out-of-bounds), 0 (empty space), or -1 (food).</span>
<span class="sd">      W: a 4 x 12 weight matrix parameter representing the connection strengths</span>
<span class="sd">        between the 12 perceptions inputs and the 4 possible output actions.</span>

<span class="sd">    Returns:</span>
<span class="sd">      direction_probs: array of probabilities of taking each action.</span>
<span class="sd">    """</span>
    <span class="c1"># a human interpretable overview of the percept structure</span>
    <span class="c1">#percept_struct = [</span>
    <span class="c1">#  'up', 'left', 'center', 'right',  'down']</span>
    <span class="c1"># a human interpretable overview of the out structure</span>
    <span class="c1">#output_struct = ['up', 'left', 'center' 'right', 'down']</span>
    <span class="c1"># boolean representation of percept, no edges, no food, no other predators</span>
    <span class="c1"># just 1's where prey is,</span>
    <span class="c1"># x is batch x 5</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(((</span><span class="n">percepts</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
     <span class="p">(</span><span class="n">percepts</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">pred_prey_threshold</span><span class="p">)),</span> <span class="nb">int</span><span class="p">)</span>
    <span class="c1"># W is 5 x 5</span>
    <span class="c1"># this does the broadcasting we want</span>
    <span class="n">output_activations</span> <span class="o">=</span> <span class="p">(</span><span class="n">W</span> <span class="o">@</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="c1"># output activations is batch by 4</span>
    <span class="k">return</span> <span class="n">output_activations</span>


  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Simulate Play on a Board</span>

<span class="sd">    Args:</span>
<span class="sd">      board: dict {'pieces':</span>
<span class="sd">      (batch x num_rows x num_cols) np.ndarray of board position,</span>
<span class="sd">                  'scores': batch len array of current scores,</span>
<span class="sd">                  'rounds_left': batch len array of rounds left</span>

<span class="sd">    Returns:</span>
<span class="sd">      sampled_actions: a batch, row, col index of the move taken</span>
<span class="sd">      by each player on each board</span>
<span class="sd">      a_1hots: a batch nrow*ncol array of 1hot indices of those same moves</span>
<span class="sd">      v_probs: sampling probabilities for those 1hots (If the policy</span>
<span class="sd">      is deterministic a_1hots is returned here as well... or if getting the</span>
<span class="sd">      probs is an un-needed fuss to compute)</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">temp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_softmax_temp</span>
    <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">W</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">W</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">perceptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_perceptions</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span><span class="p">)</span>
    <span class="c1"># note the fragile order based dependency on how legal offsets is written,</span>
    <span class="c1"># and how output activations are interpreted</span>
    <span class="n">direction_v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction_value_from_percept</span><span class="p">(</span><span class="n">perceptions</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
    <span class="n">flat_ds</span> <span class="o">=</span> <span class="n">direction_v</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="n">critter_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">))</span>
    <span class="n">legal_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span>
    <span class="n">critter_locs</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">])]</span><span class="o">*</span><span class="n">batch_size</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="c1"># up</span>
    <span class="n">critter_locs</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])]</span><span class="o">*</span><span class="n">batch_size</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="c1"># left</span>
    <span class="n">critter_locs</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">])]</span><span class="o">*</span><span class="n">batch_size</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="c1"># still</span>
    <span class="n">critter_locs</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">])]</span><span class="o">*</span><span class="n">batch_size</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="c1"># right</span>
    <span class="n">critter_locs</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">])]</span><span class="o">*</span><span class="n">batch_size</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="c1"># down</span>
    <span class="p">])</span>
    <span class="n">legal_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">legal_offsets</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="c1"># conditions for offsets on the board</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">legal_offsets</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="n">legal_offsets</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">n_rows</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">c3</span> <span class="o">=</span> <span class="n">legal_offsets</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span>
    <span class="n">c4</span> <span class="o">=</span> <span class="n">legal_offsets</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">n_cols</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">all_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span><span class="p">])</span>

    <span class="n">batch_indexes</span> <span class="o">=</span> <span class="n">legal_offsets</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][</span><span class="n">all_c</span><span class="p">]</span>
    <span class="c1"># turn offsets into flat indexes, i.e. ints in range(n_rows*n_cols)</span>
    <span class="n">action_indexes</span> <span class="o">=</span> <span class="n">legal_offsets</span><span class="p">[:,</span><span class="mi">1</span><span class="p">][</span><span class="n">all_c</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_cols</span> <span class="o">+</span> <span class="n">legal_offsets</span><span class="p">[:,</span><span class="mi">2</span><span class="p">][</span><span class="n">all_c</span><span class="p">]</span>
    <span class="n">direction_values</span> <span class="o">=</span> <span class="n">flat_ds</span><span class="p">[</span><span class="n">all_c</span><span class="p">]</span>
    <span class="c1"># the fragile order dependency is here in that legal offsets and flat_ds</span>
    <span class="c1"># 'line up' and can both be indexed by 'all_c' and we get what we want</span>
    <span class="n">value_expand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">*</span><span class="n">n_cols</span><span class="p">))</span>
    <span class="c1"># i.e. we can slot the direction values into value expand like this</span>
    <span class="n">value_expand</span><span class="p">[(</span><span class="n">batch_indexes</span><span class="p">,</span> <span class="n">action_indexes</span><span class="p">)]</span> <span class="o">=</span> <span class="n">direction_values</span>
    <span class="c1"># valids is a batch x (n_rows * n_cols) binary np array, so we use it to</span>
    <span class="c1"># index value_expand and set non-valid values to -inf</span>
    <span class="n">valids</span> <span class="o">=</span> <span class="n">gwg</span><span class="o">.</span><span class="n">get_valid_actions</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>
    <span class="c1"># Set invalid positions to -inf</span>
    <span class="n">valid_value_expand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">valids</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value_expand</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deterministic</span><span class="p">:</span>
      <span class="n">sampled_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">valid_value_expand</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">a_1Hots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="n">n_cols</span><span class="p">))</span>
      <span class="n">a_1Hots</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">sampled_actions</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
      <span class="n">v_probs</span> <span class="o">=</span> <span class="n">a_1Hots</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1"># Subtract max for numerical stability</span>
      <span class="n">value_expand_shift</span> <span class="o">=</span> <span class="n">valid_value_expand</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">valid_value_expand</span><span class="p">,</span>
                                                       <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="c1"># softmax temp scaling</span>
      <span class="n">value_expand_scale</span> <span class="o">=</span> <span class="n">value_expand_shift</span><span class="o">/</span><span class="n">temp</span>
      <span class="n">exp_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">value_expand_scale</span><span class="p">)</span>
      <span class="c1"># Normalize by the sum of the exponentiated values for each row</span>
      <span class="n">v_probs</span> <span class="o">=</span> <span class="n">exp_value</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">exp_value</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="n">v_probs</span> <span class="o">=</span> <span class="n">v_probs</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">v_probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="n">samp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="n">batch_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">sampled_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">v_probs</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">samp</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">a_1Hots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">*</span><span class="n">n_cols</span><span class="p">))</span>
      <span class="n">a_1Hots</span><span class="p">[(</span><span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">sampled_actions</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">sampled_actions</span><span class="p">,</span> <span class="n">a_1Hots</span><span class="p">,</span> <span class="n">v_probs</span>




<span class="k">class</span> <span class="nc">RandomDirectionPlayer</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Instantiate random player for GridWorld</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span> <span class="o">=</span> <span class="n">critter_index</span>
    <span class="k">assert</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">critter_index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span>
        <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">critter_index</span> <span class="o">&lt;=</span> <span class="n">game</span><span class="o">.</span><span class="n">num_critters</span><span class="p">),</span> <span class="s2">"Value is not a positive integer or exceeds the upper limit."</span>

  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Simulates a batch of random game plays based on the given board state.</span>

<span class="sd">    This function assigns a uniform probability to going up down left or right</span>
<span class="sd">    independent of whether it is at an edge or corner or not. Then because of</span>
<span class="sd">    bouncing off edges it will have a higher probability of moving away from</span>
<span class="sd">    edges as opposed to along them than the random valid move player.</span>

<span class="sd">    Args:</span>
<span class="sd">      board (dict): A dictionary representing the state of the game. It</span>
<span class="sd">          contains:</span>
<span class="sd">          - 'pieces': A (batch_size, x_size, y_size) numpy array indicating</span>
<span class="sd">                      the pieces on the board.</span>
<span class="sd">          - 'scores' (not used directly in this function, but expected in dict)</span>
<span class="sd">          - 'rounds_left' (not used directly in this function, but expected in dict)</span>

<span class="sd">    Returns:</span>
<span class="sd">      tuple:</span>
<span class="sd">      - a (numpy array): An array of shape (batch_size,) containing randomly</span>
<span class="sd">                         chosen actions for each game in the batch.</span>
<span class="sd">      - a_1hots (numpy array): An array of shape (batch_size, action_size)</span>
<span class="sd">                               with one-hot encoded actions.</span>
<span class="sd">      - probs (numpy array): An array of the same shape as 'valids' containing</span>
<span class="sd">                             the probability of each move being played.</span>
<span class="sd">    """</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">action_probs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'up'</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span> <span class="s1">'down'</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span> <span class="s1">'left'</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span> <span class="s1">'right'</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">}</span>

    <span class="n">critter_oriented_moves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">action_probs</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                                                  <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">))</span>
    <span class="n">direction_probs</span> <span class="o">=</span> <span class="p">[</span><span class="n">action_probs</span><span class="p">]</span> <span class="o">*</span> <span class="n">batch_size</span>
    <span class="n">moves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">critter_direction_to_move</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">critter_oriented_moves</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">direction_probs_to_flat_probs</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">direction_probs</span><span class="p">,</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>
    <span class="n">sampled_actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">moves_to_actions</span><span class="p">(</span><span class="n">moves</span><span class="p">)</span>
    <span class="n">a_1hots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">*</span><span class="n">n_cols</span><span class="p">))</span>
    <span class="n">a_1hots</span><span class="p">[(</span><span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">sampled_actions</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">return</span> <span class="n">sampled_actions</span><span class="p">,</span> <span class="n">a_1hots</span><span class="p">,</span> <span class="n">probs</span>




<span class="k">class</span> <span class="nc">MonteCarloBasedPlayer</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Simulate Player based on Monte Carlo Algorithm</span>

<span class="sd">  Note: Has dependencies in the gw_NN_RL.py util, namely a policy/value</span>
<span class="sd">  network and the Monte Carlo class.</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">nnet</span><span class="p">,</span>
               <span class="n">critter_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">default_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">default_rollouts</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">default_K</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
               <span class="n">default_temp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
               <span class="n">random_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Initialize Monte Carlo Parameters</span>

<span class="sd">    Args:</span>
<span class="sd">      game: Gridworld Game instance</span>
<span class="sd">        Instance of the gridworldGame class above;</span>
<span class="sd">      nnet: gridworldNet instance</span>
<span class="sd">        Instance of the gridworldNNet class above;</span>
<span class="sd">      args: dictionary</span>
<span class="sd">        Instantiates number of iterations and episodes, controls temperature threshold, queue length,</span>
<span class="sd">        arena, checkpointing, and neural network parameters:</span>
<span class="sd">        learning-rate: 0.001, dropout: 0.3, epochs: 10, batch_size: 64,</span>
<span class="sd">        num_channels: 512</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span> <span class="o">=</span> <span class="n">critter_index</span>
    <span class="k">assert</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">critter_index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span>
        <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">critter_index</span> <span class="o">&lt;=</span> <span class="n">game</span><span class="o">.</span><span class="n">num_critters</span><span class="p">),</span> <span class="s2">"Value is not a positive integer or exceeds the upper limit."</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span> <span class="o">=</span> <span class="n">nnet</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_depth</span> <span class="o">=</span> <span class="n">default_depth</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_rollouts</span> <span class="o">=</span> <span class="n">default_rollouts</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mc</span> <span class="o">=</span> <span class="n">MonteCarlo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_depth</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_K</span> <span class="o">=</span> <span class="n">default_K</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_temp</span> <span class="o">=</span> <span class="n">default_temp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_seed</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span>
           <span class="n">num_rollouts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">rollout_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">K</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">softmax_temp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Simulates a batch Monte Carlo based plays on the given board state.</span>

<span class="sd">    Computes the probability of each valid move being played using a softmax</span>
<span class="sd">    activation on the Monte Carlo based value (Q) of each action then selects a</span>
<span class="sd">    move randomly for each game in the batch based on those probabilities.</span>

<span class="sd">    Args:</span>
<span class="sd">      board (dict): A dictionary representing the state of the game. It</span>
<span class="sd">          contains:</span>
<span class="sd">          - 'pieces': A (batch_size, x_size, y_size) numpy array indicating</span>
<span class="sd">                      the pieces on the board.</span>
<span class="sd">          - 'scores' (not used directly in this function, but expected in dict)</span>
<span class="sd">          - 'rounds_left' (not used directly in this function, but expected in dict)</span>

<span class="sd">    Returns:</span>
<span class="sd">      tuple:</span>
<span class="sd">      - a (numpy array): An array of shape (batch_size,) containing randomly</span>
<span class="sd">                         chosen actions for each game in the batch.</span>
<span class="sd">      - a_1hots (numpy array): An array of shape (batch_size, action_size)</span>
<span class="sd">                               with one-hot encoded actions.</span>
<span class="sd">      - probs (numpy array): An array of the same shape as 'valids' containing</span>
<span class="sd">                             the probability of each move being played.</span>
<span class="sd">    """</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">if</span> <span class="n">num_rollouts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">num_rollouts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_rollouts</span>
    <span class="k">if</span> <span class="n">rollout_depth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">rollout_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_depth</span>
    <span class="k">if</span> <span class="n">K</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">K</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_K</span>
    <span class="k">if</span> <span class="n">softmax_temp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">softmax_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_temp</span>

    <span class="c1"># figure out top k actions according to normalize action probability</span>
    <span class="c1"># given by our policy network prediction</span>
    <span class="c1">#co_pieces = board['pieces'].copy()</span>
    <span class="c1">#this_critter_locs = np.where(co_pieces == self.critter_index+1)</span>
    <span class="c1">#all_critter_locs = np.where(co_pieces &gt;= 1)</span>
    <span class="c1"># other critters are invisible to this player</span>
    <span class="c1">#co_pieces[all_critter_locs] = 0</span>
    <span class="c1"># nnet trained to see self as 1</span>
    <span class="c1">#co_pieces[this_critter_locs] = 1</span>
    <span class="c1">#scalar_rounds_left = board['rounds_left'][0]</span>
    <span class="c1">#co_rounds_left = scalar_rounds_left // self.game.num_critters</span>
    <span class="c1">#if self.critter_index-1 &lt; scalar_rounds_left % self.game.num_critters:</span>
       <span class="c1"># add an extra if we haven't had this players turn yet in the round cycle</span>
    <span class="c1">#   co_rounds_left = co_rounds_left + 1</span>
    <span class="c1">#co_rounds_left = np.array([co_rounds_left]*batch_size)</span>
    <span class="c1">#pis, vs = self.nnet.predict(co_pieces,</span>
    <span class="c1">#                            board['scores'][:,self.critter_index-1],</span>
    <span class="c1">#                            co_rounds_left)</span>
    <span class="n">pis</span><span class="p">,</span> <span class="n">vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">pis_vs_from_board</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>
    <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_valid_actions</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>
    <span class="n">masked_pis</span> <span class="o">=</span> <span class="n">pis</span> <span class="o">*</span> <span class="n">valids</span>  <span class="c1"># Masking invalid moves</span>
    <span class="n">sum_pis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">masked_pis</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">num_valid_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">valids</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">effective_topk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">num_valid_actions</span><span class="p">,</span> <span class="n">K</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span> <span class="nb">int</span><span class="p">)</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">masked_pi</span> <span class="o">/</span> <span class="n">masked_pi</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">if</span> <span class="n">masked_pi</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
                      <span class="k">else</span> <span class="n">valid</span> <span class="o">/</span> <span class="n">valid</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                      <span class="k">for</span> <span class="n">valid</span><span class="p">,</span> <span class="n">masked_pi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">valids</span><span class="p">,</span> <span class="n">masked_pis</span><span class="p">)])</span>
    <span class="n">partioned</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argpartition</span><span class="p">(</span><span class="n">probs</span><span class="p">,</span><span class="o">-</span><span class="n">effective_topk</span><span class="p">)</span>
    <span class="n">topk_actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">partioned</span><span class="p">[</span><span class="n">g</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
                      <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">effective_topk</span><span class="p">[</span><span class="n">g</span><span class="p">])]</span>
    <span class="n">topk_actions_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">ii</span>
                            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">etk</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">effective_topk</span><span class="p">)</span>
                              <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">etk</span><span class="p">)]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">topk_actions</span><span class="p">))</span>
    <span class="c1"># Do some rollouts</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_rollouts</span><span class="p">):</span>
      <span class="n">values</span> <span class="o">=</span> <span class="n">values</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">topk_actions</span><span class="p">,</span>
                                         <span class="n">topk_actions_index</span><span class="p">,</span>
                                         <span class="n">critter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">,</span>
                                         <span class="n">depth</span><span class="o">=</span><span class="n">rollout_depth</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">values</span> <span class="o">/</span> <span class="n">num_rollouts</span>

    <span class="n">value_expand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">*</span><span class="n">n_cols</span><span class="p">))</span>
    <span class="n">value_expand</span><span class="p">[(</span><span class="n">topk_actions_index</span><span class="p">,</span> <span class="n">topk_actions</span><span class="p">)]</span> <span class="o">=</span> <span class="n">values</span>
    <span class="n">value_expand_shift</span> <span class="o">=</span> <span class="n">value_expand</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">value_expand</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">value_expand_scale</span> <span class="o">=</span> <span class="n">value_expand_shift</span><span class="o">/</span><span class="n">softmax_temp</span>
    <span class="n">v_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">value_expand_scale</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">value_expand_scale</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">v_probs</span> <span class="o">=</span> <span class="n">v_probs</span> <span class="o">*</span> <span class="n">valids</span>
    <span class="n">v_probs</span> <span class="o">=</span> <span class="n">v_probs</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">v_probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">samp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="n">batch_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">sampled_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">v_probs</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">samp</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">a_1Hots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">*</span><span class="n">n_cols</span><span class="p">))</span>
    <span class="n">a_1Hots</span><span class="p">[(</span><span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">sampled_actions</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">sampled_actions</span><span class="p">,</span> <span class="n">a_1Hots</span><span class="p">,</span> <span class="n">v_probs</span>




<span class="k">class</span> <span class="nc">SimpleRulePlayer</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  A Predator Player based on the following simple policy:</span>
<span class="sd">  If there is any prey immediately nearby move towards it,</span>
<span class="sd">  otherwise move to a random valid location.</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span> <span class="o">=</span> <span class="n">critter_index</span>
    <span class="k">assert</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">critter_index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span>
        <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">critter_index</span> <span class="o">&lt;=</span> <span class="n">game</span><span class="o">.</span><span class="n">num_critters</span><span class="p">),</span> <span class="s2">"Value is not a positive integer or exceeds the upper limit."</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span> <span class="o">=</span> <span class="n">fov_radius</span>


  <span class="k">def</span> <span class="nf">simple_action_from_percept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percept</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Determine an action based on perception.</span>

<span class="sd">    Args:</span>
<span class="sd">      percept: A 1D array (len 4 if fov_radius = 1)representing the perception</span>
<span class="sd">        of the organism. Indices correspond to spaces around the organism. The</span>
<span class="sd">        values in the array can be -200 (out-of-bounds), 0 (empty space),</span>
<span class="sd">        negative integers &gt; -200 (food),</span>
<span class="sd">        positive integers &lt;= self.game.pred_prey_threshold are prey</span>
<span class="sd">        positive integers &gt; self.game.pred_prey_threshold are predators</span>

<span class="sd">    Returns:</span>
<span class="sd">      action: a str, one of 'up', 'down', 'left', 'right'. If food in one or</span>
<span class="sd">        more of the spaces immediately beside the organism, the function will</span>
<span class="sd">        return a random choice among these directions. If there is no food</span>
<span class="sd">        nearby, the function will return a random direction.</span>
<span class="sd">    """</span>
    <span class="c1"># a human interpretable overview of the percept structure if fov = 2</span>
    <span class="n">percept_struct</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'up'</span><span class="p">,</span> <span class="s1">'left'</span><span class="p">,</span> <span class="s1">'right'</span><span class="p">,</span> <span class="s1">'down'</span><span class="p">]</span>
    <span class="c1"># Defines directions corresponding to different perception indices</span>
    <span class="n">direction_struct</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'None'</span><span class="p">,</span> <span class="s1">'None'</span><span class="p">,</span> <span class="s1">'up'</span><span class="p">,</span> <span class="s1">'None'</span><span class="p">,</span>
      <span class="s1">'None'</span><span class="p">,</span> <span class="s1">'left'</span><span class="p">,</span> <span class="s1">'right'</span><span class="p">,</span> <span class="s1">'None'</span><span class="p">,</span>
      <span class="s1">'None'</span><span class="p">,</span> <span class="s1">'down'</span><span class="p">,</span> <span class="s1">'None'</span><span class="p">,</span> <span class="s1">'None'</span><span class="p">]</span>
    <span class="c1"># these are what count as nearby in the percept</span>
    <span class="n">nearby_directions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'near up'</span><span class="p">,</span> <span class="s1">'near left'</span><span class="p">,</span> <span class="s1">'near right'</span><span class="p">,</span> <span class="s1">'near down'</span><span class="p">]</span>
    <span class="c1"># Get the corresponding indices in the percept array</span>
    <span class="n">nearby_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">percept_struct</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dir_</span><span class="p">)</span> <span class="k">for</span> <span class="n">dir_</span> <span class="ow">in</span> <span class="n">nearby_directions</span><span class="p">]</span>
    <span class="c1"># Identify the directions where food is located</span>
    <span class="n">food_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">nearby_indices</span> <span class="k">if</span> <span class="n">percept</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">food_directions</span> <span class="o">=</span> <span class="p">[</span><span class="n">direction_struct</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">food_indices</span><span class="p">]</span>

    <span class="n">action_probs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'up'</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">'down'</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">'left'</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">'right'</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">food_directions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># If there is any food nearby</span>
      <span class="c1"># If there is any food nearby randomly choose a direction with food</span>
      <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">food_directions</span><span class="p">)</span>  <span class="c1"># Move towards a random one</span>
      <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="n">food_directions</span><span class="p">:</span>
        <span class="n">action_probs</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">food_directions</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1"># If there is no food nearby, move randomly</span>
      <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">'up'</span><span class="p">,</span> <span class="s1">'down'</span><span class="p">,</span> <span class="s1">'left'</span><span class="p">,</span> <span class="s1">'right'</span><span class="p">])</span>
      <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'up'</span><span class="p">,</span> <span class="s1">'down'</span><span class="p">,</span> <span class="s1">'left'</span><span class="p">,</span> <span class="s1">'right'</span><span class="p">]:</span>
        <span class="n">action_probs</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span>

    <span class="k">return</span> <span class="n">action</span><span class="p">,</span> <span class="n">action_probs</span>


  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Simulate Play on a Board</span>

<span class="sd">    Args:</span>
<span class="sd">      board: dict {'pieces':</span>
<span class="sd">      (batch x num_rows x num_cols) np.ndarray of board position,</span>
<span class="sd">                  'scores': batch len array of current scores,</span>
<span class="sd">                  'rounds_left': batch len array of rounds left</span>

<span class="sd">    Returns:</span>
<span class="sd">      sampled_actions: a batch, row, col index of the move taken</span>
<span class="sd">      by each player on each board</span>
<span class="sd">      a_1hots: a batch nrow*ncol array of 1hot indices of those same moves</span>
<span class="sd">      probs: sampling probabilities for those 1hots (If the policy</span>
<span class="sd">      is deterministic a_1hots is returned here as well... or if getting the</span>
<span class="sd">      probs is an un-needed fuss to compute)</span>

<span class="sd">    """</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">perceptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_perceptions</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>

    <span class="n">critter_oriented_moves</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">direction_probs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">):</span>
      <span class="n">action</span><span class="p">,</span> <span class="n">action_probs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simple_action_from_percept</span><span class="p">(</span><span class="n">perceptions</span><span class="p">[</span><span class="n">g</span><span class="p">])</span>
      <span class="n">critter_oriented_moves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
      <span class="n">direction_probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action_probs</span><span class="p">)</span>
    <span class="n">moves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">critter_direction_to_move</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">critter_oriented_moves</span><span class="p">,</span>
                                                <span class="n">direction_probs</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">direction_probs_to_flat_probs</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">direction_probs</span><span class="p">)</span>
    <span class="n">sampled_actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">moves_to_actions</span><span class="p">(</span><span class="n">moves</span><span class="p">)</span>
    <span class="n">a_1hots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">*</span><span class="n">n_cols</span><span class="p">))</span>
    <span class="n">a_1hots</span><span class="p">[(</span><span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">sampled_actions</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">return</span> <span class="n">sampled_actions</span><span class="p">,</span> <span class="n">a_1hots</span><span class="p">,</span> <span class="n">probs</span>




<span class="k">class</span> <span class="nc">PerceptParamPlayer</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  A Player playing a parameterized policy defined by the given weights</span>
<span class="sd">  """</span>


  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Args:</span>
<span class="sd">      game: Gridworld Game instance</span>
<span class="sd">        Instance of the gridworldGame class above;</span>
<span class="sd">      weights: 4 x 12 numpy array (assumes fov_radius = 2), that gives the</span>
<span class="sd">        connection strengths between the 'perception' neurons and the direction</span>
<span class="sd">        'neurons'</span>
<span class="sd">      fov_radius: int how far around itself the critter perceives, weights is</span>
<span class="sd">        expecting fov_radius = 2</span>
<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span> <span class="o">=</span> <span class="n">critter_index</span>
    <span class="k">assert</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">critter_index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span>
        <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">critter_index</span> <span class="o">&lt;=</span> <span class="n">game</span><span class="o">.</span><span class="n">num_critters</span><span class="p">),</span> <span class="s2">"Value is not a positive integer or exceeds the upper limit."</span>
    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
      <span class="p">[[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">weights</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span> <span class="o">=</span> <span class="n">fov_radius</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_softmax_temp</span> <span class="o">=</span> <span class="mf">0.05</span>


  <span class="k">def</span> <span class="nf">param_action_from_percept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percept</span><span class="p">,</span> <span class="n">valid_directions</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span>
                                <span class="n">softmax_temp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Determine an action based on perception.</span>

<span class="sd">    Args:</span>
<span class="sd">      percept: A 1D len 12 array representing the perception of the organism.</span>
<span class="sd">        Indices correspond to spaces around the organism. The values in the</span>
<span class="sd">        array can be -2 (out-of-bounds), 0 (empty space), or -1 (food).</span>
<span class="sd">      W: a 4 x 12 weight matrix parameter representing the connection strengths</span>
<span class="sd">        between the 12 perceptions inputs and the 4 possible output actions.</span>

<span class="sd">    Returns:</span>
<span class="sd">      direction: a str, one of 'up', 'down', 'left', 'right'. If food in one or</span>
<span class="sd">        more of the spaces immediately beside the organism, the function will</span>
<span class="sd">        return a random choice among these directions. If there is no food</span>
<span class="sd">        nearby, the function will return a random direction.</span>
<span class="sd">      direction_probs: dictionary with probabilities of taking each action.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_directions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="c1"># if there is no where legit to move, stay put</span>
      <span class="k">return</span> <span class="s1">'still'</span><span class="p">,</span> <span class="p">{</span><span class="n">direction</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="n">output_struct</span><span class="p">}</span>

    <span class="k">if</span> <span class="n">softmax_temp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="c1"># very low temp, basically deterministic for this range of values</span>
      <span class="n">softmax_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_softmax_temp</span>
    <span class="c1"># a human interpretable overview of the percept structure</span>
    <span class="n">percept_struct</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'far up'</span><span class="p">,</span> <span class="s1">'left up'</span><span class="p">,</span> <span class="s1">'near up'</span><span class="p">,</span> <span class="s1">'right up'</span><span class="p">,</span>
      <span class="s1">'far left'</span><span class="p">,</span> <span class="s1">'near left'</span><span class="p">,</span> <span class="s1">'near right'</span><span class="p">,</span> <span class="s1">'far right'</span><span class="p">,</span>
      <span class="s1">'left down'</span><span class="p">,</span> <span class="s1">'near down'</span><span class="p">,</span> <span class="s1">'right down'</span><span class="p">,</span> <span class="s1">'far down'</span><span class="p">]</span>
    <span class="c1"># a human interpretable overview of the out structure</span>
    <span class="n">output_struct</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'up'</span><span class="p">,</span> <span class="s1">'down'</span><span class="p">,</span> <span class="s1">'left'</span><span class="p">,</span> <span class="s1">'right'</span><span class="p">]</span>
    <span class="c1"># boolean representation of percept, no edges, just 1's where food is,</span>
    <span class="c1"># zero otherwise, also means other organisms are invisible</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">percept</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
    <span class="n">output_activations</span> <span class="o">=</span> <span class="n">W</span> <span class="o">@</span> <span class="n">x</span>

    <span class="c1"># softmax shift by max, scale by temp</span>
    <span class="n">shift_scale_ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">output_activations</span> <span class="o">-</span>
                             <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">output_activations</span><span class="p">))</span><span class="o">/</span><span class="n">softmax_temp</span><span class="p">)</span>
    <span class="c1"># set invalid direction activations to zero</span>
    <span class="n">invalid_directions</span> <span class="o">=</span> <span class="p">[</span><span class="n">direction</span> <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="n">output_struct</span>
                           <span class="k">if</span> <span class="n">direction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_directions</span><span class="p">]</span>
    <span class="n">invalid_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">output_struct</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="n">valid_directions</span><span class="p">]</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">shift_scale_ex</span> <span class="o">/</span> <span class="n">shift_scale_ex</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1">#normalized</span>
    <span class="c1"># set invalid direction probabilities to zero</span>
    <span class="n">invalid_directions</span> <span class="o">=</span> <span class="p">[</span><span class="n">direction</span> <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="n">output_struct</span>
                           <span class="k">if</span> <span class="n">direction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_directions</span><span class="p">]</span>
    <span class="n">invalid_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">output_struct</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="n">invalid_directions</span><span class="p">]</span>
    <span class="n">sm</span><span class="p">[</span><span class="n">invalid_indices</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">probs_sm</span> <span class="o">=</span> <span class="n">sm</span> <span class="o">/</span> <span class="n">sm</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#re-normalized again for fp issues</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">output_struct</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">probs_sm</span><span class="p">)</span>
    <span class="n">direction_probs</span> <span class="o">=</span> <span class="p">{</span><span class="n">direction</span><span class="p">:</span> <span class="n">prob</span>
                        <span class="k">for</span> <span class="n">direction</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">output_struct</span><span class="p">,</span> <span class="n">probs_sm</span><span class="p">)}</span>
    <span class="k">return</span> <span class="n">direction</span><span class="p">,</span> <span class="n">direction_probs</span>


  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Simulate Play on a Board</span>

<span class="sd">    Args:</span>
<span class="sd">      board: dict {'pieces':</span>
<span class="sd">      (batch x num_rows x num_cols) np.ndarray of board position,</span>
<span class="sd">                  'scores': batch len array of current scores,</span>
<span class="sd">                  'rounds_left': batch len array of rounds left</span>

<span class="sd">    Returns:</span>
<span class="sd">      sampled_actions: a batch, row, col index of the move taken</span>
<span class="sd">      by each player on each board</span>
<span class="sd">      a_1hots: a batch nrow*ncol array of 1hot indices of those same moves</span>
<span class="sd">      v_probs: sampling probabilities for those 1hots (If the policy</span>
<span class="sd">      is deterministic a_1hots is returned here as well... or if getting the</span>
<span class="sd">      probs is an un-needed fuss to compute)</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">temp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_softmax_temp</span>
    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">perceptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_perceptions</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>
    <span class="n">critter_oriented_moves</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">direction_probs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Get valid actions for each game in the batch</span>
    <span class="n">valid_directions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_valid_directions</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">):</span>
      <span class="n">direction</span><span class="p">,</span> <span class="n">batch_direction_probs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_action_from_percept</span><span class="p">(</span>
        <span class="n">perceptions</span><span class="p">[</span><span class="n">g</span><span class="p">],</span> <span class="n">valid_directions</span><span class="p">[</span><span class="n">g</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="n">softmax_temp</span><span class="o">=</span><span class="n">temp</span><span class="p">)</span>
      <span class="n">critter_oriented_moves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
      <span class="n">direction_probs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_direction_probs</span><span class="p">)</span>
    <span class="n">moves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">critter_direction_to_move</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">critter_oriented_moves</span><span class="p">,</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">direction_probs_to_flat_probs</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">direction_probs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">)</span>
    <span class="n">sampled_actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">moves_to_actions</span><span class="p">(</span><span class="n">moves</span><span class="p">)</span>
    <span class="n">a_1hots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">*</span><span class="n">n_cols</span><span class="p">))</span>
    <span class="n">a_1hots</span><span class="p">[(</span><span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">sampled_actions</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">return</span> <span class="n">sampled_actions</span><span class="p">,</span> <span class="n">a_1hots</span><span class="p">,</span> <span class="n">probs</span>




<span class="c1"># @title interactive gridworld widgets</span>

<span class="c1">########################################</span>
<span class="c1"># widgets refactor for multi-critter</span>
<span class="c1">#########################################</span>
<span class="c1"># Interactive Gridworld Game Widgets</span>




<span class="k">class</span> <span class="nc">InteractiveGridworld</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  A widget based object for interacting with a gridworld game</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gridworld_game</span><span class="p">,</span> <span class="n">init_board</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">has_fov</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_fov_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">critter_names</span><span class="o">=</span><span class="p">[</span><span class="s1">'Critter'</span><span class="p">],</span> <span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="s1">'human'</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Initializes a widget based object for interacting with a gridworld game</span>

<span class="sd">    Args:</span>
<span class="sd">      gridworld_game: an instance of GridworldGame object</span>
<span class="sd">        expects this to have batchsize 1</span>
<span class="sd">      init_board: (optional) a triple of np arrays representing board state</span>
<span class="sd">        pieces,       - batch_size x n_rows x n_cols</span>
<span class="sd">        scores,       - batch_size</span>
<span class="sd">        rounds_left   - batch_size</span>
<span class="sd">        if left out will initialize with a random board state</span>
<span class="sd">      has_fov: bool, whether or not to display fog of war around the critter</span>
<span class="sd">      radius: int, number of squares the critter can "see" around it</span>
<span class="sd">      figsize: tuple (int, int), size of the figure</span>
<span class="sd">      critter_names: a list of strings that determines what the critter is called</span>
<span class="sd">        in the plot legend, order should align with players</span>
<span class="sd">      player: a list of either 'human', None, or a player object with a play</span>
<span class="sd">        method and a critter_index attribute. If 'human' use buttons,  if None</span>
<span class="sd">        default to making a RandomValidPlayer object, otherwise use the</span>
<span class="sd">        player class provided to make the player objects and use a start button.</span>
<span class="sd">        The list needs to be as long as the gridworld_game.num_critters</span>
<span class="sd">        attribute. Order should align with critter_name.</span>

<span class="sd">      Note: fov is going to look pretty janky with more than one player, maybe</span>
<span class="sd">      we get fov to only turn on for the 'active' player?</span>
<span class="sd">    """</span>

    <span class="c1"># Set GridworldGame object and initialize the board state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span> <span class="o">=</span> <span class="n">gridworld_game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span> <span class="o">=</span> <span class="n">has_fov</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span> <span class="o">=</span> <span class="n">fov_opaque</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">percept_len</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="o">=</span> <span class="n">collect_fov_data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figsize</span> <span class="o">=</span> <span class="n">figsize</span>
    <span class="c1"># initialize players and plotting specs together to ensure alignment</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">players</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">any_human_players</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">crit_specs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'h'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">]</span>  <span class="c1"># hexagon and diamond</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">"colorblind"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">):</span>
      <span class="n">spec</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'marker'</span><span class="p">:</span> <span class="n">markers</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">markers</span><span class="p">)],</span>
              <span class="s1">'color'</span><span class="p">:</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="nb">len</span><span class="p">(</span><span class="n">markers</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)],</span>
              <span class="s1">'name'</span><span class="p">:</span> <span class="n">critter_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
              <span class="s1">'int_id'</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">crit_specs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
      <span class="n">player</span> <span class="o">=</span> <span class="n">players</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1">#implict check that players is at least long enough</span>
      <span class="k">if</span> <span class="n">player</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RandomValidPlayer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="k">elif</span> <span class="n">player</span> <span class="o">==</span> <span class="s1">'human'</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'human'</span><span class="p">)</span>
        <span class="c1"># right now only ever have on human player with index 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">any_human_players</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1"># player objects expected to have a critter_index attribute</span>
        <span class="c1"># we set it appropriately here so it aligns with the players list</span>
        <span class="c1"># used to create the widget</span>
        <span class="n">player</span><span class="o">.</span><span class="n">critter_index</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">init_board</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">get_init_board</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span> <span class="o">=</span> <span class="n">init_board</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="c1"># keep raw records of percept and eating for manipulation later</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">percept_eat_records</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="c1"># keep data in contingency table of how many food items were in</span>
      <span class="c1"># the percept, and whether or not food was eaten</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">percept_len</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="c1"># Initialize widgets and buttons</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
      <span class="n">width</span> <span class="o">=</span> <span class="s1">'20.0em'</span><span class="p">,</span> <span class="n">min_width</span><span class="o">=</span><span class="s1">'20.0em'</span><span class="p">,</span> <span class="n">max_width</span><span class="o">=</span><span class="s1">'21.0em'</span><span class="p">,</span>
      <span class="n">min_height</span><span class="o">=</span><span class="s1">'10.0em'</span><span class="p">,</span> <span class="n">overflow</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
      <span class="n">min_width</span><span class="o">=</span><span class="s1">'12.5em'</span><span class="p">,</span> <span class="n">max_width</span><span class="o">=</span><span class="s1">'18.8em'</span><span class="p">,</span>
      <span class="n">min_height</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">,</span> <span class="n">overflow</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
      <span class="n">min_width</span><span class="o">=</span><span class="s1">'25.0em'</span><span class="p">,</span> <span class="n">min_height</span><span class="o">=</span><span class="s1">'18.8em'</span><span class="p">,</span> <span class="n">overflow</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Up"</span><span class="p">,</span>
      <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Down"</span><span class="p">,</span>
      <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Left"</span><span class="p">,</span>
      <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Right"</span><span class="p">,</span>
      <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Start"</span><span class="p">,</span>
      <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>

    <span class="c1"># get plot canvas widgets and other plotting objects</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">any_human_players</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">legend_type</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># don't keep regenerating the legend</span>
      <span class="c1"># do legend separately if showing observations and no human player</span>
      <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span><span class="p">,</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax_legend</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">critter_specs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crit_specs</span><span class="p">,</span>
          <span class="n">legend_type</span><span class="o">=</span><span class="s1">'separate'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">figsize</span><span class="p">,</span> <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span>
          <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">legend_type</span><span class="o">=</span><span class="kc">None</span> <span class="c1"># don't keep regenerating the legend</span>
      <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span><span class="p">,</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax_legend</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">critter_specs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crit_specs</span><span class="p">,</span>
          <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span> <span class="n">legend_type</span><span class="o">=</span><span class="s1">'separate'</span><span class="p">,</span>
          <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">figsize</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">legend_type</span> <span class="o">=</span> <span class="s1">'included'</span>
      <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                <span class="n">critter_specs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crit_specs</span><span class="p">,</span>
                                <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span>
                                <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span>
                                <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">figsize</span><span class="p">)</span>
    <span class="c1"># lump buttons together</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">left_button</span><span class="p">,</span>
                               <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">up_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span><span class="p">]),</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span><span class="p">])</span>
    <span class="c1"># automatically pick different layouts for different situations</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">any_human_players</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">board_and_buttons</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="p">])</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#one human player</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_and_score</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_table_final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">board_and_buttons</span><span class="p">,</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">output_and_score</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
          <span class="c1"># a single human player collecting data</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">no_table_final_display</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_display</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># self.collect_fov_data == False:</span>
          <span class="c1"># a single human player not collecting data</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_table_final_display</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1"># more than one player, one of them human</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V_board_outbput</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">board_and_buttons</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V_scoreboard_start_legend</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">V_board_outbput</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">V_scoreboard_start_legend</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># player is some kind of ai</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># an ai player with recording</span>
        <span class="c1"># in this case legend is separate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V_score_start_output_legend</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">,</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="p">,</span>  <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V_board_table</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_display</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">V_board_table</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">V_score_start_output_legend</span><span class="p">])</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
          <span class="c1"># an ai player without recording</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">H_score_output_start</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="p">])</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H_score_output_start</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="c1"># more than one ai player</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">V_board_outbput</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">])</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">V_scoreboard_start_legend</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">V_board_outbput</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">V_scoreboard_start_legend</span><span class="p">])</span>

    <span class="c1"># initialize text outputs</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">:</span>
      <span class="n">table</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">'High Score:'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'--'</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">,</span>
               <span class="p">[</span><span class="s1">'Last Score:'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'--'</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">,</span>
               <span class="p">[</span><span class="s1">'Average Score:'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'--'</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">,]</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">''</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s1">'P</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">'</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">)]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">))</span>
      <span class="k">else</span><span class="p">:</span> <span class="c1"># len(self.players) == 1</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">any_human_players</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Click a button to start playing'</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Click the start button to run the simulation'</span><span class="p">)</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_display</span><span class="p">:</span>
      <span class="n">printmd</span><span class="p">(</span><span class="s2">"**Observations**"</span><span class="p">)</span>
      <span class="n">table_data</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">str</span><span class="p">(</span><span class="n">ii</span><span class="p">),</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">]),</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">ii</span><span class="p">])]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">)]</span>
      <span class="n">table</span> <span class="o">=</span> <span class="p">([[</span><span class="s1">'Food in Percept'</span><span class="p">,</span> <span class="s1">'Food Not Eaten'</span><span class="p">,</span> <span class="s1">'Food Eaten'</span><span class="p">]]</span> <span class="o">+</span>
               <span class="n">table_data</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>

    <span class="c1"># Connect the buttons to functions that do something</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_up_button_clicked</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_down_button_clicked</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_left_button_clicked</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_right_button_clicked</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_start_button_clicked</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">button_output_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_button</span><span class="p">):</span>
    <span class="n">old_board</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># index of players is 0 through num_critter-1,</span>
    <span class="c1"># same player represented by value of index + 1 in</span>
    <span class="n">old_scores</span> <span class="o">=</span> <span class="n">old_board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">old_board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
      <span class="n">b</span> <span class="o">=</span> <span class="n">GridworldBoard</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">lifetime</span><span class="p">,</span>
                         <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>
      <span class="n">b</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">old_board</span><span class="p">)</span>
      <span class="n">percept</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get_perceptions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span>
        <span class="s1">'human'</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">]):</span>
      <span class="n">direction</span> <span class="o">=</span> <span class="n">which_button</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">a_player</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">old_board</span><span class="p">)</span>
      <span class="c1"># print(a_player)</span>
      <span class="n">a_player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">action_to_critter_direction</span><span class="p">(</span><span class="n">old_board</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                                                      <span class="n">a_player</span><span class="p">)</span>
      <span class="c1"># but we only want to apply their move to the appropriate board</span>
      <span class="n">direction</span> <span class="o">=</span> <span class="n">a_player</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">critter_oriented_get_next_state</span><span class="p">(</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">direction</span><span class="p">])</span>
    <span class="n">new_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#first batch first critter type</span>
    <span class="n">rounds_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">num_moves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">lifetime</span> <span class="o">-</span>
                         <span class="n">rounds_left</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">new_scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">old_scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">]:</span>
      <span class="c1">#eating happened</span>
      <span class="n">eating_string</span> <span class="o">=</span> <span class="s2">"They ate the food/prey there!"</span>
      <span class="n">did_eat</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#eating didn't happen</span>
      <span class="n">eating_string</span> <span class="o">=</span> <span class="s2">"There's no food/prey there."</span>
      <span class="n">did_eat</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">get_critter_rc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span>
     <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                             <span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span>
                             <span class="n">critter_specs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="n">food</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span>
                             <span class="n">fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span><span class="p">,</span> <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span>
                             <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span>
                             <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="n">legend_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_type</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">p_e_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'perception'</span><span class="p">:</span> <span class="n">percept</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
                  <span class="s1">'state'</span><span class="p">:</span> <span class="n">old_board</span><span class="p">,</span>
                  <span class="s1">'did_eat'</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">did_eat</span><span class="p">)}</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">percept_eat_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_e_data</span><span class="p">)</span>
      <span class="n">percept_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">percept</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># number of food items in FoV</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span><span class="p">[</span><span class="n">did_eat</span><span class="p">,</span> <span class="n">percept_int</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
      <span class="n">clear_output</span><span class="p">()</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"The critter (tried) to move "</span> <span class="o">+</span> <span class="n">direction</span> <span class="o">+</span>
              <span class="s2">" and is now at (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">eating_string</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Rounds Left: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Food Eaten: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Food Per Move: </span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">rounds_left</span><span class="p">,</span> <span class="n">new_scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">],</span>
            <span class="n">new_scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">]</span> <span class="o">/</span> <span class="n">num_moves</span><span class="p">))</span>
      <span class="k">else</span><span class="p">:</span> <span class="c1"># more than one players</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Critter </span><span class="si">{}</span><span class="s2"> (tried) to move "</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
              <span class="n">direction</span> <span class="o">+</span>
              <span class="s2">" and is now at (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">eating_string</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Rounds Left: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Food Eaten: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">rounds_left</span><span class="p">,</span> <span class="n">new_scores</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">rounds_left</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_scores</span><span class="p">)</span>
      <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
        <span class="n">clear_output</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Game Over. Final Score </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new_scores</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Resetting the board for another game'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">get_init_board</span><span class="p">()</span>
      <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span>
       <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span><span class="p">,</span>
                               <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span>
                               <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span>
                               <span class="n">legend_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_type</span><span class="p">)</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Games Played: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
          <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
              <span class="p">[</span><span class="s1">'High Score:'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)))],</span>
              <span class="p">[</span><span class="s1">'Last Score:'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])],</span>
              <span class="p">[</span><span class="s1">'Average Score'</span><span class="p">,</span>
              <span class="s1">'</span><span class="si">{:.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)))]]</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">'High Score:'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">],</span>
                     <span class="p">[</span><span class="s1">'Last Score:'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">],</span>
                     <span class="p">[</span><span class="s1">'Average Score:'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">]]</span>
          <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># len(self.players) &gt; 1</span>
          <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">''</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s1">'P</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">'</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">)]</span>
          <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Assuming the batch size is 1 for now</span>
            <span class="n">current_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">max_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">average_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">'High Scores:'</span><span class="p">]</span> <span class="o">+</span>
              <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">max_scores</span><span class="p">])</span>
            <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">'Last Scores:'</span><span class="p">]</span> <span class="o">+</span>
              <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">current_scores</span><span class="p">])</span>
            <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">'Average Scores:'</span><span class="p">]</span> <span class="o">+</span>
              <span class="p">[</span><span class="s1">'</span><span class="si">{:.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">average_scores</span><span class="p">])</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
              <span class="p">[</span><span class="s1">'High Score:'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'--'</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">,</span>
              <span class="p">[</span><span class="s1">'Last Score:'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'--'</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">,</span>
              <span class="p">[</span><span class="s1">'Average Score:'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'--'</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">,]</span>
          <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">))</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_display</span><span class="p">:</span>
      <span class="n">clear_output</span><span class="p">()</span>
      <span class="n">printmd</span><span class="p">(</span><span class="s2">"**Observations**"</span><span class="p">)</span>
      <span class="n">table_data</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">str</span><span class="p">(</span><span class="n">ii</span><span class="p">),</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">]),</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">ii</span><span class="p">])]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">)]</span>
      <span class="n">table</span> <span class="o">=</span> <span class="p">([[</span><span class="s1">'Food in Percept'</span><span class="p">,</span> <span class="s1">'Food Not Eaten'</span><span class="p">,</span> <span class="s1">'Food Eaten'</span><span class="p">]]</span> <span class="o">+</span>
               <span class="n">table_data</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>

  <span class="k">def</span> <span class="nf">disable_direction_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">def</span> <span class="nf">enable_direction_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>

  <span class="k">def</span> <span class="nf">human_ai_player_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">disable_direction_buttons</span><span class="p">()</span>  <span class="c1"># Disable buttons, no double clicks</span>
    <span class="c1"># Execute the move of the human who clicked the button</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">button_output_update</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
    <span class="c1"># Move to the next player</span>
    <span class="k">def</span> <span class="nf">update_player_and_rounds</span><span class="p">():</span>
<span class="w">      </span><span class="sd">"""Update the player index and decrement rounds if a full loop is completed."""</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">update_player_and_rounds</span><span class="p">()</span>
    <span class="c1"># Do AI moves if there are any</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">'human'</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">button_output_update</span><span class="p">(</span><span class="s1">'tbd'</span><span class="p">)</span>
      <span class="c1"># Move to the next player</span>
      <span class="n">update_player_and_rounds</span><span class="p">()</span>
    <span class="c1"># Next player is human turn buttons on for them</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enable_direction_buttons</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">on_up_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">human_ai_player_loop</span><span class="p">(</span><span class="s1">'up'</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_down_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">human_ai_player_loop</span><span class="p">(</span><span class="s1">'down'</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_left_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">human_ai_player_loop</span><span class="p">(</span><span class="s1">'left'</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_right_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">human_ai_player_loop</span><span class="p">(</span><span class="s1">'right'</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_start_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">lifetime</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">button_output_update</span><span class="p">(</span><span class="s1">'tbd'</span><span class="p">)</span>
      <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>




<span class="k">class</span> <span class="nc">Head2HeadGridworld</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  A widget for interacting with a gridworld game while an artificial player</span>
<span class="sd">  plays on an identical board or watching two artificial players play, again</span>
<span class="sd">  with identical starting positions (though RNG not synched between the two</span>
<span class="sd">  boards, so not like duplicate bridge). We are not going to worry about having</span>
<span class="sd">  more than 1 critter type playing in head to head, (maybe we will to talk</span>
<span class="sd">  about cooperation... maybe).</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gridworld_game</span><span class="p">,</span> <span class="n">init_board</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">player0</span><span class="o">=</span><span class="s1">'human'</span><span class="p">,</span> <span class="n">p0_short_name</span><span class="o">=</span><span class="s1">'YOU'</span><span class="p">,</span> <span class="n">p0_long_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">player1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p1_short_name</span><span class="o">=</span><span class="s1">'THEM'</span><span class="p">,</span> <span class="n">p1_long_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">has_fov</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">collect_fov_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">critter_name</span><span class="o">=</span><span class="s1">'Critter'</span><span class="p">,</span>
               <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">4.5</span><span class="p">),</span> <span class="n">has_temp_slider</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Initializes a widget based object for interacting with a gridworld game</span>

<span class="sd">    Args:</span>
<span class="sd">      gridworld_game: an instance of GridworldGame object</span>
<span class="sd">        expects this to have batch_size of 2</span>
<span class="sd">      init_board: (optional) a triple of np arrays representing board state</span>
<span class="sd">        pieces,       - batch_size x n_rows x n_cols</span>
<span class="sd">        scores,       - batch_size</span>
<span class="sd">        rounds_left   - batch_size</span>
<span class="sd">        if left out will initialize with a random board state</span>
<span class="sd">      player0: object with a play method that takes a board state</span>
<span class="sd">        as an argument and returns a move. If none will use a random player</span>
<span class="sd">        if the special string 'human' is passed make arrow keys for that player</span>
<span class="sd">      player1: same deal as player0, never more than 1 human player</span>
<span class="sd">      has_fov: bool, whether or not to display field of view around the critter</span>
<span class="sd">      radius: int, number of squares the critter can "see" around it</span>
<span class="sd">    """</span>
    <span class="c1"># Set GridworldGame object and initialize the board state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span> <span class="o">=</span> <span class="n">gridworld_game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">player0</span> <span class="o">=</span> <span class="n">player0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p0_short_name</span> <span class="o">=</span> <span class="n">p0_short_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p0_long_name</span> <span class="o">=</span> <span class="n">p0_long_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">player1</span> <span class="o">=</span> <span class="n">player1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p1_short_name</span> <span class="o">=</span> <span class="n">p1_short_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p1_long_name</span> <span class="o">=</span> <span class="n">p1_long_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">no_human</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player0</span> <span class="o">==</span> <span class="s1">'human'</span><span class="p">:</span>
      <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">player1</span> <span class="o">!=</span> <span class="s1">'human'</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">no_human</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player1</span> <span class="o">==</span> <span class="s1">'human'</span><span class="p">:</span>
      <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">player0</span> <span class="o">!=</span> <span class="s1">'human'</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">no_human</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p0_next_move</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p1_next_move</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span> <span class="o">=</span> <span class="n">has_fov</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span> <span class="o">=</span> <span class="n">fov_opaque</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">percept_len</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="o">=</span> <span class="n">collect_fov_data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">critter_name</span> <span class="o">=</span> <span class="n">critter_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figsize</span> <span class="o">=</span> <span class="n">figsize</span>
    <span class="k">if</span> <span class="n">player0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">player0</span> <span class="o">=</span> <span class="n">RandomValidPlayer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">player0</span> <span class="o">=</span> <span class="n">player0</span>
    <span class="k">if</span> <span class="n">player1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">player1</span> <span class="o">=</span> <span class="n">RandomValidPlayer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">player1</span> <span class="o">=</span> <span class="n">player1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_temp_slider</span> <span class="o">=</span> <span class="n">has_temp_slider</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">percept_eat_records</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">percept_len</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">init_board</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">get_init_board</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span> <span class="o">=</span> <span class="n">init_board</span>
    <span class="c1">#print(self.board_state)</span>

    <span class="c1"># both players have same starting board</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Initialize widgets and buttons</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_temp_slider</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">sft_slider_label</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">'Softmax Temperature'</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">sft_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                                            <span class="nb">max</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">softmax_temp_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">sft_slider_label</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">sft_slider</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">output0</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
      <span class="n">width</span> <span class="o">=</span> <span class="s1">'20.0em'</span><span class="p">,</span> <span class="n">min_width</span><span class="o">=</span><span class="s1">'20.0em'</span><span class="p">,</span> <span class="n">max_width</span><span class="o">=</span><span class="s1">'21.0em'</span><span class="p">,</span>
      <span class="n">min_height</span><span class="o">=</span><span class="s1">'10.0em'</span><span class="p">,</span> <span class="n">overflow</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">output1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
      <span class="n">width</span> <span class="o">=</span> <span class="s1">'20.0em'</span><span class="p">,</span> <span class="n">min_width</span><span class="o">=</span><span class="s1">'20.0em'</span><span class="p">,</span> <span class="n">max_width</span><span class="o">=</span><span class="s1">'21.0em'</span><span class="p">,</span>
      <span class="n">min_height</span><span class="o">=</span><span class="s1">'10.0em'</span><span class="p">,</span> <span class="n">overflow</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
      <span class="n">min_width</span><span class="o">=</span><span class="s1">'20em'</span><span class="p">,</span> <span class="n">max_width</span><span class="o">=</span><span class="s1">'21em'</span><span class="p">,</span> <span class="n">min_height</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">,</span> <span class="n">overflow</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Up"</span><span class="p">,</span>
                                    <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Down"</span><span class="p">,</span>
                                      <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Left"</span><span class="p">,</span>
                                      <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Right"</span><span class="p">,</span>
                                       <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Start"</span><span class="p">,</span>
      <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="s1">'0.6em 0 0 0'</span><span class="p">))</span>  <span class="c1"># 0.6em top margin</span>

    <span class="c1">#set up buttons and outputs and layouts</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">left_button</span><span class="p">,</span>
                               <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">up_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span><span class="p">]),</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov0</span><span class="p">,</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax_legend</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">legend_type</span><span class="o">=</span><span class="s1">'separate'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">figsize</span><span class="p">,</span>
        <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">critter_name</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p0_long_name</span><span class="p">)</span>
    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov1</span>
     <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">legend_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">figsize</span><span class="p">,</span> <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span>
                             <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span>
                             <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p1_long_name</span><span class="p">)</span>
    <span class="c1"># player 0 is human</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">board_buttons_and_output0</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span>
      <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig0</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output0</span><span class="p">])</span>
    <span class="c1"># player 1 is human</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">board_buttons_and_output1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span>
      <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig1</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output1</span><span class="p">])</span>
    <span class="c1"># non human players</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">board_and_output0</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig0</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output0</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">board_and_output1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig1</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output1</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">legend_and_scores</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">])</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_temp_slider</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">legend_scores_start</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">softmax_temp_slider</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">legend_scores_start</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="p">])</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player0</span> <span class="o">==</span> <span class="s1">'human'</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">board_buttons_and_output0</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">legend_and_scores</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">board_and_output1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">player1</span> <span class="o">==</span> <span class="s1">'human'</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">board_and_output0</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">legend_and_scores</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">board_buttons_and_output1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># no human player</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">board_and_output0</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">legend_scores_start</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">board_and_output1</span><span class="p">])</span>
    <span class="c1"># initial text outputs</span>
    <span class="c1"># if there's a temp slider check who, if anyone uses it</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p0_uses_temp</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p1_uses_temp</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_temp_slider</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player0</span><span class="o">==</span><span class="s1">'human'</span><span class="p">:</span>
        <span class="k">pass</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player0</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">p0_uses_temp</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="k">pass</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player1</span> <span class="o">==</span> <span class="s1">'human'</span><span class="p">:</span>
        <span class="k">pass</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player1</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">p1_uses_temp</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span> <span class="k">pass</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">p0_uses_temp</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1_uses_temp</span><span class="p">:</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output0</span><span class="p">:</span>
          <span class="nb">print</span><span class="p">(</span><span class="s2">"Warning: neither player supports temperature adjustment. "</span>
                <span class="s2">"The slider will have no effect."</span><span class="p">)</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output0</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_human</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Click a button to start.'</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Click the start button to run the simulation'</span><span class="p">)</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">'Games Played: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)))</span>
      <span class="n">table</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">''</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p0_short_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1_short_name</span><span class="p">],</span>
          <span class="p">[</span><span class="s1">'High Score:'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">],</span>
          <span class="p">[</span><span class="s1">'Last Score:'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">],</span>
          <span class="p">[</span><span class="s1">'Avg. Score:'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">]]</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>

    <span class="c1"># Connect the buttons to functions that do something</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_up_button_clicked</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_down_button_clicked</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_left_button_clicked</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_right_button_clicked</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_start_button_clicked</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">button_output_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_button</span><span class="p">):</span>
    <span class="n">old_board</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">old_scores</span> <span class="o">=</span> <span class="n">old_board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#both batches only one critter type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active_player</span> <span class="o">=</span> <span class="n">old_board</span><span class="p">[</span><span class="s1">'active_player'</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">disable_buttons</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player0</span> <span class="o">==</span> <span class="s1">'human'</span><span class="p">:</span>
      <span class="n">a_player0</span> <span class="o">=</span> <span class="n">which_button</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p0_next_move</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">a_player0_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p0_next_move</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p0_next_move</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output0</span><span class="p">:</span>
          <span class="nb">print</span><span class="p">(</span><span class="s2">"AI is thinking..."</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p0_uses_temp</span><span class="p">:</span>
          <span class="n">a_player0_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player0</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">old_board</span><span class="p">,</span>
                                               <span class="n">temp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sft_slider</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">a_player0_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player0</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">old_board</span><span class="p">)</span>
      <span class="n">a_player0_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">action_to_critter_direction</span><span class="p">(</span><span class="n">old_board</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">active_player</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                                                        <span class="n">a_player0_</span><span class="p">)</span>
      <span class="n">a_player0</span> <span class="o">=</span> <span class="n">a_player0_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player1</span> <span class="o">==</span> <span class="s1">'human'</span><span class="p">:</span>
      <span class="n">a_player1</span> <span class="o">=</span> <span class="n">which_button</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1_next_move</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">a_player1_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1_next_move</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p1_next_move</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output1</span><span class="p">:</span>
          <span class="nb">print</span><span class="p">(</span><span class="s2">"AI is thinking..."</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1_uses_temp</span><span class="p">:</span>
          <span class="n">a_player1_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player1</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">old_board</span><span class="p">,</span>
                                               <span class="n">temp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sft_slider</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">a_player1_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player1</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">old_board</span><span class="p">)</span>
      <span class="n">a_player1_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">action_to_critter_direction</span><span class="p">(</span><span class="n">old_board</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">active_player</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                                                        <span class="n">a_player1_</span><span class="p">)</span>
      <span class="n">a_player1</span> <span class="o">=</span> <span class="n">a_player1_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enable_buttons</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">critter_oriented_get_next_state</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_player</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">a_player0</span><span class="p">,</span> <span class="n">a_player1</span><span class="p">])</span>

    <span class="c1"># Try to precompute next AI player move(s) if there are any rounds left</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player0</span> <span class="o">!=</span> <span class="s1">'human'</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p0_uses_temp</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">p0_next_move</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player0</span><span class="o">.</span><span class="n">play</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sft_slider</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">p0_next_move</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player0</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">)</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player1</span> <span class="o">!=</span> <span class="s1">'human'</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1_uses_temp</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">p1_next_move</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player1</span><span class="o">.</span><span class="n">play</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sft_slider</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">p1_next_move</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player1</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">old_board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
      <span class="n">b</span> <span class="o">=</span> <span class="n">GridworldBoard</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">lifetime</span><span class="p">,</span>
                         <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>
      <span class="n">b</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">old_board</span><span class="p">)</span>
      <span class="n">percept</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get_perceptions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>

    <span class="n">new_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#both batches one critter type</span>
    <span class="n">rounds_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">num_moves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">lifetime</span> <span class="o">-</span> <span class="n">rounds_left</span>

    <span class="k">if</span> <span class="n">new_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">old_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
      <span class="n">eating_string0</span> <span class="o">=</span> <span class="s2">"They ate the food there!"</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">eating_string0</span> <span class="o">=</span> <span class="s2">"There's no food there."</span>
    <span class="k">if</span> <span class="n">new_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">old_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
      <span class="n">eating_string1</span> <span class="o">=</span> <span class="s2">"They ate the food there!"</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">eating_string1</span> <span class="o">=</span> <span class="s2">"There's no food there."</span>
    <span class="n">did_eat</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">new_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">old_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">row0</span><span class="p">,</span> <span class="n">col0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">get_critter_rc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov0</span>
     <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fig0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax0</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov0</span><span class="p">,</span>
                             <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span>
                             <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span>
                             <span class="n">legend_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">row1</span><span class="p">,</span> <span class="n">col1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">get_critter_rc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov1</span>
     <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fig1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax1</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov1</span><span class="p">,</span>
                             <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span>
                             <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span>
                             <span class="n">legend_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output0</span><span class="p">:</span>
      <span class="n">clear_output</span><span class="p">()</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player0</span> <span class="o">==</span> <span class="s1">'human'</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"You clicked the "</span> <span class="o">+</span> <span class="n">which_button</span> <span class="o">+</span>
              <span class="s2">" button and your critter is now at (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row0</span><span class="p">,</span><span class="n">col0</span><span class="p">))</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"This player (tried) to move "</span> <span class="o">+</span> <span class="n">a_player0</span> <span class="o">+</span>
              <span class="s2">" and is now at (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row0</span><span class="p">,</span><span class="n">col0</span><span class="p">))</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">eating_string0</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">"Rounds Left: </span><span class="si">{}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">Food Eaten: </span><span class="si">{}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">Food Per Move: </span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
          <span class="n">rounds_left</span><span class="p">,</span> <span class="n">new_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">new_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">num_moves</span><span class="p">))</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output1</span><span class="p">:</span>
      <span class="n">clear_output</span><span class="p">()</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player1</span> <span class="o">==</span> <span class="s1">'human'</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"You clicked the "</span> <span class="o">+</span> <span class="n">which_button</span> <span class="o">+</span>
              <span class="s2">" button and your critter is now at (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row1</span><span class="p">,</span><span class="n">col1</span><span class="p">))</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"This player (tried) to move "</span> <span class="o">+</span> <span class="n">a_player1</span> <span class="o">+</span>
              <span class="s2">" and is now at (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row1</span><span class="p">,</span><span class="n">col1</span><span class="p">))</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">eating_string1</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">"Rounds Left: </span><span class="si">{}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">Food Eaten: </span><span class="si">{}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">Food Per Move: </span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">rounds_left</span><span class="p">,</span> <span class="n">new_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">new_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">num_moves</span><span class="p">))</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">p_e_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">percept</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">did_eat</span><span class="p">,</span> <span class="n">old_board</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">percept_eat_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_e_data</span><span class="p">)</span>
      <span class="n">percept_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">percept</span><span class="o">==-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span><span class="p">[</span><span class="n">did_eat</span><span class="p">,</span> <span class="n">percept_int</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">rounds_left</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_scores</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">get_init_board</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
      <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov0</span>
       <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fig0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax0</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov0</span><span class="p">,</span>
                              <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span>
                              <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span>
                              <span class="n">legend_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
      <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov1</span>
       <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fig1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax1</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov1</span><span class="p">,</span>
                               <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span>
                               <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span>
                               <span class="n">legend_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
      <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output0</span><span class="p">:</span>
        <span class="n">clear_output</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Game Over. Final Score </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Resetting the board for another game'</span><span class="p">)</span>
      <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output1</span><span class="p">:</span>
        <span class="n">clear_output</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Game Over. Final Score </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Resetting the board for another game'</span><span class="p">)</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">:</span>
      <span class="n">clear_output</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">'Games Played: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)))</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">table</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">''</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p0_short_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1_short_name</span><span class="p">],</span>
          <span class="p">[</span><span class="s1">'High Score:'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)[:,</span><span class="mi">0</span><span class="p">])),</span>
                          <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]))],</span>
          <span class="p">[</span><span class="s1">'Last Score:'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                          <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])],</span>
          <span class="p">[</span><span class="s1">'Average Score'</span><span class="p">,</span>
            <span class="s1">'</span><span class="si">{:.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)[:,</span><span class="mi">0</span><span class="p">])),</span>
            <span class="s1">'</span><span class="si">{:.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]))]]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">table</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">''</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p0_short_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1_short_name</span><span class="p">],</span>
          <span class="p">[</span><span class="s1">'High Score:'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">],</span>
          <span class="p">[</span><span class="s1">'Last Score:'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">],</span>
          <span class="p">[</span><span class="s1">'Average Score:'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">]]</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>


  <span class="k">def</span> <span class="nf">on_up_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">button_output_update</span><span class="p">(</span><span class="s1">'up'</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_down_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">button_output_update</span><span class="p">(</span><span class="s1">'down'</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_left_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">button_output_update</span><span class="p">(</span><span class="s1">'left'</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_right_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">button_output_update</span><span class="p">(</span><span class="s1">'right'</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_start_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_temp_slider</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">softmax_temp_slider</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">lifetime</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">button_output_update</span><span class="p">(</span><span class="s1">'tbd'</span><span class="p">)</span>
      <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_temp_slider</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">softmax_temp_slider</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>

  <span class="k">def</span> <span class="nf">disable_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">def</span> <span class="nf">enable_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>




<span class="k">class</span> <span class="nc">ExploreWeightsWidget</span><span class="p">:</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span>  <span class="c1"># four directions, twelve fov cells</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">row_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Up'</span><span class="p">,</span> <span class="s1">'Down'</span><span class="p">,</span> <span class="s1">'Left'</span><span class="p">,</span> <span class="s1">'Right'</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">col_labels</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s1">'Far&lt;br&gt;Up'</span><span class="p">,</span> <span class="s1">'Left&lt;br&gt;Up'</span><span class="p">,</span> <span class="s1">'Near&lt;br&gt;Up'</span><span class="p">,</span> <span class="s1">'Right&lt;br&gt;Up'</span><span class="p">,</span>
      <span class="s1">'Far&lt;br&gt;Left'</span><span class="p">,</span> <span class="s1">'Near&lt;br&gt;Left'</span><span class="p">,</span> <span class="s1">'Near&lt;br&gt;Right'</span><span class="p">,</span> <span class="s1">'Far&lt;br&gt;Right'</span><span class="p">,</span>
      <span class="s1">'Left&lt;br&gt;Down'</span><span class="p">,</span> <span class="s1">'Near&lt;br&gt;Down'</span><span class="p">,</span> <span class="s1">'Right&lt;br&gt;Down'</span><span class="p">,</span> <span class="s1">'Far&lt;br&gt;Down'</span>
      <span class="p">]</span>

    <span class="c1"># Create column headers</span>
    <span class="n">col_header</span> <span class="o">=</span> <span class="p">[</span><span class="n">widgets</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'50px'</span><span class="p">))]</span> <span class="o">+</span> \
                 <span class="p">[</span><span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'60px'</span><span class="p">,</span> <span class="n">min_height</span><span class="o">=</span><span class="s1">'60px'</span><span class="p">))</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_labels</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">text_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">(</span><span class="n">col_header</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_labels</span><span class="p">:</span>
      <span class="n">row_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'60px'</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cols</span><span class="p">)]</span>
      <span class="n">row_label</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">:"</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'50px'</span><span class="p">))</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">text_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">row_label</span><span class="p">]</span> <span class="o">+</span> <span class="n">row_fields</span><span class="p">))</span>

    <span class="c1"># Create a button to start the game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">run_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Run Game"</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">run_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">run_game</span><span class="p">)</span>

    <span class="c1"># set up fig and create placeholders for vertical lines and histograms</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">"colorblind"</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">best_color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prev_color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">remove_ip_clutter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_avg_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_color</span><span class="p">,</span>
                                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">'dashed'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                            <span class="n">label</span><span class="o">=</span><span class="s1">'Current'</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prev_avg_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_color</span><span class="p">,</span>
                                         <span class="n">linestyle</span><span class="o">=</span><span class="s1">'dashed'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                         <span class="n">label</span><span class="o">=</span><span class="s1">'Previous'</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">best_avg_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">best_color</span><span class="p">,</span>
                                         <span class="n">linestyle</span><span class="o">=</span><span class="s1">'dashed'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                         <span class="n">label</span><span class="o">=</span><span class="s1">'Best'</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
      <span class="c1">#only do hist for batches</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">current_hist_bars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span>
                                           <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_color</span><span class="p">,</span>
                                           <span class="n">label</span><span class="o">=</span><span class="s1">'Current Run'</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">prev_hist_bars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_color</span><span class="p">,</span>
                                        <span class="n">label</span><span class="o">=</span><span class="s1">'Previous Run'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'outside right upper'</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="c1"># Output widget to display game output and any other information</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">out</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>

    <span class="c1"># keep track of important values</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">best_avg_score</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">'-inf'</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">best_params</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prev_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

    <span class="c1"># Button to set the best weights</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">best_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Set Best Weights"</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">best_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_best_weights</span><span class="p">)</span>

    <span class="c1"># Add a ToggleButton for symmetry</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">symmetry_toggle</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButton</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                <span class="n">description</span><span class="o">=</span><span class="s1">'Enforce Symmetry'</span><span class="p">,</span>
                                                <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                <span class="n">button_style</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span>
                                                <span class="n">tooltip</span><span class="o">=</span><span class="s1">'Toggle symmetry enforcement'</span><span class="p">,</span>
                                                <span class="n">icon</span><span class="o">=</span><span class="s1">'check'</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">symmetry_toggle</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_symmetry</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span>
      <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">text_fields</span><span class="p">,</span>
      <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">run_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">symmetry_toggle</span><span class="p">]),</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">links</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># To keep track of the jslink objects</span>


  <span class="k">def</span> <span class="nf">run_game</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">hbox</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_fields</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>  <span class="c1"># Skip the header row</span>
      <span class="n">row_weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">hbox</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>  <span class="c1"># Skip the label at the first position</span>
      <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_weights</span><span class="p">)</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">ppp</span> <span class="o">=</span> <span class="n">PerceptParamPlayer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="c1"># Run the game</span>
    <span class="n">final_board</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">play_game</span><span class="p">(</span><span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="n">ppp</span><span class="p">],</span> <span class="n">visualize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">scores</span> <span class="o">=</span> <span class="n">final_board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">avg_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scores</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">avg_score</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_avg_score</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">best_avg_score</span> <span class="o">=</span> <span class="n">avg_score</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">best_params</span> <span class="o">=</span> <span class="n">weights</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
      <span class="c1"># Compute and update histogram data</span>
      <span class="n">counts</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scores</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
      <span class="n">counts</span> <span class="o">=</span> <span class="n">counts</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
      <span class="n">prev_counts</span><span class="p">,</span> <span class="n">prev_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_scores</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_scores</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
      <span class="n">prev_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">prev_counts</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">prev_sum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">prev_counts</span> <span class="o">=</span> <span class="n">prev_counts</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">prev_counts</span><span class="p">)</span>
      <span class="c1"># Update the height of bars for the current scores</span>
      <span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">left</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_hist_bars</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
          <span class="n">bar</span><span class="o">.</span><span class="n">set_height</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
          <span class="n">bar</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
          <span class="n">bar</span><span class="o">.</span><span class="n">set_width</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">edges</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="c1"># Update the height of bars for the previous scores</span>
      <span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">left</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_hist_bars</span><span class="p">,</span> <span class="n">prev_counts</span><span class="p">,</span> <span class="n">prev_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
          <span class="n">bar</span><span class="o">.</span><span class="n">set_height</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
          <span class="n">bar</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
          <span class="n">bar</span><span class="o">.</span><span class="n">set_width</span><span class="p">(</span><span class="n">prev_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_edges</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># set vline data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_avg_line</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">([</span><span class="n">avg_score</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_scores</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">prev_avg_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_scores</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prev_avg_line</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">([</span><span class="n">prev_avg_score</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">best_avg_line</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">best_avg_score</span><span class="p">])</span>

    <span class="c1">#update the fig</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'outside right upper'</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="c1"># Display the output</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="p">:</span>
      <span class="n">clear_output</span><span class="p">()</span>

      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Average Score This Time: </span><span class="si">{</span><span class="n">avg_score</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_scores</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">prev_avg_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_scores</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
          <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Average Score Last Time: </span><span class="si">{</span><span class="n">prev_avg_score</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Best Ever Average Score: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">best_avg_score</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Score This Run: </span><span class="si">{</span><span class="n">avg_score</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prev_scores</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Score Last Run: </span><span class="si">{</span><span class="n">prev_avg_score</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Best Score: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">best_avg_score</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">prev_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scores</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>


  <span class="k">def</span> <span class="nf">link_symmetric_widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">change</span><span class="p">):</span>
    <span class="c1"># Each row's symmetry permutation indices</span>
    <span class="n">symmetry_indices</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">'Up'</span><span class="p">:</span>    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
      <span class="s1">'Down'</span><span class="p">:</span>  <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
      <span class="s1">'Left'</span><span class="p">:</span>  <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
      <span class="s1">'Right'</span><span class="p">:</span> <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">]}</span>

    <span class="k">if</span> <span class="n">change</span><span class="p">[</span><span class="s1">'new'</span><span class="p">]:</span>  <span class="c1"># If the toggle button is activated</span>
      <span class="n">base_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_fields</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># The 'Up' row</span>
      <span class="n">base_perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">symmetry_indices</span><span class="p">[</span><span class="s1">'Up'</span><span class="p">])</span>  <span class="c1"># Convert to a NumPy array for easier manipulation</span>

      <span class="k">for</span> <span class="n">row_label</span><span class="p">,</span> <span class="n">hbox</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row_labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_fields</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>  <span class="c1"># Include all rows</span>
        <span class="n">link_row</span> <span class="o">=</span> <span class="n">hbox</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># Skip the label</span>
        <span class="n">perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">symmetry_indices</span><span class="p">[</span><span class="n">row_label</span><span class="p">])</span>  <span class="c1"># Convert to a NumPy array for easier manipulation</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">perm</span><span class="p">):</span>
          <span class="n">base_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">base_perm</span> <span class="o">==</span> <span class="n">j</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
          <span class="k">if</span> <span class="n">row_label</span> <span class="o">!=</span> <span class="s1">'Up'</span> <span class="ow">or</span> <span class="n">base_index</span> <span class="o">!=</span> <span class="n">i</span><span class="p">:</span>  <span class="c1"># Skip self-links</span>
            <span class="n">link</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">jslink</span><span class="p">((</span><span class="n">base_row</span><span class="p">[</span><span class="n">base_index</span><span class="p">],</span> <span class="s1">'value'</span><span class="p">),</span> <span class="p">(</span><span class="n">link_row</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">'value'</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">unlink_symmetric_widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
      <span class="n">link</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>


  <span class="k">def</span> <span class="nf">toggle_symmetry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">change</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">change</span><span class="o">.</span><span class="n">new</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">link_symmetric_widgets</span><span class="p">(</span><span class="n">change</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">unlink_symmetric_widgets</span><span class="p">()</span>


  <span class="k">def</span> <span class="nf">set_best_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">hbox</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_fields</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hbox</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
          <span class="n">field</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_params</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>





<span class="k">class</span> <span class="nc">ComplexMoveInteractiveGridworld</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  A widget based object for interacting with a gridworld game when more</span>
<span class="sd">  complicated (fast) moves are allowed</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gridworld_game</span><span class="p">,</span> <span class="n">init_board</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">has_fov</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collect_fov_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">critter_names</span><span class="o">=</span><span class="p">[</span><span class="s1">'Critter'</span><span class="p">],</span> <span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="s1">'human'</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Initializes a widget based object for interacting with a gridworld game</span>

<span class="sd">    Args:</span>
<span class="sd">      gridworld_game: an instance of GridworldGame object</span>
<span class="sd">        expects this to have batchsize 1</span>
<span class="sd">      init_board: (optional) a triple of np arrays representing board state</span>
<span class="sd">        pieces,       - batch_size x n_rows x n_cols</span>
<span class="sd">        scores,       - batch_size</span>
<span class="sd">        rounds_left   - batch_size</span>
<span class="sd">        if left out will initialize with a random board state</span>
<span class="sd">      has_fov: bool, whether or not to display fog of war around the critter</span>
<span class="sd">      radius: int, number of squares the critter can "see" around it</span>
<span class="sd">      figsize: tuple (int, int), size of the figure</span>
<span class="sd">      critter_names: a list of strings that determines what the critter is called</span>
<span class="sd">        in the plot legend, order should align with players</span>
<span class="sd">      player: a list of either 'human', None, or a player object with a play</span>
<span class="sd">        method and a critter_index attribute. If 'human' use buttons,  if None</span>
<span class="sd">        default to making a RandomValidPlayer object, otherwise use the</span>
<span class="sd">        player class provided to make the player objects and use a start button.</span>
<span class="sd">        The list needs to be as long as the gridworld_game.num_critters</span>
<span class="sd">        attribute. Order should align with critter_name.</span>

<span class="sd">      Note: fov is going to look pretty janky with more than one player, maybe</span>
<span class="sd">      we get fov to only turn on for the 'active' player?</span>
<span class="sd">    """</span>

    <span class="c1"># Set GridworldGame object and initialize the board state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span> <span class="o">=</span> <span class="n">gridworld_game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span> <span class="o">=</span> <span class="n">has_fov</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span> <span class="o">=</span> <span class="n">fov_opaque</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">percept_len</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="o">=</span> <span class="n">collect_fov_data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">figsize</span> <span class="o">=</span> <span class="n">figsize</span>
    <span class="c1"># initialize players and plotting specs together to ensure alignment</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">players</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">any_human_players</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">crit_specs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'h'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">]</span>  <span class="c1"># hexagon and diamond</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">"colorblind"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">):</span>
      <span class="n">spec</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'marker'</span><span class="p">:</span> <span class="n">markers</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">markers</span><span class="p">)],</span>
              <span class="s1">'color'</span><span class="p">:</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="nb">len</span><span class="p">(</span><span class="n">markers</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)],</span>
              <span class="s1">'name'</span><span class="p">:</span> <span class="n">critter_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
              <span class="s1">'int_id'</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">crit_specs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
      <span class="n">player</span> <span class="o">=</span> <span class="n">players</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1">#implict check that players is at least long enough</span>
      <span class="k">if</span> <span class="n">player</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RandomValidPlayer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="k">elif</span> <span class="n">player</span> <span class="o">==</span> <span class="s1">'human'</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'human'</span><span class="p">)</span>
        <span class="c1"># right now only ever have on human player with index 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">any_human_players</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1"># player objects expected to have a critter_index attribute</span>
        <span class="c1"># we set it appropriately here so it aligns with the players list</span>
        <span class="c1"># used to create the widget</span>
        <span class="n">player</span><span class="o">.</span><span class="n">critter_index</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">init_board</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">get_init_board</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span> <span class="o">=</span> <span class="n">init_board</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="c1"># keep raw records of percept and eating for manipulation later</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">percept_eat_records</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="c1"># keep data in contingency table of how many food items were in</span>
      <span class="c1"># the percept, and whether or not food was eaten</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">percept_len</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="c1"># Initialize widgets and buttons</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
      <span class="n">width</span> <span class="o">=</span> <span class="s1">'21.0em'</span><span class="p">,</span> <span class="n">min_width</span><span class="o">=</span><span class="s1">'21.0em'</span><span class="p">,</span> <span class="n">max_width</span><span class="o">=</span><span class="s1">'22.0em'</span><span class="p">,</span>
      <span class="n">min_height</span><span class="o">=</span><span class="s1">'10.0em'</span><span class="p">,</span> <span class="n">overflow</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
      <span class="n">min_width</span><span class="o">=</span><span class="s1">'12.5em'</span><span class="p">,</span> <span class="n">max_width</span><span class="o">=</span><span class="s1">'18.8em'</span><span class="p">,</span>
      <span class="n">min_height</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">,</span> <span class="n">overflow</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
      <span class="n">min_width</span><span class="o">=</span><span class="s1">'25.0em'</span><span class="p">,</span> <span class="n">min_height</span><span class="o">=</span><span class="s1">'18.8em'</span><span class="p">,</span> <span class="n">overflow</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Up"</span><span class="p">,</span>
      <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Down"</span><span class="p">,</span>
      <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Left"</span><span class="p">,</span>
      <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Right"</span><span class="p">,</span>
      <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">move_options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Stay'</span><span class="p">,</span> <span class="s1">'Up'</span><span class="p">,</span> <span class="s1">'Down'</span><span class="p">,</span> <span class="s1">'Left'</span><span class="p">,</span> <span class="s1">'Right'</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">move1_dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
      <span class="n">options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">move_options</span><span class="p">,</span>
      <span class="n">value</span><span class="o">=</span><span class="s1">'Stay'</span><span class="p">,</span>
      <span class="n">description</span><span class="o">=</span><span class="s1">'First Move Part:'</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">move2_dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
      <span class="n">options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">move_options</span><span class="p">,</span>
      <span class="n">value</span><span class="o">=</span><span class="s1">'Stay'</span><span class="p">,</span>
      <span class="n">description</span><span class="o">=</span><span class="s1">'Second Move Part:'</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">confirm_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Confirm Move"</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Start"</span><span class="p">,</span>
      <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'6.3em'</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game_running</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># get plot canvas widgets and other plotting objects</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">any_human_players</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">legend_type</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># don't keep regenerating the legend</span>
      <span class="c1"># do legend separately if showing observations and no human player</span>
      <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span><span class="p">,</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax_legend</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">critter_specs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crit_specs</span><span class="p">,</span>
          <span class="n">legend_type</span><span class="o">=</span><span class="s1">'separate'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">figsize</span><span class="p">,</span> <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span>
          <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span>
          <span class="n">focal_critter_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">legend_type</span><span class="o">=</span><span class="kc">None</span> <span class="c1"># don't keep regenerating the legend</span>
      <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span><span class="p">,</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax_legend</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">critter_specs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crit_specs</span><span class="p">,</span>
          <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span> <span class="n">legend_type</span><span class="o">=</span><span class="s1">'separate'</span><span class="p">,</span>
          <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">figsize</span><span class="p">,</span>
          <span class="n">focal_critter_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">legend_type</span> <span class="o">=</span> <span class="s1">'included'</span>
      <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                <span class="n">critter_specs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crit_specs</span><span class="p">,</span>
                                <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span>
                                <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span>
                                <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">figsize</span><span class="p">,</span>
                                <span class="n">focal_critter_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">)</span>
    <span class="c1"># lump buttons together</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">left_button</span><span class="p">,</span>
                               <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">up_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span><span class="p">]),</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span><span class="p">])</span>
    <span class="c1"># automatically pick different layouts for different situations</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">any_human_players</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">board_and_buttons</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="p">])</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">'human'</span><span class="p">:</span>
        <span class="c1"># first player isn't human disable direction buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disable_direction_buttons</span><span class="p">()</span>

      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#one human player</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_and_score</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_table_final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">board_and_buttons</span><span class="p">,</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">output_and_score</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
          <span class="c1"># a single human player collecting data</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">no_table_final_display</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_display</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># self.collect_fov_data == False:</span>
          <span class="c1"># a single human player not collecting data</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_table_final_display</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1"># more than one player, at least one of them human</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V_board_outbput</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">board_and_buttons</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V_scoreboard_start_legend</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">V_board_outbput</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">V_scoreboard_start_legend</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># player is some kind of ai</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># an ai player with recording</span>
        <span class="c1"># in this case legend is separate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V_score_start_output_legend</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">,</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="p">,</span>  <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V_board_table</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_display</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">V_board_table</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">V_score_start_output_legend</span><span class="p">])</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
          <span class="c1"># an ai player without recording</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">H_score_output_start</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="p">])</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H_score_output_start</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="c1"># more than one ai player</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">V_board_outbput</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">])</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">V_scoreboard_start_legend</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">])</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">final_display</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">V_board_outbput</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">V_scoreboard_start_legend</span><span class="p">])</span>

    <span class="c1"># initialize text outputs</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">:</span>
      <span class="n">table</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">'High Score:'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'--'</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">,</span>
               <span class="p">[</span><span class="s1">'Last Score:'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'--'</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">,</span>
               <span class="p">[</span><span class="s1">'Average Score:'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'--'</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">,]</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">''</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s1">'P</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">'</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">)]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">))</span>
      <span class="k">else</span><span class="p">:</span> <span class="c1"># len(self.players) == 1</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">any_human_players</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Click a button to start playing'</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Click the start button to run the simulation'</span><span class="p">)</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_display</span><span class="p">:</span>
      <span class="n">printmd</span><span class="p">(</span><span class="s2">"**Observations**"</span><span class="p">)</span>
      <span class="n">table_data</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">str</span><span class="p">(</span><span class="n">ii</span><span class="p">),</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">]),</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">ii</span><span class="p">])]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">)]</span>
      <span class="n">table</span> <span class="o">=</span> <span class="p">([[</span><span class="s1">'Food in Percept'</span><span class="p">,</span> <span class="s1">'Food Not Eaten'</span><span class="p">,</span> <span class="s1">'Food Eaten'</span><span class="p">]]</span> <span class="o">+</span>
               <span class="n">table_data</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>

    <span class="c1"># Connect the buttons to functions that do something</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_up_button_clicked</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_down_button_clicked</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_left_button_clicked</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_right_button_clicked</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_start_button_clicked</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">button_output_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_button</span><span class="p">):</span>
    <span class="n">old_board</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">next_player_index</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span>
    <span class="c1"># index of players is 0 through num_critter-1,</span>
    <span class="c1"># same player represented by value of index + 1 in</span>
    <span class="n">old_scores</span> <span class="o">=</span> <span class="n">old_board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">old_board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
      <span class="n">b</span> <span class="o">=</span> <span class="n">GridworldBoard</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">lifetime</span><span class="p">,</span>
                         <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">rng</span><span class="p">)</span>
      <span class="n">b</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">old_board</span><span class="p">)</span>
      <span class="n">percept</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get_perceptions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span>
        <span class="s1">'human'</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">]):</span>
      <span class="n">direction</span> <span class="o">=</span> <span class="n">which_button</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">critter_oriented_get_next_state</span><span class="p">(</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">direction</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">a_player</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">]</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">old_board</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">get_next_state</span><span class="p">(</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">a_player</span><span class="p">)</span>
      <span class="n">a_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">a_player</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">n_cols</span><span class="p">)</span>
      <span class="n">a_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">a_player</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">n_cols</span><span class="p">)</span>

    <span class="n">new_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#first batch first critter type</span>
    <span class="n">rounds_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">num_moves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">lifetime</span> <span class="o">-</span>
                         <span class="n">rounds_left</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">new_scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">old_scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">]:</span>
      <span class="c1">#eating happened</span>
      <span class="n">eating_string</span> <span class="o">=</span> <span class="s2">"They ate the food/prey there!"</span>
      <span class="n">did_eat</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#eating didn't happen</span>
      <span class="n">eating_string</span> <span class="o">=</span> <span class="s2">"There's no food/prey there."</span>
      <span class="n">did_eat</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">get_critter_rc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span>
     <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                             <span class="n">fig</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span>
                             <span class="n">critter_specs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="n">food</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span>
                             <span class="n">fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span><span class="p">,</span> <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span>
                             <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span>
                             <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="n">legend_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_type</span><span class="p">,</span>
                             <span class="n">focal_critter_index</span><span class="o">=</span><span class="n">next_player_index</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_fov_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">p_e_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'perception'</span><span class="p">:</span> <span class="n">percept</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
                  <span class="s1">'state'</span><span class="p">:</span> <span class="n">old_board</span><span class="p">,</span>
                  <span class="s1">'did_eat'</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">did_eat</span><span class="p">)}</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">percept_eat_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_e_data</span><span class="p">)</span>
      <span class="n">percept_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">percept</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># number of food items in FoV</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span><span class="p">[</span><span class="n">did_eat</span><span class="p">,</span> <span class="n">percept_int</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
      <span class="n">clear_output</span><span class="p">()</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
          <span class="nb">print</span><span class="p">(</span><span class="s2">"The critter (tried) to move "</span> <span class="o">+</span>
                <span class="n">direction</span> <span class="o">+</span>
                <span class="s2">" and is now at (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="nb">print</span><span class="p">(</span><span class="s2">"The critter (tried) to move "</span> <span class="o">+</span>
                <span class="s2">"to "</span> <span class="o">+</span> <span class="s2">"(</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_r</span><span class="p">,</span> <span class="n">a_c</span><span class="p">)</span> <span class="o">+</span>
                <span class="s2">" and is now at (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">eating_string</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Rounds Left: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Scores: </span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">rounds_left</span><span class="p">,</span> <span class="n">new_scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">]))</span>
      <span class="k">else</span><span class="p">:</span> <span class="c1"># more than one players</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
          <span class="nb">print</span><span class="p">(</span><span class="s2">"Critter </span><span class="si">{}</span><span class="s2"> (tried) to move "</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
                <span class="n">direction</span> <span class="o">+</span>
                <span class="s2">" and is now at (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="nb">print</span><span class="p">(</span><span class="s2">"Critter </span><span class="si">{}</span><span class="s2"> (tried) to move "</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
                <span class="s2">"to "</span> <span class="o">+</span> <span class="s2">"(</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_r</span><span class="p">,</span> <span class="n">a_c</span><span class="p">)</span> <span class="o">+</span>
                <span class="s2">" and is now at (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">eating_string</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Rounds Left: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">Scores: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">rounds_left</span><span class="p">,</span> <span class="n">new_scores</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">rounds_left</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_scores</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">game_running</span> <span class="o">=</span> <span class="kc">False</span>
      <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
        <span class="n">clear_output</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Game Over. Final Score </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new_scores</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Resetting the board for another game'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">get_init_board</span><span class="p">()</span>
      <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span>
       <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">plot_board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_ax</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">b_crit_specs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_food</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_fov</span><span class="p">,</span>
                               <span class="n">has_fov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">has_fov</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span>
                               <span class="n">fov_opaque</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_opaque</span><span class="p">,</span>
                               <span class="n">legend_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_type</span><span class="p">,</span>
                               <span class="n">focal_critter_index</span><span class="o">=</span><span class="n">next_player_index</span><span class="p">)</span>
      <span class="c1"># start_button can be clicked now</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">scoreboard</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Games Played: '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
          <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
              <span class="p">[</span><span class="s1">'High Score:'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)))],</span>
              <span class="p">[</span><span class="s1">'Last Score:'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])],</span>
              <span class="p">[</span><span class="s1">'Average Score'</span><span class="p">,</span>
              <span class="s1">'</span><span class="si">{:.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)))]]</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">'High Score:'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">],</span>
                     <span class="p">[</span><span class="s1">'Last Score:'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">],</span>
                     <span class="p">[</span><span class="s1">'Average Score:'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">]]</span>
          <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># len(self.players) &gt; 1</span>
          <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">''</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s1">'P</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">'</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">)]</span>
          <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Assuming the batch size is 1 for now</span>
            <span class="n">current_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">max_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">average_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_scores</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">'High Scores:'</span><span class="p">]</span> <span class="o">+</span>
              <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">max_scores</span><span class="p">])</span>
            <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">'Last Scores:'</span><span class="p">]</span> <span class="o">+</span>
              <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">current_scores</span><span class="p">])</span>
            <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">'Average Scores:'</span><span class="p">]</span> <span class="o">+</span>
              <span class="p">[</span><span class="s1">'</span><span class="si">{:.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">average_scores</span><span class="p">])</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
              <span class="p">[</span><span class="s1">'High Score:'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'--'</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">,</span>
              <span class="p">[</span><span class="s1">'Last Score:'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'--'</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">,</span>
              <span class="p">[</span><span class="s1">'Average Score:'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'--'</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gwg</span><span class="o">.</span><span class="n">num_critters</span><span class="p">,]</span>
          <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">))</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_display</span><span class="p">:</span>
      <span class="n">clear_output</span><span class="p">()</span>
      <span class="n">printmd</span><span class="p">(</span><span class="s2">"**Observations**"</span><span class="p">)</span>
      <span class="n">table_data</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">str</span><span class="p">(</span><span class="n">ii</span><span class="p">),</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">]),</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fov_eat_table_data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">ii</span><span class="p">])]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">)]</span>
      <span class="n">table</span> <span class="o">=</span> <span class="p">([[</span><span class="s1">'Food in Percept'</span><span class="p">,</span> <span class="s1">'Food Not Eaten'</span><span class="p">,</span> <span class="s1">'Food Eaten'</span><span class="p">]]</span> <span class="o">+</span>
               <span class="n">table_data</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>

    <span class="c1"># last thing after all display stuff is done</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_player_and_rounds</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">disable_direction_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">def</span> <span class="nf">enable_direction_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">up_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">down_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">False</span>

  <span class="k">def</span> <span class="nf">update_player_and_rounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Update the player index and decrement rounds if a full loop is completed."""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">board_state</span><span class="p">[</span><span class="s1">'rounds_left'</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>

  <span class="k">def</span> <span class="nf">human_ai_player_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">disable_direction_buttons</span><span class="p">()</span>  <span class="c1"># Disable buttons, no double clicks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game_running</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># Execute the move of the human who clicked the button</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">button_output_update</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
    <span class="c1"># Move to the next player</span>
    <span class="c1"># Do AI moves if there are any</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">'human'</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_running</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">button_output_update</span><span class="p">(</span><span class="s1">'tbd'</span><span class="p">)</span>
      <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="c1"># Next player is human turn buttons on for them</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enable_direction_buttons</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">start_game</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># If first player is AI start button kicks off this loop</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game_running</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">players</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">active_player_index</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">'human'</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_running</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">button_output_update</span><span class="p">(</span><span class="s1">'tbd'</span><span class="p">)</span>
      <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="c1"># Next player is human, turn buttons on for them</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enable_direction_buttons</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">on_up_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">human_ai_player_loop</span><span class="p">(</span><span class="s1">'up'</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_down_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">human_ai_player_loop</span><span class="p">(</span><span class="s1">'down'</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_left_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">human_ai_player_loop</span><span class="p">(</span><span class="s1">'left'</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_right_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">human_ai_player_loop</span><span class="p">(</span><span class="s1">'right'</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_start_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_game</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enable_direction_buttons</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2021 has been set.
This notebook isn't using and doesn't need a GPU. Good.
Running in colab
Not running in colab
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="eat-and-be-eaten">
<h1>1.3.3.1: Eat and Be Eaten<a class="headerlink" href="#eat-and-be-eaten" title="Permalink to this headline">¶</a></h1>
<p>Previously, in sequence 1.1.3, we touched upon how competition (or interactions) with other organisms can play a crucial role in the environment an organism adapts its behavior to, Now that we have a richer optimization and evolutionary framework we’re going to dig into how these kinds of interactions really exacerbate the optimization problem. We’ll modify Gridworld (again!) this time introducing two different types of organism. The first is a prey organism that eats (stationary) food much as in our original Gridworld variant. The second is predator organism that eats the prey organism (by moving onto a grid cell containing a prey organism). Much like food, a new prey organism re-spawns randomly in an empty grid cell when eaten. Now, we have two distinct games being played: the ‘Eat Food, Don’t Get Eaten’ game for the prey and the ‘Eat the Prey’ game for the predator. These are of course different perspectives on the same interaction, but as we will see, it will help our analysis to separate out these two points of view. First though to get a feel for things, play the game first as a predator organism, then as prey organism. And see how it goes. In this first instance the prey organism just moves uniformly at random to a valid destination. To create an interesting playing field, the prey can now move up to 2 grid cells at once or stay stationary. The predator has an expanded perceptive field, but it can move only one grid cell (or none) at a time.</p>
<div class="section" id="interaction-try-to-eat-the-critter">
<h2>Interaction: Try to Eat the Critter<a class="headerlink" href="#interaction-try-to-eat-the-critter" title="Permalink to this headline">¶</a></h2>
<p><strong>Run this cell</strong> to have a go at eating a quick but oblivious prey organism.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown **Run this cell** to have a go at eating a quick but oblivious prey organism.</span>
<span class="n">gwg</span> <span class="o">=</span> <span class="n">GridworldGame</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                    <span class="n">num_pred</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">lifetime</span><span class="o">=</span><span class="mi">30</span><span class="p">,)</span>
<span class="n">fast_rvp</span> <span class="o">=</span> <span class="n">RandomValidPlayer</span><span class="p">(</span><span class="n">gwg</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                             <span class="n">speed</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">complex_igwg</span> <span class="o">=</span> <span class="n">ComplexMoveInteractiveGridworld</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="n">fast_rvp</span><span class="p">,</span> <span class="s1">'human'</span><span class="p">],</span> <span class="n">critter_names</span><span class="o">=</span><span class="p">[</span><span class="s1">'Prey'</span><span class="p">,</span> <span class="s1">'Pred(You!)'</span><span class="p">],</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">has_fov</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">complex_igwg</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">complex_igwg</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">complex_igwg</span><span class="o">.</span><span class="n">final_display</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "50e8b5d9cbc04dcfadef7be8b6f279e0"}
</script></div>
</div>
</div>
<div class="section" id="interaction-try-to-eat-food-and-not-get-eaten">
<h2>Interaction: Try to Eat Food and Not Get Eaten<a class="headerlink" href="#interaction-try-to-eat-food-and-not-get-eaten" title="Permalink to this headline">¶</a></h2>
<p><strong>Run this cell</strong> to have a go at eating food while avoiding a predator that will eat you if you are nearby.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown **Run this cell** to have a go at eating food while avoiding a predator that will eat you if you are nearby.</span>
<span class="n">gwg</span> <span class="o">=</span> <span class="n">GridworldGame</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                    <span class="n">num_pred</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">lifetime</span><span class="o">=</span><span class="mi">30</span><span class="p">,)</span>
<span class="n">enpp</span> <span class="o">=</span> <span class="n">EatNearPredPlayer</span><span class="p">(</span><span class="n">gwg</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">complex_igwg</span> <span class="o">=</span> <span class="n">ComplexMoveInteractiveGridworld</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="s1">'human'</span><span class="p">,</span> <span class="n">enpp</span><span class="p">],</span> <span class="n">critter_names</span><span class="o">=</span><span class="p">[</span><span class="s1">'Prey(You!)'</span><span class="p">,</span> <span class="s1">'Pred'</span><span class="p">],</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">has_fov</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">complex_igwg</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">complex_igwg</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">complex_igwg</span><span class="o">.</span><span class="n">final_display</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "550a5eefa71440f08dff17ee39a79c31"}
</script></div>
</div>
</div>
<div class="section" id="interaction-play-as-both-predator-and-prey">
<h2>Interaction: Play as Both Predator and Prey<a class="headerlink" href="#interaction-play-as-both-predator-and-prey" title="Permalink to this headline">¶</a></h2>
<p><strong>Run this cell</strong> to have take control of both the prey and predator organisms</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown **Run this cell** to have take control of both the prey and predator organisms</span>
<span class="n">gwg</span> <span class="o">=</span> <span class="n">GridworldGame</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                    <span class="n">num_pred</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">lifetime</span><span class="o">=</span><span class="mi">3</span><span class="p">,)</span>
<span class="n">complex_igwg</span> <span class="o">=</span> <span class="n">ComplexMoveInteractiveGridworld</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="s1">'human'</span><span class="p">,</span> <span class="s1">'human'</span><span class="p">],</span> <span class="n">critter_names</span><span class="o">=</span><span class="p">[</span><span class="s1">'Prey'</span><span class="p">,</span> <span class="s1">'Pred'</span><span class="p">],</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">has_fov</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">complex_igwg</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">complex_igwg</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">complex_igwg</span><span class="o">.</span><span class="n">final_display</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "eb68c99eff1e473f8874caa496cb1e6c"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulation-watch-random-predator-and-prey">
<h1>Simulation: Watch Random Predator and Prey<a class="headerlink" href="#simulation-watch-random-predator-and-prey" title="Permalink to this headline">¶</a></h1>
<p><strong>Run this cell</strong> to watch a random prey and predator organism.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown **Run this cell** to watch a random prey and predator organism.</span>
<span class="n">gwg</span> <span class="o">=</span> <span class="n">GridworldGame</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                    <span class="n">num_pred</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">lifetime</span><span class="o">=</span><span class="mi">30</span><span class="p">,)</span>

<span class="n">prey_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">has_food_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">has_edge_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_prey_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_pred_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pred_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">has_food_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">has_edge_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_prey_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_pred_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">complex_igwg</span> <span class="o">=</span> <span class="n">ComplexMoveInteractiveGridworld</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="n">prey_player</span><span class="p">,</span> <span class="n">pred_player</span><span class="p">],</span> <span class="n">critter_names</span><span class="o">=</span><span class="p">[</span><span class="s1">'Prey'</span><span class="p">,</span> <span class="s1">'Pred'</span><span class="p">],</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">has_fov</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">complex_igwg</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">complex_igwg</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">complex_igwg</span><span class="o">.</span><span class="n">final_display</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "289f50a76dd04be39c42326ac7d9d459"}
</script></div>
</div>
<p>Submit your feedback</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_M1"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "e091dc231bfd4424803dd8204117ce47"}
</script></div>
</div>
</div>
<div class="section" id="optimize-the-prey-optimize-the-predator">
<h1>1.3.3.2: Optimize the Prey, Optimize the Predator<a class="headerlink" href="#optimize-the-prey-optimize-the-predator" title="Permalink to this headline">¶</a></h1>
<p>Now that we have a sense of the Predator-Prey game dynamics it’s time to start optimizing policies for this new competitive environment. An effective policy for a prey organism will differ markedly from that of a predator; each type warrants a distinct policy, each requiring a separate optimization process.</p>
<p>Before starting on policy optimization, we first need to extend and generalize our parameterized policy player from earlier sequences.
Specifically, instead of solely perceiving food, a policy should now also respond to the presence of other organisms and the board’s edges, augmenting the initial food-only perception. Moreover, to allow for diverse policies to emerge, we’re enhancing the prey’s speed, allowing movement across two grid cells. This means the prey can target any of the 12 nearest cells, as opposed to just the 4 adjacent ones, effectively reaching any grid cell within its sight. Likewise, the predator’s perceptive field is expanded, now encompassing 24 surrounding grid cells—effectively covering half the board when centered. Previously we didn’t allow for organisms to stay in one spot, but now this will also be enabled for both prey and predator types.</p>
<div class="section" id="coding-exercise-implement-predator-and-prey-policies">
<h2>Coding Exercise: Implement Predator and Prey Policies<a class="headerlink" href="#coding-exercise-implement-predator-and-prey-policies" title="Permalink to this headline">¶</a></h2>
<p>We define a general class for both predator and prey players below (you should skim this but not aim for deep understanding). Both the prey and predator organisms will be constructed from this foundational class using suitable parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">GeneralLinearPlayer</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Represents a player in a grid-world game with a linear policy based on given weights.</span>
<span class="sd">  The player's perception and actions are determined by its parameters.</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">has_food_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_edge_percept</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">has_prey_percept</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">has_pred_percept</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">get_probs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">deterministic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Initialize the player.</span>

<span class="sd">    Args:</span>
<span class="sd">      game (GridworldGame instance): The game the player is part of.</span>
<span class="sd">      critter_index (int): Determines the role (prey or predator) of the player.</span>
<span class="sd">      ... (Other parameters are self-explanatory)</span>
<span class="sd">    """</span>
    <span class="c1"># Validate critter index</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">critter_index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">critter_index</span> <span class="o">&lt;=</span> <span class="n">game</span><span class="o">.</span><span class="n">num_critters</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Invalid critter index value. Ensure it's a positive integer within game limits."</span><span class="p">)</span>

    <span class="c1"># Essential attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span> <span class="o">=</span> <span class="n">critter_index</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_probs</span> <span class="o">=</span> <span class="n">get_probs</span>

    <span class="c1"># Player-specific attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="n">deterministic</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span> <span class="o">=</span> <span class="n">fov_radius</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="n">speed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">W_out_shape</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">W_in_shape</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_food_percept</span> <span class="o">=</span> <span class="n">has_food_percept</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_edge_percept</span> <span class="o">=</span> <span class="n">has_edge_percept</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_prey_percept</span> <span class="o">=</span> <span class="n">has_prey_percept</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_pred_percept</span> <span class="o">=</span> <span class="n">has_pred_percept</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">W_layers</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">has_food_percept</span><span class="p">,</span> <span class="n">has_edge_percept</span><span class="p">,</span> <span class="n">has_prey_percept</span><span class="p">,</span> <span class="n">has_pred_percept</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">W_shape</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W_layers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_out_shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_in_shape</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">weights</span> <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_shape</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Weights shape mismatch. Check fov, speed, and percepts."</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_softmax_temp</span> <span class="o">=</span> <span class="mf">0.05</span>

  <span class="k">def</span> <span class="nf">direction_value_from_percept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percepts</span><span class="p">,</span> <span class="n">W</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Calculate action values based on player's perception.</span>

<span class="sd">    Args:</span>
<span class="sd">      percepts (np.array): Surroundings the player perceives.</span>
<span class="sd">      W (np.array): Connection strengths between perceptions and actions.</span>

<span class="sd">    Returns:</span>
<span class="sd">      np.array: Raw output activations for possible actions.</span>
<span class="sd">    """</span>
    <span class="n">expanded_percepts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Check if the player can perceive each type and append the perception</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_food_percept</span><span class="p">:</span>
      <span class="n">x_food</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">((</span><span class="n">percepts</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">percepts</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">200</span><span class="p">),</span> <span class="nb">float</span><span class="p">)</span> <span class="c1"># batch x len W_in</span>
      <span class="n">expanded_percepts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_food</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_edge_percept</span><span class="p">:</span>
      <span class="n">x_edge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">percepts</span> <span class="o">==</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="c1"># batch x len W_in</span>
      <span class="n">expanded_percepts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_edge</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_prey_percept</span><span class="p">:</span>
      <span class="n">x_prey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">((</span><span class="n">percepts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span>
       <span class="p">(</span><span class="n">percepts</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">pred_prey_threshold</span><span class="p">),</span> <span class="nb">float</span><span class="p">)</span> <span class="c1"># batch x len W_in</span>
      <span class="n">expanded_percepts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_prey</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_pred_percept</span><span class="p">:</span>
      <span class="n">x_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">percepts</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">pred_prey_threshold</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="c1"># batch x len W_in</span>
      <span class="n">expanded_percepts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_pred</span><span class="p">)</span>
    <span class="c1"># Stack all perceptions together in an array</span>
    <span class="n">percept_stack</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">expanded_percepts</span><span class="p">)</span> <span class="c1"># W_layers x batch x len_W_in</span>

    <span class="c1"># `np.tensordot` computes weighted sums of perceptions,</span>
    <span class="c1"># determining the influence of each perception on potential actions.</span>
    <span class="c1"># It efficiently does this as a tensor product between the perception stack</span>
    <span class="c1"># and the weights, across all the batches.</span>
    <span class="n">output_activations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">percept_stack</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span> <span class="c1"># batch x W_out</span>
    <span class="c1"># `np.tensordot` is packing a lot under the hood. Specifically it is doing</span>
    <span class="c1"># the following far more efficiently:</span>
    <span class="c1"># output_activations = np.zeros((self.game.batch_size, self.W_out))</span>
    <span class="c1"># for b in range(self.game.batch_size): #each batch</span>
    <span class="c1">#   for l in range(self.W_layers):      #each percept type</span>
    <span class="c1">#     for o in range(self.W_out):       #each output direction</span>
    <span class="c1">#       sum_val = 0</span>
    <span class="c1">#       for i in range(W_in):           #each value in the percept</span>
    <span class="c1">#         # increment the value of this direction in this batch by the</span>
    <span class="c1">#         # percept value * the weight strength</span>
    <span class="c1">#         sum_val += percept_stack[b, l, i] * W[l, o, i]</span>
    <span class="c1">#       output_activations[b, o] += sum_val</span>
    <span class="c1"># each row gives the raw output activations for that batch.</span>
    <span class="k">return</span> <span class="n">output_activations</span>

  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Simulate a play on the board.</span>

<span class="sd">    Args:</span>
<span class="sd">      board (dict): Current state of the game board.</span>

<span class="sd">    Returns:</span>
<span class="sd">      tuple: Action taken, one-hot representation, and action probabilities.</span>
<span class="sd">    """</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span> <span class="k">if</span> <span class="n">temp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_softmax_temp</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">W</span> <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">W</span>
    <span class="n">perceptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_perceptions</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fov_radius</span><span class="p">)</span>
    <span class="n">direction_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction_value_from_percept</span><span class="p">(</span><span class="n">perceptions</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>

    <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="s1">'pieces'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">legal_offsets</span><span class="p">,</span> <span class="n">valid_moves_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">get_legal_offsets</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">critter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">critter_index</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">)</span>
    <span class="n">flat_values</span> <span class="o">=</span> <span class="n">direction_values</span><span class="p">[</span><span class="n">valid_moves_mask</span><span class="p">]</span>
    <span class="n">action_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="n">n_cols</span><span class="p">))</span> <span class="o">*</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="n">action_values</span><span class="p">[(</span><span class="n">legal_offsets</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">legal_offsets</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_cols</span> <span class="o">+</span> <span class="n">legal_offsets</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])]</span> <span class="o">=</span> <span class="n">flat_values</span>

    <span class="c1"># Determine action based on the mode (deterministic or probabilistic)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deterministic</span><span class="p">:</span>
      <span class="n">sampled_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">action_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">one_hot_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="n">n_cols</span><span class="p">))</span>
      <span class="n">one_hot_actions</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">sampled_actions</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
      <span class="k">return</span> <span class="n">sampled_actions</span><span class="p">,</span> <span class="n">one_hot_actions</span><span class="p">,</span> <span class="n">one_hot_actions</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">action_probs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_action_probabilities</span><span class="p">(</span><span class="n">action_values</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
      <span class="n">random_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
      <span class="n">sampled_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">action_probs</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">random_samples</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">one_hot_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="n">n_cols</span><span class="p">))</span>
      <span class="n">one_hot_actions</span><span class="p">[(</span><span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">sampled_actions</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.0</span>
      <span class="k">return</span> <span class="n">sampled_actions</span><span class="p">,</span> <span class="n">one_hot_actions</span><span class="p">,</span> <span class="n">action_probs</span>

  <span class="k">def</span> <span class="nf">get_action_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action_values</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Compute the softmax probabilities of the actions."""</span>
    <span class="n">shifted_values</span> <span class="o">=</span> <span class="n">action_values</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">action_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">scaled_values</span> <span class="o">=</span> <span class="n">shifted_values</span> <span class="o">/</span> <span class="n">temp</span>
    <span class="n">exponentiated_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">scaled_values</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">exponentiated_values</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">exponentiated_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Your job is to pass the correct arguments into the player initialization function to create a <code class="docutils literal notranslate"><span class="pre">prey_player</span></code> and a <code class="docutils literal notranslate"><span class="pre">pred_player</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################</span>
<span class="c1"># TODO for students: Complete the lines with ... to instantiate two differ..ent</span>
<span class="c1"># organisms. A prey type with field of view and speed 2, and a predator type</span>
<span class="c1"># with a field of view 3 and a speed of 1. Both predator and prey are able to</span>
<span class="c1"># percieve and distinguish between food, edges, prey and predators in their</span>
<span class="c1"># perceptive field..</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Exercise: instantiate a predator and a prey player"</span><span class="p">)</span>
<span class="c1">################################################################################</span>
<span class="n">gwg</span> <span class="o">=</span> <span class="n">GridworldGame</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=...</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=...</span><span class="p">)</span>
<span class="n">prey_player_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'critter_index'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'fov_radius'</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="s1">'speed'</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
                      <span class="s1">'has_food_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_edge_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                      <span class="s1">'has_prey_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_pred_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">prey_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span><span class="n">gwg</span><span class="p">,</span> <span class="o">**</span><span class="n">prey_player_params</span><span class="p">)</span>

<span class="n">pred_player_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'critter_index'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'fov_radius'</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="s1">'speed'</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
                      <span class="s1">'has_food_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_edge_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                      <span class="s1">'has_prey_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_pred_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">pred_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span><span class="n">gwg</span><span class="p">,</span> <span class="o">**</span><span class="n">pred_player_params</span><span class="p">)</span>
</pre></div>
</div>
</div>

</div>
<p><a class="reference external" href="https://github.com/dcownden/PerennialProblemsOfLifeWithABrain/tree/main//sequences/P1C3_RealEvolution/solutions/P1C3_Sequence3_Solution_126183b0.py"><em>Click for solution</em></a></p>
<p>Now that we are going to be evaluating two distinct organism types, we also need to extend and generalize our evaluation function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_2_types</span><span class="p">(</span><span class="n">prey_player</span><span class="p">,</span> <span class="n">prey_flat_W</span><span class="p">,</span> <span class="n">pred_player</span><span class="p">,</span> <span class="n">pred_flat_W</span><span class="p">,</span>
                     <span class="n">game</span><span class="p">,</span> <span class="n">plt_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">  </span><span class="sd">''' Assumes player objects were instantiated with the passed in game '''</span>

  <span class="n">prey_player</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">prey_flat_W</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">prey_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)</span>
  <span class="n">pred_player</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">pred_flat_W</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">pred_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)</span>

  <span class="n">final_board</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">play_game</span><span class="p">(</span><span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="n">prey_player</span><span class="p">,</span> <span class="n">pred_player</span><span class="p">],</span> <span class="n">visualize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="c1"># Evaluate the score</span>
  <span class="n">prey_scores</span> <span class="o">=</span> <span class="n">final_board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>
  <span class="n">pred_scores</span> <span class="o">=</span> <span class="n">final_board</span><span class="p">[</span><span class="s1">'scores'</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">]</span>
  <span class="n">avg_prey_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span>
  <span class="n">avg_pred_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span>

  <span class="k">if</span> <span class="n">plt_hist</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">weights_prey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">))</span>
    <span class="n">weights_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">prey_scores</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights_prey</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Prey Scores'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">pred_scores</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights_pred</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Predator Scores'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Distribution of Scores"</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Score"</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Probability"</span><span class="p">)</span>
    <span class="n">remove_ip_clutter</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
  <span class="k">return</span><span class="p">(</span><span class="n">avg_prey_score</span><span class="p">,</span> <span class="n">avg_pred_score</span><span class="p">)</span>

<span class="n">gwg</span> <span class="o">=</span> <span class="n">GridworldGame</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">rng</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">202</span><span class="p">))</span>
<span class="n">prey_player_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'critter_index'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'fov_radius'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'speed'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                      <span class="s1">'has_food_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_edge_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                      <span class="s1">'has_prey_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_pred_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">prey_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span><span class="n">gwg</span><span class="p">,</span> <span class="o">**</span><span class="n">prey_player_params</span><span class="p">)</span>
<span class="n">pred_player_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'critter_index'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'fov_radius'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'speed'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                      <span class="s1">'has_food_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_edge_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                      <span class="s1">'has_prey_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_pred_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">pred_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span><span class="n">gwg</span><span class="p">,</span> <span class="o">**</span><span class="n">pred_player_params</span><span class="p">)</span>

<span class="n">avg_prey_score</span><span class="p">,</span> <span class="n">avg_pred_score</span> <span class="o">=</span> <span class="n">evaluate_2_types</span><span class="p">(</span>
    <span class="n">prey_player</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">prey_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)),</span>
    <span class="n">pred_player</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pred_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)),</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">plt_hist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Average prey score: </span><span class="si">{</span><span class="n">avg_prey_score</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Average pred score: </span><span class="si">{</span><span class="n">avg_pred_score</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "002133da544241c498b42da88e9195bf"}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Average prey score: -0.7844444444444445
Average pred score: 0.3877777777777778
</pre></div>
</div>
</div>
</div>
<p>Observing both organisms executing a random drift policy, we notice that the average predator score is slightly positive, and the average prey score is slightly negative. This outcome aligns with expectations. While predator-prey encounters are infrequent, they result in minor gains for predators but substantial losses for prey. These significant losses aren’t totally balanced by the prey’s more common, but lower scoring, food-eating events.</p>
<p>With our evaluation function in place, we’re ready to properly start on the optimization process. For optimization, we’ll use an enhanced version of the evolutionary algorithm from sequence 1.3.1, known as the Covariance Matrix Adaptation Evolutionary Strategy (CMA-ES). While CMA-ES primarily mirrors our basic evolutionary algorithm its distinction lies in its ‘mutation’ distribution. Guided by an evolving covariance matrix, this distribution changes over time, leading to mutants with an increased likelihood of fitness improvement. This changing ‘mutation’ distribution can be seen as a kind of meta-evolution, where mutability itself evolves.</p>
</div>
<hr class="docutils"/>
<div class="section" id="todo-algo-box-covariance-matrix-adaptation-evolutionary-strategy-cma-es">
<h2><strong>TODO</strong> Algo Box: Covariance Matrix Adaptation Evolutionary Strategy (CMA-ES)<a class="headerlink" href="#todo-algo-box-covariance-matrix-adaptation-evolutionary-strategy-cma-es" title="Permalink to this headline">¶</a></h2>
<p>You don’t need to know how this code works right now, but you do need to run this cell, and you might want to skim this code out of curiosity.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown You don't need to know how this code works right now, but you do need to run this cell, and you might want to skim this code out of curiosity.</span>
<span class="k">def</span> <span class="nf">cma_es</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">eval_func</span><span class="p">,</span> <span class="n">focal_pop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">init_m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">init_C</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">init_sigma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">pop_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">select_frac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">weight_scheme</span><span class="o">=</span><span class="s1">'skew'</span><span class="p">,</span> <span class="c1"># other magic word is flat</span>
           <span class="n">c_1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c_mu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c_c</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">c_sig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">d_sig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
           <span class="n">max_gen</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">sigma_tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">value_tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span>
           <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(),</span>
           <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
  <span class="c1"># assumes eval_func returns scores for multiple populations</span>
  <span class="c1"># focal_pop indexes which of these scores is the one we are optimizing for</span>
  <span class="c1"># use heuristics to set constants if none provided</span>
  <span class="c1"># these are the same as in a simple ES algo</span>
  <span class="k">if</span> <span class="n">pop_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">pop_size</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"pop_size set to: </span><span class="si">{</span><span class="n">pop_size</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="n">select_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">pop_size</span> <span class="o">*</span> <span class="n">select_frac</span><span class="p">))</span>

  <span class="k">if</span> <span class="n">weight_scheme</span> <span class="o">==</span> <span class="s1">'skew'</span><span class="p">:</span>
    <span class="n">mu_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">select_size</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">select_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
    <span class="n">mu_w</span> <span class="o">=</span> <span class="n">mu_w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mu_w</span><span class="p">)</span>
    <span class="n">mu_eff</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mu_w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"mu_w set using skew scheme: </span><span class="si">{</span><span class="n">mu_w</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"mu_eff set to: </span><span class="si">{</span><span class="n">mu_eff</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">weight_scheme</span> <span class="o">==</span> <span class="s1">'flat'</span><span class="p">:</span>
    <span class="n">mu_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">select_size</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">select_size</span><span class="p">)</span>
    <span class="n">mu_eff</span> <span class="o">=</span> <span class="n">select_size</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"mu_w set using flat scheme: </span><span class="si">{</span><span class="n">mu_w</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"mu_eff set to: </span><span class="si">{</span><span class="n">mu_eff</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

  <span class="c1"># this is fancy stuff for updating the mutation distribution</span>
  <span class="k">if</span> <span class="n">c_1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">c_1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"c_1 set to: </span><span class="si">{</span><span class="n">c_1</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">c_mu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">c_mu</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c_1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">mu_eff</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">mu_eff</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"c_mu set to: </span><span class="si">{</span><span class="n">c_mu</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">c_c</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">c_c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="n">mu_eff</span><span class="o">/</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">mu_eff</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"c_c set to: </span><span class="si">{</span><span class="n">c_c</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">c_sig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">c_sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu_eff</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">mu_eff</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"c_sig set to: </span><span class="si">{</span><span class="n">c_sig</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">d_sig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">d_sig</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">c_sig</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">mu_eff</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"d_sig set to: </span><span class="si">{</span><span class="n">d_sig</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

  <span class="c1"># Initialize variables of the process to these defaults if none given</span>
  <span class="c1"># (weighted) population mean parameters</span>
  <span class="k">if</span> <span class="n">init_m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">init_m</span>
  <span class="k">if</span> <span class="n">init_C</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># inially the Covariance of the proposal/offspring distribution is just</span>
    <span class="c1"># a standard i.i.d. Gaussian</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">init_C</span>
  <span class="k">if</span> <span class="n">init_sigma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.0</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">init_sigma</span>
  <span class="c1"># p_c is used as a kind of momentum to inform how C is updated</span>
  <span class="n">p_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>


  <span class="c1"># Main loop</span>
  <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
  <span class="n">mean_scores_history</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">gen</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_gen</span><span class="p">):</span>
    <span class="c1"># Steps 1-3 are standard Evolutionary Optimization</span>
    <span class="c1"># 1. Sampe params of this generation</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">C</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">pop_size</span><span class="p">))</span>
    <span class="c1"># 2. Evaluate each member of the new population</span>
    <span class="n">fitness_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">eval_func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">])</span>
    <span class="n">focal_fitness_values</span> <span class="o">=</span> <span class="n">fitness_values</span><span class="p">[:,</span> <span class="n">focal_pop</span><span class="p">]</span>
    <span class="n">sorted_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">focal_fitness_values</span><span class="p">)</span> <span class="c1">#argsort does low to high, so sort neg</span>
    <span class="n">mean_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">fitness_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mean_scores_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_scores</span><span class="p">)</span>
    <span class="c1"># If verbose flag is true, print generation info and mean score</span>
    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
      <span class="n">all_mean_scores</span> <span class="o">=</span> <span class="s2">", "</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">"</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">mean_scores</span><span class="p">])</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Generation </span><span class="si">{</span><span class="n">gen</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">max_gen</span><span class="si">}</span><span class="s2">. Mean Scores: [</span><span class="si">{</span><span class="n">all_mean_scores</span><span class="si">}</span><span class="s2">]. Elapsed Time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds"</span><span class="p">)</span>
    <span class="c1"># 3. Update mean based on selection</span>
    <span class="n">old_m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">selected_samples</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">[:</span><span class="n">select_size</span><span class="p">]]</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu_w</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">selected_samples</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="c1"># Steps 4-7 are all about cleverly updating the sampling distribution</span>
    <span class="c1"># 4. Compute weighted sample deviations from the old mean</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu_w</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">selected_samples</span> <span class="o">-</span> <span class="n">old_m</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma</span>
    <span class="c1"># 5. Update the covariance matrix</span>
    <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c_1</span> <span class="o">-</span> <span class="n">c_mu</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span> <span class="o">+</span> <span class="n">c_1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">p_c</span><span class="p">,</span> <span class="n">p_c</span><span class="p">)</span>
    <span class="n">C</span> <span class="o">+=</span> <span class="n">c_mu</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">yi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span> <span class="k">for</span> <span class="n">yi</span> <span class="ow">in</span> <span class="n">y</span><span class="p">)</span>
    <span class="c1"># 6. Update the evolution path</span>
    <span class="n">p_c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c_c</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_c</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c_c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">c_c</span><span class="p">)</span> <span class="o">*</span> <span class="n">mu_eff</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">old_m</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma</span>
    <span class="c1"># 7. Adapt the step size sigma</span>
    <span class="n">sigma</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">c_sig</span><span class="o">/</span><span class="n">d_sig</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p_c</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="c1"># 8. Check stopping criteria</span>
    <span class="k">if</span> <span class="n">sigma</span> <span class="o">&lt;</span> <span class="n">sigma_tol</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Stopping due to sigma below threshold."</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">fitness_values</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">fitness_values</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">value_tol</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Stopping due to objective function values convergence."</span><span class="p">)</span>
        <span class="k">break</span>
  <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">mean_scores</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="simulation-optimized-prey-policy-when-the-predator-drifts-randomly">
<h2>Simulation: Optimized Prey Policy When the Predator Drifts Randomly<a class="headerlink" href="#simulation-optimized-prey-policy-when-the-predator-drifts-randomly" title="Permalink to this headline">¶</a></h2>
<p>Here we will optimize the policy of a prey organsims for a fixed (simple) predator policy, using CMA-ES, and then observe the results of our optimization. This optimization process, run in the code cell below takes about 1 minute to run. You can skip this and a canned result will be used in the following code cells. If you want to get a better result, or love watching progress bars, you can let this optimization process run longer by setting <code class="docutils literal notranslate"><span class="pre">max_gen</span></code> to a higher value.</p>
<p><strong>Run this cell</strong> to optimize the prey policy for a drifting predator.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown **Run this cell** to optimize the prey policy for a drifting predator.</span>

<span class="n">game</span> <span class="o">=</span> <span class="n">GridworldGame</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                     <span class="n">num_food</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                     <span class="n">lifetime</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>
<span class="c1"># Initialize players</span>
<span class="n">prey_player_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'critter_index'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'fov_radius'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'speed'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                      <span class="s1">'has_food_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_edge_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                      <span class="s1">'has_prey_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_pred_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">pred_player_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'critter_index'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'fov_radius'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'speed'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                      <span class="s1">'has_food_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_edge_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                      <span class="s1">'has_prey_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_pred_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">prey_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="o">**</span><span class="n">prey_player_params</span><span class="p">)</span>
<span class="n">pred_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="o">**</span><span class="n">pred_player_params</span><span class="p">)</span>
<span class="n">n_prey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">prey_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)</span>
<span class="n">n_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">pred_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">eval_wrapper_for_prey</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
  <span class="n">pred_flat_W</span> <span class="o">=</span> <span class="n">pred_player</span><span class="o">.</span><span class="n">W</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>  <span class="c1"># Using weights for predator</span>
  <span class="n">scores</span> <span class="o">=</span> <span class="n">evaluate_2_types</span><span class="p">(</span>
  <span class="n">prey_player</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">pred_player</span><span class="p">,</span> <span class="n">pred_flat_W</span><span class="p">,</span> <span class="n">game</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">scores</span>

<span class="n">opt_prey_weights</span><span class="p">,</span> <span class="n">prey_cov</span><span class="p">,</span> <span class="n">score_evo</span> <span class="o">=</span> <span class="n">cma_es</span><span class="p">(</span><span class="n">n_prey</span><span class="p">,</span>
                                               <span class="n">eval_wrapper_for_prey</span><span class="p">,</span>
                                               <span class="n">focal_pop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                               <span class="n">max_gen</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pop_size set to: 23.0
mu_w set using skew scheme: [0.26083671 0.18681028 0.1435076  0.11278385 0.08895266 0.06948117
 0.05301825 0.03875742 0.02617848 0.01492623 0.00474734]
mu_eff set to: 6.483721004119788
c_1 set to: 4.3765974580721965e-06
c_mu set to: 0.013681278545838858
c_c set to: 0.005896291466207945
c_sig set to: 0.012340250023271385
d_sig set to: 1.0123402500232714
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 1/50. Mean Scores: [-1.8125, 0.3750]. Elapsed Time: 0.91 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 2/50. Mean Scores: [-1.4402, 0.3696]. Elapsed Time: 1.83 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 3/50. Mean Scores: [-0.9864, 0.2935]. Elapsed Time: 2.75 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 4/50. Mean Scores: [-0.7880, 0.3533]. Elapsed Time: 3.67 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 5/50. Mean Scores: [-1.4266, 0.4158]. Elapsed Time: 4.60 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 6/50. Mean Scores: [-0.8832, 0.3696]. Elapsed Time: 5.53 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 7/50. Mean Scores: [-0.1304, 0.3913]. Elapsed Time: 6.45 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 8/50. Mean Scores: [0.2935, 0.3587]. Elapsed Time: 7.38 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 9/50. Mean Scores: [0.9837, 0.3451]. Elapsed Time: 8.31 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 10/50. Mean Scores: [2.0516, 0.2799]. Elapsed Time: 9.24 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 11/50. Mean Scores: [2.6549, 0.2989]. Elapsed Time: 10.17 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 12/50. Mean Scores: [2.0679, 0.3207]. Elapsed Time: 11.10 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 13/50. Mean Scores: [3.3777, 0.3397]. Elapsed Time: 12.04 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 14/50. Mean Scores: [3.1277, 0.3152]. Elapsed Time: 12.96 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 15/50. Mean Scores: [2.1332, 0.3587]. Elapsed Time: 13.89 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 16/50. Mean Scores: [2.5326, 0.3342]. Elapsed Time: 14.83 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 17/50. Mean Scores: [2.9185, 0.3668]. Elapsed Time: 15.77 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 18/50. Mean Scores: [3.3804, 0.3723]. Elapsed Time: 16.71 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 19/50. Mean Scores: [4.3995, 0.3560]. Elapsed Time: 17.65 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 20/50. Mean Scores: [5.0842, 0.3533]. Elapsed Time: 18.59 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 21/50. Mean Scores: [4.5136, 0.3832]. Elapsed Time: 19.53 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 22/50. Mean Scores: [4.9701, 0.4103]. Elapsed Time: 20.47 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 23/50. Mean Scores: [6.5408, 0.3152]. Elapsed Time: 21.41 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 24/50. Mean Scores: [7.4185, 0.3016]. Elapsed Time: 22.35 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 25/50. Mean Scores: [6.4130, 0.4348]. Elapsed Time: 23.30 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 26/50. Mean Scores: [8.0435, 0.3234]. Elapsed Time: 24.24 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 27/50. Mean Scores: [7.1793, 0.4864]. Elapsed Time: 25.18 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 28/50. Mean Scores: [8.5163, 0.3641]. Elapsed Time: 26.13 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 29/50. Mean Scores: [8.8641, 0.3505]. Elapsed Time: 27.07 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 30/50. Mean Scores: [9.0870, 0.4049]. Elapsed Time: 28.01 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 31/50. Mean Scores: [9.1902, 0.4022]. Elapsed Time: 28.96 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 32/50. Mean Scores: [9.6549, 0.3370]. Elapsed Time: 29.91 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 33/50. Mean Scores: [9.0815, 0.3668]. Elapsed Time: 30.87 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 34/50. Mean Scores: [9.7663, 0.3940]. Elapsed Time: 31.81 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 35/50. Mean Scores: [9.3424, 0.4185]. Elapsed Time: 32.76 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 36/50. Mean Scores: [8.2473, 0.4511]. Elapsed Time: 33.70 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 37/50. Mean Scores: [9.4565, 0.3777]. Elapsed Time: 34.65 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 38/50. Mean Scores: [9.2853, 0.3750]. Elapsed Time: 35.59 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 39/50. Mean Scores: [9.8750, 0.4022]. Elapsed Time: 36.53 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 40/50. Mean Scores: [9.8859, 0.3696]. Elapsed Time: 37.48 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 41/50. Mean Scores: [10.2717, 0.3913]. Elapsed Time: 38.42 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 42/50. Mean Scores: [10.0353, 0.4103]. Elapsed Time: 39.37 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 43/50. Mean Scores: [9.6793, 0.4185]. Elapsed Time: 40.31 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 44/50. Mean Scores: [10.5163, 0.3913]. Elapsed Time: 41.29 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 45/50. Mean Scores: [9.9701, 0.3940]. Elapsed Time: 42.26 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 46/50. Mean Scores: [10.0217, 0.4266]. Elapsed Time: 43.21 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 47/50. Mean Scores: [11.0272, 0.3424]. Elapsed Time: 44.15 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 48/50. Mean Scores: [10.4647, 0.3995]. Elapsed Time: 45.10 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 49/50. Mean Scores: [11.1223, 0.3668]. Elapsed Time: 46.06 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 50/50. Mean Scores: [9.6957, 0.4620]. Elapsed Time: 47.03 seconds
</pre></div>
</div>
</div>
</div>
<p>Now that we have an optimized policy for the prey organism lets see how it behaves by running a simulation in the code cell below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown **Run this cell** to watch a random predator organism play against an optimized prey organism.</span>

<span class="n">main_url</span> <span class="o">=</span> <span class="s2">"https://github.com/dcownden/PerennialProblemsOfLifeWithABrain/raw/main/sequences/P1C2_OptimizationAndEnvironment/data/opt_prey_for_rand_pred.npy"</span>
<span class="n">branch_url</span> <span class="o">=</span> <span class="s2">"https://github.com/dcownden/PerennialProblemsOfLifeWithABrain/raw/P1C2S3_Competition/sequences/P1C2_OptimizationAndEnvironment/data/opt_prey_for_rand_pred.npy"</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">main_url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
  <span class="k">with</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">opt_prey_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Failed to download with status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'Trying next url'</span><span class="p">)</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">branch_url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
      <span class="n">opt_prey_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Failed to download with status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">gwg</span> <span class="o">=</span> <span class="n">GridworldGame</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                    <span class="n">num_pred</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">lifetime</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                    <span class="n">rng</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>


<span class="n">opt_prey_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">has_food_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">has_edge_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_prey_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_pred_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">opt_prey_player</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">opt_prey_weights</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">opt_prey_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)</span>
<span class="n">rand_pred_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">has_food_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">has_edge_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_prey_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_pred_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">opt_prey_igwg</span> <span class="o">=</span> <span class="n">ComplexMoveInteractiveGridworld</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="n">opt_prey_player</span><span class="p">,</span> <span class="n">rand_pred_player</span><span class="p">],</span> <span class="n">critter_names</span><span class="o">=</span><span class="p">[</span><span class="s1">'Prey'</span><span class="p">,</span> <span class="s1">'Pred'</span><span class="p">],</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">has_fov</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">opt_prey_igwg</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">opt_prey_igwg</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">opt_prey_igwg</span><span class="o">.</span><span class="n">final_display</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "c144908150fa42c180831458ca2f1fa5"}
</script></div>
</div>
<p>The prey organism has ‘evolved’ to avoid being eaten and does a pretty good job of eating lots of food despite its limited perceptual field, and efforts to avoid the predator. Now lets look at the reverse situation where the prey organism executes a random drift policy and the predator organism is optimized.</p>
</div>
<div class="section" id="simulation-optimized-predator-policy-when-the-prey-drifts-randomly">
<h2>Simulation: Optimized Predator Policy When the Prey Drifts Randomly<a class="headerlink" href="#simulation-optimized-predator-policy-when-the-prey-drifts-randomly" title="Permalink to this headline">¶</a></h2>
<p>This optimization process also takes about 1 minute to run. You can skip this and a canned result will be used in the subsequent code cells. If you want to get a better result, or love watching progress bars, you can let this optimization process run longer by setting <code class="docutils literal notranslate"><span class="pre">max_gen</span></code> to a higher value.</p>
<p><strong>Run this cell</strong> to optimize the predator policy when the prey drifts.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown **Run this cell** to optimize the predator policy when the prey drifts.</span>

<span class="n">game</span> <span class="o">=</span> <span class="n">GridworldGame</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                     <span class="n">num_food</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                     <span class="n">lifetime</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>
<span class="c1"># Initialize players</span>
<span class="n">prey_player_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'critter_index'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'fov_radius'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'speed'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                      <span class="s1">'has_food_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_edge_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                      <span class="s1">'has_prey_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_pred_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">pred_player_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'critter_index'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'fov_radius'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'speed'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                      <span class="s1">'has_food_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_edge_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                      <span class="s1">'has_prey_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_pred_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">prey_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="o">**</span><span class="n">prey_player_params</span><span class="p">)</span>
<span class="n">pred_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="o">**</span><span class="n">pred_player_params</span><span class="p">)</span>
<span class="n">n_prey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">prey_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)</span>
<span class="n">n_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">pred_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">eval_wrapper_for_pred</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
  <span class="n">prey_flat_W</span> <span class="o">=</span> <span class="n">prey_player</span><span class="o">.</span><span class="n">W</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>  <span class="c1"># Using default weights for predator</span>
  <span class="n">scores</span> <span class="o">=</span> <span class="n">evaluate_2_types</span><span class="p">(</span>
  <span class="n">prey_player</span><span class="p">,</span> <span class="n">prey_flat_W</span><span class="p">,</span> <span class="n">pred_player</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">game</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">scores</span>

<span class="n">opt_pred_weights</span><span class="p">,</span> <span class="n">pred_cov</span><span class="p">,</span> <span class="n">score_evo</span> <span class="o">=</span> <span class="n">cma_es</span><span class="p">(</span><span class="n">n_pred</span><span class="p">,</span>
                                               <span class="n">eval_wrapper_for_pred</span><span class="p">,</span>
                                               <span class="n">focal_pop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                               <span class="n">max_gen</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pop_size set to: 22.0
mu_w set using skew scheme: [0.26083671 0.18681028 0.1435076  0.11278385 0.08895266 0.06948117
 0.05301825 0.03875742 0.02617848 0.01492623 0.00474734]
mu_eff set to: 6.483721004119788
c_1 set to: 8e-06
c_mu set to: 0.01847790209975846
c_c set to: 0.007961827287581304
c_sig set to: 0.016586492699053965
d_sig set to: 1.016586492699054
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 1/50. Mean Scores: [2.4233, 0.2188]. Elapsed Time: 0.81 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 2/50. Mean Scores: [0.9972, 0.3608]. Elapsed Time: 1.64 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 3/50. Mean Scores: [0.7955, 0.3835]. Elapsed Time: 2.46 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 4/50. Mean Scores: [0.2415, 0.4631]. Elapsed Time: 3.29 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 5/50. Mean Scores: [0.0710, 0.4659]. Elapsed Time: 4.12 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 6/50. Mean Scores: [-1.1136, 0.5767]. Elapsed Time: 4.94 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 7/50. Mean Scores: [-1.1165, 0.5881]. Elapsed Time: 5.77 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 8/50. Mean Scores: [-2.8011, 0.7301]. Elapsed Time: 6.60 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 9/50. Mean Scores: [-2.7415, 0.7102]. Elapsed Time: 7.43 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 10/50. Mean Scores: [-3.5795, 0.8267]. Elapsed Time: 8.26 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 11/50. Mean Scores: [-2.7898, 0.7330]. Elapsed Time: 9.09 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 12/50. Mean Scores: [-3.9347, 0.8494]. Elapsed Time: 9.93 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 13/50. Mean Scores: [-3.8750, 0.8494]. Elapsed Time: 10.76 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 14/50. Mean Scores: [-4.3097, 0.8750]. Elapsed Time: 11.60 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 15/50. Mean Scores: [-4.8722, 0.9318]. Elapsed Time: 12.44 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 16/50. Mean Scores: [-4.7102, 0.9375]. Elapsed Time: 13.27 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 17/50. Mean Scores: [-4.9119, 0.9375]. Elapsed Time: 14.10 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 18/50. Mean Scores: [-6.1136, 1.0568]. Elapsed Time: 14.93 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 19/50. Mean Scores: [-5.8750, 1.0398]. Elapsed Time: 15.77 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 20/50. Mean Scores: [-5.3210, 0.9915]. Elapsed Time: 16.61 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 21/50. Mean Scores: [-6.2642, 1.0852]. Elapsed Time: 17.45 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 22/50. Mean Scores: [-5.2443, 0.9773]. Elapsed Time: 18.28 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 23/50. Mean Scores: [-6.2585, 1.0767]. Elapsed Time: 19.12 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 24/50. Mean Scores: [-6.7898, 1.1392]. Elapsed Time: 19.96 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 25/50. Mean Scores: [-6.6761, 1.1165]. Elapsed Time: 20.80 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 26/50. Mean Scores: [-6.6989, 1.1165]. Elapsed Time: 21.64 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 27/50. Mean Scores: [-6.4574, 1.1023]. Elapsed Time: 22.47 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 28/50. Mean Scores: [-8.0057, 1.2557]. Elapsed Time: 23.32 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 29/50. Mean Scores: [-6.5085, 1.1051]. Elapsed Time: 24.16 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 30/50. Mean Scores: [-7.4602, 1.1903]. Elapsed Time: 25.00 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 31/50. Mean Scores: [-7.5511, 1.2159]. Elapsed Time: 25.84 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 32/50. Mean Scores: [-9.0511, 1.3580]. Elapsed Time: 26.67 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 33/50. Mean Scores: [-8.5597, 1.3324]. Elapsed Time: 27.52 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 34/50. Mean Scores: [-10.1619, 1.4744]. Elapsed Time: 28.37 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 35/50. Mean Scores: [-8.5852, 1.3097]. Elapsed Time: 29.22 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 36/50. Mean Scores: [-9.9403, 1.4318]. Elapsed Time: 30.06 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 37/50. Mean Scores: [-9.1250, 1.3608]. Elapsed Time: 30.90 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 38/50. Mean Scores: [-9.7386, 1.4403]. Elapsed Time: 31.74 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 39/50. Mean Scores: [-9.4034, 1.4006]. Elapsed Time: 32.59 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 40/50. Mean Scores: [-10.1080, 1.4659]. Elapsed Time: 33.43 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 41/50. Mean Scores: [-8.3153, 1.2670]. Elapsed Time: 34.27 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 42/50. Mean Scores: [-9.5568, 1.4290]. Elapsed Time: 35.12 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 43/50. Mean Scores: [-10.1420, 1.4716]. Elapsed Time: 35.97 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 44/50. Mean Scores: [-8.0256, 1.2869]. Elapsed Time: 36.81 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 45/50. Mean Scores: [-9.0057, 1.3636]. Elapsed Time: 37.66 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 46/50. Mean Scores: [-9.3523, 1.3892]. Elapsed Time: 38.51 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 47/50. Mean Scores: [-9.4119, 1.3949]. Elapsed Time: 39.37 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 48/50. Mean Scores: [-7.9091, 1.2528]. Elapsed Time: 40.22 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 49/50. Mean Scores: [-8.8494, 1.3267]. Elapsed Time: 41.07 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 50/50. Mean Scores: [-9.1903, 1.3750]. Elapsed Time: 41.92 seconds
</pre></div>
</div>
</div>
</div>
<p>Now that we have an optimized policy for the predator organism, let’s see how it behaves by running simulation in the code cell below.</p>
<p><strong>Run this cell</strong> to watch a random prey organism play against an optimized predator organism.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown **Run this cell** to watch a random prey organism play against an optimized predator organism.</span>

<span class="n">main_url</span> <span class="o">=</span> <span class="s2">"https://github.com/dcownden/PerennialProblemsOfLifeWithABrain/raw/main/sequences/P1C2_OptimizationAndEnvironment/data/opt_pred_for_rand_prey.npy"</span>
<span class="n">branch_url</span> <span class="o">=</span> <span class="s2">"https://github.com/dcownden/PerennialProblemsOfLifeWithABrain/raw/P1C2S3_Competition/sequences/P1C2_OptimizationAndEnvironment/data/opt_pred_for_rand_prey.npy"</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">main_url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
  <span class="k">with</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">opt_pred_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Failed to download with status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'Trying next url'</span><span class="p">)</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">branch_url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
      <span class="n">opt_pred_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Failed to download with status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">gwg</span> <span class="o">=</span> <span class="n">GridworldGame</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                    <span class="n">num_pred</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">lifetime</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                    <span class="n">rng</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>


<span class="n">rand_prey_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">has_food_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">has_edge_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_prey_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_pred_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">opt_pred_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">has_food_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">has_edge_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_prey_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_pred_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">opt_pred_player</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">opt_pred_weights</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">opt_pred_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)</span>

<span class="n">opt_pred_igwg</span> <span class="o">=</span> <span class="n">ComplexMoveInteractiveGridworld</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="n">rand_prey_player</span><span class="p">,</span> <span class="n">opt_pred_player</span><span class="p">],</span> <span class="n">critter_names</span><span class="o">=</span><span class="p">[</span><span class="s1">'Prey'</span><span class="p">,</span> <span class="s1">'Pred'</span><span class="p">],</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">has_fov</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">opt_pred_igwg</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">opt_pred_igwg</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">opt_pred_igwg</span><span class="o">.</span><span class="n">final_display</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "4576a6c2f43c424fa0ece2b51134cfc8"}
</script></div>
</div>
<p>In this scenario as well the predator organism gets better at tracking down and eating the unpredictable prey, even though the prey moves unpredictably and more quickly than the predator. Finally, we are going to look at a simultaneous evolution scenario where both the prey and predator populations constantly co-adapt to each-other.</p>
<p>Submit your feedback</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_M2"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "b617a1526951436f8b33eb1591f59700"}
</script></div>
</div>
</div>
</div>
<div class="section" id="prey-and-predator-co-evolve">
<h1>1.3.3.3: Prey and Predator Co-Evolve<a class="headerlink" href="#prey-and-predator-co-evolve" title="Permalink to this headline">¶</a></h1>
<p>We need to adapt our CMA-ES algo to update both populations, predator and prey, simultaneously.</p>
<p>This is the cma-es algo adapted to work on two populations simultaneously. You don’t need to understand how this code works, but it’s here if you are curious. You do need to <strong>run this cell</strong> for the following optimizations to work.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown This is the cma-es algo adapted to work on two populations simultaneously. You don't need to understand how this code works, but it's here if you are curious. You do need to **run this cell** for the following optimizations to work.</span>

<span class="k">def</span> <span class="nf">two_pop_cma_es</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">eval_func</span><span class="p">,</span> <span class="n">init_m1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">init_m2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">init_C1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">init_C2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">init_sigma1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">init_sigma2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">pop_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">select_frac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">weight_scheme</span><span class="o">=</span><span class="s1">'skew'</span><span class="p">,</span> <span class="c1"># other magic word is flat</span>
                   <span class="n">c_1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c_mu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c_c</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">c_sig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">d_sig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                   <span class="n">max_gen</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">sigma_tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">value_tol</span><span class="o">=-</span><span class="mf">0.0001</span><span class="p">,</span>
                   <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(),</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>

  <span class="c1"># use heuristics to set constants if none provided</span>
  <span class="k">if</span> <span class="n">pop_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">pop_size</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n1</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n2</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"pop_size set to: </span><span class="si">{</span><span class="n">pop_size</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="n">select_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">pop_size</span> <span class="o">*</span> <span class="n">select_frac</span><span class="p">))</span>

  <span class="k">if</span> <span class="n">weight_scheme</span> <span class="o">==</span> <span class="s1">'skew'</span><span class="p">:</span>
    <span class="n">mu_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">select_size</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">select_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
    <span class="n">mu_w</span> <span class="o">=</span> <span class="n">mu_w</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mu_w</span><span class="p">)</span>
    <span class="n">mu_eff</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mu_w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"mu_w set using skew scheme: </span><span class="si">{</span><span class="n">mu_w</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"mu_eff set to: </span><span class="si">{</span><span class="n">mu_eff</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">weight_scheme</span> <span class="o">==</span> <span class="s1">'flat'</span><span class="p">:</span>
    <span class="n">mu_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">select_size</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">select_size</span><span class="p">)</span>
    <span class="n">mu_eff</span> <span class="o">=</span> <span class="n">select_size</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"mu_w set using flat scheme: </span><span class="si">{</span><span class="n">mu_w</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"mu_eff set to: </span><span class="si">{</span><span class="n">mu_eff</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

  <span class="n">n_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">c_1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">c_1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">n_max</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"c_1 set to: </span><span class="si">{</span><span class="n">c_1</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">c_mu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">c_mu</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c_1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">mu_eff</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">mu_eff</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_max</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"c_mu set to: </span><span class="si">{</span><span class="n">c_mu</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">c_c</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">c_c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="n">mu_eff</span><span class="o">/</span><span class="n">n_max</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_max</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">mu_eff</span><span class="o">/</span><span class="n">n_max</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"c_c set to: </span><span class="si">{</span><span class="n">c_c</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">c_sig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">c_sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu_eff</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_max</span> <span class="o">+</span> <span class="n">mu_eff</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"c_sig set to: </span><span class="si">{</span><span class="n">c_sig</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">d_sig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">d_sig</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">c_sig</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">mu_eff</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"d_sig set to: </span><span class="si">{</span><span class="n">d_sig</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

  <span class="c1"># Initialize variables of the process to these defaults if none given</span>
  <span class="k">if</span> <span class="n">init_m1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="n">init_m1</span>
  <span class="k">if</span> <span class="n">init_m2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">init_m2</span>
  <span class="k">if</span> <span class="n">init_C1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="n">init_C1</span>
  <span class="k">if</span> <span class="n">init_C2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">C2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">C2</span> <span class="o">=</span> <span class="n">init_C2</span>
  <span class="k">if</span> <span class="n">init_sigma1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">sigma1</span> <span class="o">=</span> <span class="mf">1.0</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">sigma1</span> <span class="o">=</span> <span class="n">init_sigma1</span>
  <span class="k">if</span> <span class="n">init_sigma2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">sigma2</span> <span class="o">=</span> <span class="mf">1.0</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">sigma2</span> <span class="o">=</span> <span class="n">init_sigma2</span>
  <span class="n">p_c1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
  <span class="n">p_c2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>


  <span class="c1"># Main loop</span>
  <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
  <span class="n">mean_scores_hist</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">gen</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_gen</span><span class="p">):</span>
    <span class="c1"># 1. Sampe params of this generation</span>
    <span class="n">samples1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">sigma1</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">C1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">pop_size</span><span class="p">))</span>
    <span class="n">samples2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">sigma2</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">C2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">pop_size</span><span class="p">))</span>
    <span class="c1"># 2. Evaluate each member of the new population</span>
    <span class="n">fitness_values</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">eval_func</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
                                 <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">samples1</span><span class="p">,</span> <span class="n">samples2</span><span class="p">)])</span>
    <span class="n">sorted_indices1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">fitness_values</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#argsort does low to high, so sort neg</span>
    <span class="n">sorted_indices2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">fitness_values</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#argsort does low to high, so sort neg</span>
    <span class="n">mean_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">fitness_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mean_scores_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_scores</span><span class="p">)</span>
    <span class="c1"># If verbose flag is true, print generation info and mean score</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
      <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Generation </span><span class="si">{</span><span class="n">gen</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">max_gen</span><span class="si">}</span><span class="s2"> | Mean Population Scores: [</span><span class="si">{</span><span class="n">mean_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">mean_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">] | Time Elapsed: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds"</span><span class="p">)</span>
    <span class="c1"># 3. Update mean as a weighted sum of the selected samples</span>
    <span class="n">old_m1</span> <span class="o">=</span> <span class="n">m1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">old_m2</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">selected_samples1</span> <span class="o">=</span> <span class="n">samples1</span><span class="p">[</span><span class="n">sorted_indices1</span><span class="p">[:</span><span class="n">select_size</span><span class="p">]]</span>
    <span class="n">selected_samples2</span> <span class="o">=</span> <span class="n">samples2</span><span class="p">[</span><span class="n">sorted_indices2</span><span class="p">[:</span><span class="n">select_size</span><span class="p">]]</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu_w</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">selected_samples1</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu_w</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">selected_samples2</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="c1"># 4. Compute weighted sample deviations from the old mean</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu_w</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">selected_samples1</span> <span class="o">-</span> <span class="n">old_m1</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma1</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu_w</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">selected_samples2</span> <span class="o">-</span> <span class="n">old_m2</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma2</span>
    <span class="c1"># 5. Update the covariance matrix</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c_1</span> <span class="o">-</span> <span class="n">c_mu</span><span class="p">)</span> <span class="o">*</span> <span class="n">C1</span> <span class="o">+</span> <span class="n">c_1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">p_c1</span><span class="p">,</span> <span class="n">p_c1</span><span class="p">)</span>
    <span class="n">C1</span> <span class="o">+=</span> <span class="n">c_mu</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">yi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span> <span class="k">for</span> <span class="n">yi</span> <span class="ow">in</span> <span class="n">y1</span><span class="p">)</span>
    <span class="n">C2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c_1</span> <span class="o">-</span> <span class="n">c_mu</span><span class="p">)</span> <span class="o">*</span> <span class="n">C2</span> <span class="o">+</span> <span class="n">c_1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">p_c2</span><span class="p">,</span> <span class="n">p_c2</span><span class="p">)</span>
    <span class="n">C2</span> <span class="o">+=</span> <span class="n">c_mu</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">yi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span> <span class="k">for</span> <span class="n">yi</span> <span class="ow">in</span> <span class="n">y2</span><span class="p">)</span>
    <span class="c1"># 6. Update the evolution path</span>
    <span class="n">p_c1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c_c</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_c1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c_c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">c_c</span><span class="p">)</span> <span class="o">*</span> <span class="n">mu_eff</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">m1</span> <span class="o">-</span> <span class="n">old_m1</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma1</span>
    <span class="n">p_c2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c_c</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_c2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c_c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">c_c</span><span class="p">)</span> <span class="o">*</span> <span class="n">mu_eff</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">m2</span> <span class="o">-</span> <span class="n">old_m2</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma2</span>
    <span class="c1"># 7. Adapt the step size sigma</span>
    <span class="n">sigma1</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">c_sig</span><span class="o">/</span><span class="n">d_sig</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p_c1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">sigma2</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">c_sig</span><span class="o">/</span><span class="n">d_sig</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p_c2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="c1"># 8. Check stopping criteria</span>
    <span class="k">if</span> <span class="n">sigma1</span> <span class="o">&lt;</span> <span class="n">sigma_tol</span> <span class="ow">and</span> <span class="n">sigma2</span> <span class="o">&lt;</span> <span class="n">sigma_tol</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Stopping due to sigma below threshold."</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">fitness_values</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">fitness_values</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">value_tol</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Stopping due to objective function values convergence."</span><span class="p">)</span>
        <span class="k">break</span>
  <span class="k">return</span> <span class="n">m1</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">mean_scores_hist</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="simulation-co-optimized-prey-and-predator-policies">
<h2>Simulation: Co-Optimized Prey and Predator Policies<a class="headerlink" href="#simulation-co-optimized-prey-and-predator-policies" title="Permalink to this headline">¶</a></h2>
<p>This next code cell runs the two population, simultaneous optimization process and takes about 3 minutes to run. You can skip this and a pre-canned result will be used in the subsequent code cells. If you want to get a better result, or love watching progress bars, you can let this optimization process run longer by setting <code class="docutils literal notranslate"><span class="pre">max_gen</span></code> to a higher value.</p>
<p><strong>Run this cell</strong> to co-optimize the prey and predator policies.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown **Run this cell** to co-optimize the prey and predator policies.</span>

<span class="n">game</span> <span class="o">=</span> <span class="n">GridworldGame</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                     <span class="n">num_food</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_pred</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                     <span class="n">lifetime</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>
<span class="c1"># Initialize players</span>
<span class="n">prey_player_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'critter_index'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'fov_radius'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'speed'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                      <span class="s1">'has_food_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_edge_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                      <span class="s1">'has_prey_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_pred_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">pred_player_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'critter_index'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'fov_radius'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'speed'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                      <span class="s1">'has_food_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_edge_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                      <span class="s1">'has_prey_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">'has_pred_percept'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">prey_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="o">**</span><span class="n">prey_player_params</span><span class="p">)</span>
<span class="n">pred_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="o">**</span><span class="n">pred_player_params</span><span class="p">)</span>
<span class="n">n_prey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">prey_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)</span>
<span class="n">n_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">pred_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">dual_eval_wrapper</span><span class="p">(</span><span class="n">params1</span><span class="p">,</span> <span class="n">params2</span><span class="p">):</span>
  <span class="n">scores</span> <span class="o">=</span> <span class="n">evaluate_2_types</span><span class="p">(</span>
  <span class="n">prey_player</span><span class="p">,</span> <span class="n">params1</span><span class="p">,</span> <span class="n">pred_player</span><span class="p">,</span> <span class="n">params2</span><span class="p">,</span> <span class="n">game</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">scores</span>


<span class="p">(</span><span class="n">co_opt_prey_weights</span><span class="p">,</span> <span class="n">co_prey_cov</span><span class="p">,</span>
 <span class="n">co_opt_pred_weights</span><span class="p">,</span> <span class="n">co_pred_cov</span><span class="p">,</span>
 <span class="n">co_score_evo</span><span class="p">)</span> <span class="o">=</span> <span class="n">two_pop_cma_es</span><span class="p">(</span><span class="n">n_prey</span><span class="p">,</span> <span class="n">n_pred</span><span class="p">,</span>
                                <span class="n">dual_eval_wrapper</span><span class="p">,</span>
                                <span class="n">max_gen</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pop_size set to: 45.0
mu_w set using skew scheme: [0.15547244 0.12086035 0.10061357 0.08624825 0.07510565 0.06600148
 0.05830401 0.05163616 0.0457547  0.04049355 0.03573427 0.03138938
 0.02739247 0.02369192 0.02024678 0.01702407 0.01399679 0.01114261
 0.00844278 0.00588146 0.00344514 0.00112218]
mu_eff set to: 12.368677753041624
c_1 set to: 4.3765974580721965e-06
c_mu set to: 0.030824563831512487
c_c set to: 0.005908942103531939
c_sig set to: 0.020722998044280478
d_sig set to: 1.0207229980442805
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 1/25 | Mean Population Scores: [0.4097, 0.0861] | Time Elapsed: 1.60 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 2/25 | Mean Population Scores: [0.3278, 0.1236] | Time Elapsed: 3.25 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 3/25 | Mean Population Scores: [-0.0889, 0.1903] | Time Elapsed: 4.89 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 4/25 | Mean Population Scores: [-0.1819, 0.2069] | Time Elapsed: 6.53 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 5/25 | Mean Population Scores: [-0.1375, 0.2528] | Time Elapsed: 8.20 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 6/25 | Mean Population Scores: [0.0569, 0.2667] | Time Elapsed: 9.86 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 7/25 | Mean Population Scores: [0.3681, 0.2278] | Time Elapsed: 11.54 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 8/25 | Mean Population Scores: [-0.2472, 0.3736] | Time Elapsed: 13.23 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 9/25 | Mean Population Scores: [-0.2444, 0.3972] | Time Elapsed: 14.93 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 10/25 | Mean Population Scores: [0.8097, 0.3500] | Time Elapsed: 16.71 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 11/25 | Mean Population Scores: [1.3833, 0.3319] | Time Elapsed: 18.41 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 12/25 | Mean Population Scores: [1.7764, 0.3639] | Time Elapsed: 20.11 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 13/25 | Mean Population Scores: [2.1861, 0.3958] | Time Elapsed: 21.82 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 14/25 | Mean Population Scores: [2.8250, 0.3722] | Time Elapsed: 23.54 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 15/25 | Mean Population Scores: [4.5264, 0.3486] | Time Elapsed: 25.27 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 16/25 | Mean Population Scores: [5.4056, 0.2917] | Time Elapsed: 26.99 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 17/25 | Mean Population Scores: [5.2083, 0.3806] | Time Elapsed: 28.72 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 18/25 | Mean Population Scores: [5.4667, 0.3764] | Time Elapsed: 30.47 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 19/25 | Mean Population Scores: [5.8528, 0.3986] | Time Elapsed: 32.21 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 20/25 | Mean Population Scores: [4.3569, 0.5903] | Time Elapsed: 33.95 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 21/25 | Mean Population Scores: [4.4528, 0.5639] | Time Elapsed: 35.70 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 22/25 | Mean Population Scores: [4.8597, 0.4667] | Time Elapsed: 37.45 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 23/25 | Mean Population Scores: [3.9194, 0.6389] | Time Elapsed: 39.21 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 24/25 | Mean Population Scores: [3.8278, 0.6639] | Time Elapsed: 40.97 seconds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generation 25/25 | Mean Population Scores: [3.2931, 0.7472] | Time Elapsed: 42.74 seconds
</pre></div>
</div>
</div>
</div>
<p>Now that we have co-optimized policies for the prey and predator we can observe what behaviour is like in this scenario.</p>
<p><strong>Run this cell</strong> to watch a co-adapted prey and predator organism play each other.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown **Run this cell** to watch a co-adapted prey and predator organism play each other.</span>

<span class="c1"># get prey weights</span>
<span class="n">main_url</span> <span class="o">=</span> <span class="s2">"https://github.com/dcownden/PerennialProblemsOfLifeWithABrain/raw/main/sequences/P1C2_OptimizationAndEnvironment/data/co_opt_prey_W.npy"</span>
<span class="n">branch_url</span> <span class="o">=</span> <span class="s2">"https://github.com/dcownden/PerennialProblemsOfLifeWithABrain/raw/P1C2S3_Competition/sequences/P1C2_OptimizationAndEnvironment/data/co_opt_prey_W.npy"</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">main_url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
  <span class="k">with</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">co_opt_prey_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Failed to download with status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'Trying next url'</span><span class="p">)</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">branch_url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
      <span class="n">co_opt_prey_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Failed to download with status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># get pred weights</span>
<span class="n">main_url</span> <span class="o">=</span> <span class="s2">"https://github.com/dcownden/PerennialProblemsOfLifeWithABrain/raw/main/sequences/P1C2_OptimizationAndEnvironment/data/co_opt_pred_W.npy"</span>
<span class="n">branch_url</span> <span class="o">=</span> <span class="s2">"https://github.com/dcownden/PerennialProblemsOfLifeWithABrain/raw/P1C2S3_Competition/sequences/P1C2_OptimizationAndEnvironment/data/co_opt_pred_W.npy"</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">main_url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
  <span class="k">with</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">co_opt_pred_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Failed to download with status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'Trying next url'</span><span class="p">)</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">branch_url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
      <span class="n">co_opt_pred_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Failed to download with status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">gwg</span> <span class="o">=</span> <span class="n">GridworldGame</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                    <span class="n">num_pred</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_prey</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_food</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">lifetime</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                    <span class="n">rng</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>

<span class="n">co_opt_prey_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">has_food_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">has_edge_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_prey_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_pred_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">co_opt_prey_player</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">co_opt_prey_weights</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">co_opt_prey_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)</span>

<span class="n">co_opt_pred_player</span> <span class="o">=</span> <span class="n">GeneralLinearPlayer</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">critter_index</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fov_radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">has_food_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">has_edge_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_prey_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_pred_percept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">co_opt_pred_player</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">co_opt_pred_weights</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">co_opt_pred_player</span><span class="o">.</span><span class="n">W_shape</span><span class="p">)</span>

<span class="n">co_opt_igwg</span> <span class="o">=</span> <span class="n">ComplexMoveInteractiveGridworld</span><span class="p">(</span>
    <span class="n">gwg</span><span class="p">,</span> <span class="n">players</span><span class="o">=</span><span class="p">[</span><span class="n">co_opt_prey_player</span><span class="p">,</span> <span class="n">co_opt_pred_player</span><span class="p">],</span> <span class="n">critter_names</span><span class="o">=</span><span class="p">[</span><span class="s1">'Prey'</span><span class="p">,</span> <span class="s1">'Pred'</span><span class="p">],</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">has_fov</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fov_opaque</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">co_opt_igwg</span><span class="o">.</span><span class="n">b_fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">co_opt_igwg</span><span class="o">.</span><span class="n">b_fig_legend</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">co_opt_igwg</span><span class="o">.</span><span class="n">final_display</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "3925268701bb42888e53392f19a962ac"}
</script></div>
</div>
<p>The predator organism, with its slower movement, can not directly chase down the faster prey. To successfully hunt, the predator must stay out of the prey’s field of view, hoping that the prey will move within striking distance. Meanwhile, the prey organism faces its own challenges, constantly deciding between two conflicting approaches:</p>
<ol class="simple">
<li><p>Slow, cautious movement that reduces food intake but minimizes the risk of being preyed upon.</p></li>
<li><p>Quick, recklessly optimistic movement that boosts food consumption but increases vulnerability to predators.</p></li>
</ol>
<p>Note that relative predation risks depend critically on the predator’s policy. The resulting equilibrium from such an evolutionary tug-of-war is a set of policies where no single policy can unilaterally improve its outcome. In game theory, this stable state of the system—based on game payoffs—is termed a Nash Equilibrium. (In Game Theory the term “strategies” is typically used instead of policy, but we will continue to use “policy” in line with standard reinforcement learning terminology.)</p>
<p>A few clarifications are necessary about what this Nash Equilibrium is not:</p>
<ol class="simple">
<li><p>A set of policies maximizing the prey’s score—prey would fare much better against less skilled predators.</p></li>
<li><p>The best set of policies for the predator; they’d have higher success rates against less evasive prey.</p></li>
<li><p>The set of policies optimizing the average payoff across both populations.</p></li>
</ol>
<p>It’s due to such nuances that we say evolution doesn’t “optimize” in a traditional sense. However, a Nash Equilibrium is a set of policies that are the “best response” to the each other. In this sense, evolutionary outcomes can be thought of as “optimal.”</p>
<p>In Sequence 1.2.3, we explored the idea that optima depict an ideal state. The concept of equilibria, as illustrated here, extends and refines this notion. While our world remains in perpetual change, the underlying evolutionary dynamics constantly steer systems towards these “mutual best response” equilibrium points.</p>
</div>
<hr class="docutils"/>
<div class="section" id="todo-bio-box-evolutionarily-stable-strategy-ess-refines-nash-equilibria-for-evolutionary-settings">
<h2><strong>TODO</strong> Bio Box: Evolutionarily Stable Strategy (ESS) Refines Nash Equilibria for Evolutionary Settings.<a class="headerlink" href="#todo-bio-box-evolutionarily-stable-strategy-ess-refines-nash-equilibria-for-evolutionary-settings" title="Permalink to this headline">¶</a></h2>
<p>To be properly applicable to evolutionary settings, the idea of the Nash Equilibrium (every strategy is a best respose to every other strategy) needs to be slightly refined. …</p>
<hr class="docutils"/>
<p>This concludes our exploration of how competition and interaction introduce complexities into optimization. While evolutionary processes are more than just optimization processes, as we progress in this book, we’ll primarily sidestep these game-theoretic considerations. Our primary take-away is that because living organisms are embedded in such evolutionary systems, which inherently drive change, there are selective pressures not just for adaptation to changing environments but <em><strong>rapid</strong></em> adaptation. In the next sequence we will see how within lifetime learning can play an integral role in adapting to rapidly changing environments.</p>
<p>Submit your feedback</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_M3"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "c1f0507712da4b3f8930260a7fdc5fce"}
</script></div>
</div>
</div>
</div>
<div class="section" id="quiz">
<h1>Quiz<a class="headerlink" href="#quiz" title="Permalink to this headline">¶</a></h1>
<p><strong>Run this cell</strong> to take the quiz</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown **Run this cell** to take the quiz</span>
<span class="n">comprehension_quiz</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">"question"</span><span class="p">:</span> <span class="s2">"What overarching principles was illustrated in these evolutionary Gridworld simulation?"</span><span class="p">,</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"multiple_choice"</span><span class="p">,</span>
    <span class="s2">"answers"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">"answer"</span><span class="p">:</span> <span class="s2">"Static behaviours result in predictable outcomes."</span><span class="p">,</span>
        <span class="s2">"correct"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">"feedback"</span><span class="p">:</span> <span class="s2">"While this is sometimes true, these simulations were primarily about adaptive and evolving behaviours."</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">"answer"</span><span class="p">:</span> <span class="s2">"Organisms constantly adapt their behaviours in response to their environment and other organisms."</span><span class="p">,</span>
        <span class="s2">"correct"</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">"feedback"</span><span class="p">:</span> <span class="s2">"Exactly! The predator-prey dynamic in the Gridworld simulation demonstrates the continuous adaptation of behaviors in response to both environmental and inter-organismal factors."</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">"answer"</span><span class="p">:</span> <span class="s2">"Organisms with faster movement are always dominant in their environment."</span><span class="p">,</span>
        <span class="s2">"correct"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">"feedback"</span><span class="p">:</span> <span class="s2">"Speed might be advantageous, but adaptation and strategy can often overcome sheer speed."</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">"answer"</span><span class="p">:</span> <span class="s2">"Evolutionary outcomes are entirely random and lack predictability."</span><span class="p">,</span>
        <span class="s2">"correct"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">"feedback"</span><span class="p">:</span> <span class="s2">"While there might be elements of randomness, evolutionary outcomes are largely driven by environmental pressures and are not entirely random."</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">"question"</span><span class="p">:</span> <span class="s2">"What is a primary goal of using evolutionary strategies like CMA-ES in optimization problems?"</span><span class="p">,</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"multiple_choice"</span><span class="p">,</span>
    <span class="s2">"answers"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">"answer"</span><span class="p">:</span> <span class="s2">"To maintain a static solution throughout iterations."</span><span class="p">,</span>
        <span class="s2">"correct"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">"feedback"</span><span class="p">:</span> <span class="s2">"Evolutionary strategies aim to adapt and refine solutions, not keep them static."</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">"answer"</span><span class="p">:</span> <span class="s2">"To iteratively refine solutions, increasing the likelihood of better outcomes over time."</span><span class="p">,</span>
        <span class="s2">"correct"</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">"feedback"</span><span class="p">:</span> <span class="s2">"Correct! Evolutionary strategies like CMA-ES work iteratively, refining solutions to yield better outcomes as they progress."</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">"answer"</span><span class="p">:</span> <span class="s2">"To always ensure a perfect solution in the first iteration."</span><span class="p">,</span>
        <span class="s2">"correct"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">"feedback"</span><span class="p">:</span> <span class="s2">"Evolutionary strategies work over multiple iterations and don't guarantee perfection in the first attempt."</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">"answer"</span><span class="p">:</span> <span class="s2">"To decrease the randomness in evolutionary algorithms."</span><span class="p">,</span>
        <span class="s2">"correct"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">"feedback"</span><span class="p">:</span> <span class="s2">"While they refine solutions, evolutionary strategies still incorporate randomness or stochastic processes to discover optimal solutions."</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">"question"</span><span class="p">:</span> <span class="s2">"When both prey and predator populations are allowed to evolve simultaneously, this process of mutual adaptation can best be described as:"</span><span class="p">,</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"multiple_choice"</span><span class="p">,</span>
    <span class="s2">"answers"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">"answer"</span><span class="p">:</span> <span class="s2">"Mono-evolution, where only one species evolves while the other remains static."</span><span class="p">,</span>
        <span class="s2">"correct"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">"feedback"</span><span class="p">:</span> <span class="s2">"Mono-evolution implies evolution in isolation, which is not the case here."</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">"answer"</span><span class="p">:</span> <span class="s2">"Static evolution, where both species remain unchanged despite environmental pressures."</span><span class="p">,</span>
        <span class="s2">"correct"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">"feedback"</span><span class="p">:</span> <span class="s2">"Static evolution doesn't capture the essence of mutual adaptation observed in the discussed scenario."</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">"answer"</span><span class="p">:</span> <span class="s2">"Co-evolution, where both species undergo evolutionary adjustments in response to each other."</span><span class="p">,</span>
        <span class="s2">"correct"</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">"feedback"</span><span class="p">:</span> <span class="s2">"Exactly! Co-evolution refers to the process where two or more species reciprocally affect each other's evolution."</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">"answer"</span><span class="p">:</span> <span class="s2">"Random evolution, where changes in species are entirely unpredictable and lack direction."</span><span class="p">,</span>
        <span class="s2">"correct"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">"feedback"</span><span class="p">:</span> <span class="s2">"The process described is systematic and driven by environmental and interspecies dynamics, not entirely random."</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">]</span>



<span class="n">display_quiz</span><span class="p">(</span><span class="n">comprehension_quiz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div data-maxwidth="600" data-numquestions="1000000" data-preserveresponses="false" data-shuffleanswers="True" data-shufflequestions="False" id="zOIrpOcCEKeu" style="border-radius: 10px; text-align: left"> <style>
#zOIrpOcCEKeu {
   --jq-multiple-choice-bg: #6f78ffff;
   --jq-mc-button-bg: #fafafa;
   --jq-mc-button-border: #e0e0e0e0;
   --jq-mc-button-inset-shadow: #555555;
   --jq-many-choice-bg: #f75c03ff;
   --jq-numeric-bg: #392061ff;
   --jq-numeric-input-bg: #c0c0c0;
   --jq-numeric-input-label: #101010;
   --jq-numeric-input-shadow: #999999;
   --jq-incorrect-color: #c80202;
   --jq-correct-color: #009113;
   --jq-text-color: #fafafa;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 15px;
    padding-bottom: 4px;
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
    border-radius: inherit;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Answer {
    margin: 10px 0;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-gap: 10px;
    border-radius: inherit;
}

.Feedback {
    font-size: 16pt;
    text-align: center;
    min-height: 2em;
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: 140px;
    background-color: var(--jq-numeric-input-bg);
    color: var(--jq-text-color);
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    outline: none;
    background-color: var(--jq-numeric-input-bg);
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem var(--jq-numeric-input-shadow);
}

.MCButton {
    background: var(--jq-mc-button-bg);
    border: 1px solid var(--jq-mc-button-border);
    border-radius: inherit;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--jq-multiple-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--jq-many-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn {
    padding: 10px;
    background: var(--jq-numeric-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn p {
    color: inherit;
}

.InpLabel {
    line-height: 34px;
    float: left;
    margin-right: 10px;
    color: var(--jq-numeric-input-label);
    font-size: 15pt;
}

.incorrect {
    color: var(--jq-incorrect-color);
}

.correct {
    color: var(--jq-correct-color);
}

.correctButton {
    /*
    background: var(--jq-correct-color);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--jq-incorrect-color);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--jq-correct-color);
    }
}
</style></div><script type="application/javascript">var questionszOIrpOcCEKeu=[{"question": "What overarching principles was illustrated in these evolutionary Gridworld simulation?", "type": "multiple_choice", "answers": [{"answer": "Static behaviours result in predictable outcomes.", "correct": false, "feedback": "While this is sometimes true, these simulations were primarily about adaptive and evolving behaviours."}, {"answer": "Organisms constantly adapt their behaviours in response to their environment and other organisms.", "correct": true, "feedback": "Exactly! The predator-prey dynamic in the Gridworld simulation demonstrates the continuous adaptation of behaviors in response to both environmental and inter-organismal factors."}, {"answer": "Organisms with faster movement are always dominant in their environment.", "correct": false, "feedback": "Speed might be advantageous, but adaptation and strategy can often overcome sheer speed."}, {"answer": "Evolutionary outcomes are entirely random and lack predictability.", "correct": false, "feedback": "While there might be elements of randomness, evolutionary outcomes are largely driven by environmental pressures and are not entirely random."}]}, {"question": "What is a primary goal of using evolutionary strategies like CMA-ES in optimization problems?", "type": "multiple_choice", "answers": [{"answer": "To maintain a static solution throughout iterations.", "correct": false, "feedback": "Evolutionary strategies aim to adapt and refine solutions, not keep them static."}, {"answer": "To iteratively refine solutions, increasing the likelihood of better outcomes over time.", "correct": true, "feedback": "Correct! Evolutionary strategies like CMA-ES work iteratively, refining solutions to yield better outcomes as they progress."}, {"answer": "To always ensure a perfect solution in the first iteration.", "correct": false, "feedback": "Evolutionary strategies work over multiple iterations and don't guarantee perfection in the first attempt."}, {"answer": "To decrease the randomness in evolutionary algorithms.", "correct": false, "feedback": "While they refine solutions, evolutionary strategies still incorporate randomness or stochastic processes to discover optimal solutions."}]}, {"question": "When both prey and predator populations are allowed to evolve simultaneously, this process of mutual adaptation can best be described as:", "type": "multiple_choice", "answers": [{"answer": "Mono-evolution, where only one species evolves while the other remains static.", "correct": false, "feedback": "Mono-evolution implies evolution in isolation, which is not the case here."}, {"answer": "Static evolution, where both species remain unchanged despite environmental pressures.", "correct": false, "feedback": "Static evolution doesn't capture the essence of mutual adaptation observed in the discussed scenario."}, {"answer": "Co-evolution, where both species undergo evolutionary adjustments in response to each other.", "correct": true, "feedback": "Exactly! Co-evolution refers to the process where two or more species reciprocally affect each other's evolution."}, {"answer": "Random evolution, where changes in species are entirely unpredictable and lack direction.", "correct": false, "feedback": "The process described is systematic and driven by environmental and interspecies dynamics, not entirely random."}]}];
    // Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;

    //console.log(answers);


    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);




    if (fb.dataset.numcorrect == 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses
        
        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else {
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.textContent = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.textContent = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}

function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {
    var shuffled;
    if (shuffle_answers == "True") {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;



    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            var sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            var precision = ths.dataset.precision;
            // console.log("1:", submission)
            submission = Math.round((1 * submission + Number.EPSILON) * 10 ** precision) / 10 ** precision;
            // console.log("Rounded to ", submission, " precision=", precision  );
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.textContent = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                if (submission == answer.value) {
                    if ("feedback" in answer) {
                        fb.textContent = jaxify(answer.feedback);
                    } else {
                        fb.textContent = jaxify("Correct");
                    }
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                //console.log(answer.range);
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                defaultFB = answer.feedback;
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        return false;
    }

}

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            var parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        var edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.textContent = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
function jaxify(string) {
    var mystring = string;

    var count = 0;
    var loc = mystring.search(/([^\\]|^)(\$)/);

    var count2 = 0;
    var loc2 = mystring.search(/([^\\]|^)(\$\$)/);

    //console.log(loc);

    while ((loc >= 0) || (loc2 >= 0)) {

        /* Have to replace all the double $$ first with current implementation */
        if (loc2 >= 0) {
            if (count2 % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\[");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\]");
            }
            count2++;
        } else {
            if (count % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\(");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\)");
            }
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
        //console.log(mystring,", loc:",loc,", loc2:",loc2);
    }

    //console.log(mystring);
    return mystring;
}


function show_questions(json, mydiv) {
    console.log('show_questions');
    //var mydiv=document.getElementById(myid);
    var shuffle_questions = mydiv.dataset.shufflequestions;
    var num_questions = mydiv.dataset.numquestions;
    var shuffle_answers = mydiv.dataset.shuffleanswers;
    var max_width = mydiv.dataset.maxwidth;

    if (num_questions > json.length) {
        num_questions = json.length;
    }

    var questions;
    if ((num_questions < json.length) || (shuffle_questions == "True")) {
        //console.log(num_questions+","+json.length);
        questions = getRandomSubarray(json, num_questions);
    } else {
        questions = json;
    }

    //console.log("SQ: "+shuffle_questions+", NQ: " + num_questions + ", SA: ", shuffle_answers);

    // Iterate over questions
    questions.forEach((qa, index, array) => {
        //console.log(qa.question); 

        var id = makeid(8);
        //console.log(id);


        // Create Div to contain question and answers
        var iDiv = document.createElement('div');
        //iDiv.id = 'quizWrap' + id + index;
        iDiv.id = 'quizWrap' + id;
        iDiv.className = 'Quiz';
        iDiv.setAttribute('data-qnum', index);
        iDiv.style.maxWidth  =max_width+"px";
        mydiv.appendChild(iDiv);
        // iDiv.innerHTML=qa.question;
        
        var outerqDiv = document.createElement('div');
        outerqDiv.id = "OuterquizQn" + id + index;
        // Create div to contain question part
        var qDiv = document.createElement('div');
        qDiv.id = "quizQn" + id + index;
        
        if (qa.question) {
            iDiv.append(outerqDiv);

            //qDiv.textContent=qa.question;
            qDiv.innerHTML = jaxify(qa.question);
            outerqDiv.append(qDiv);
        }

        // Create div for code inside question
        var codeDiv;
        if ("code" in qa) {
            codeDiv = document.createElement('div');
            codeDiv.id = "code" + id + index;
            codeDiv.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeDiv.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = qa.code;
            outerqDiv.append(codeDiv);
            //console.log(codeDiv);
        }


        // Create div to contain answer part
        var aDiv = document.createElement('div');
        aDiv.id = "quizAns" + id + index;
        aDiv.className = 'Answer';
        iDiv.append(aDiv);

        //console.log(qa.type);

        var num_correct;
        if ((qa.type == "multiple_choice") || (qa.type == "many_choice") ) {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
            if ("answer_cols" in qa) {
                //aDiv.style.gridTemplateColumns = 'auto '.repeat(qa.answer_cols);
                aDiv.style.gridTemplateColumns = 'repeat(' + qa.answer_cols + ', 1fr)';
            }
        } else if (qa.type == "numeric") {
            //console.log("numeric");
            make_numeric(qa, outerqDiv, qDiv, aDiv, id);
        }


        //Make div for feedback
        var fb = document.createElement("div");
        fb.id = "fb" + id;
        //fb.style="font-size: 20px;text-align:center;";
        fb.className = "Feedback";
        fb.setAttribute("data-answeredcorrect", 0);
        fb.setAttribute("data-numcorrect", num_correct);
        iDiv.append(fb);


    });
    var preserveResponses = mydiv.dataset.preserveresponses;
    console.log(preserveResponses);
    console.log(preserveResponses == "true");
    if (preserveResponses == "true") {
        console.log(preserveResponses);
        // Create Div to contain record of answers
        var iDiv = document.createElement('div');
        iDiv.id = 'responses' + mydiv.id;
        iDiv.className = 'JCResponses';
        // Create a place to store responses as an empty array
        iDiv.setAttribute('data-responses', '[]');

        // Dummy Text
        iDiv.innerHTML="<b>Select your answers and then follow the directions that will appear here.</b>"
        //iDiv.className = 'Quiz';
        mydiv.appendChild(iDiv);
    }
//console.log("At end of show_questions");
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            } else {
                console.log("MathJax not found");
            }
        }
    }
    return false;
}
/* This is to handle asynchrony issues in loading Jupyter notebooks
           where the quiz has been previously run. The Javascript was generally
           being run before the div was added to the DOM. I tried to do this
           more elegantly using Mutation Observer, but I didn't get it to work.

           Someone more knowledgeable could make this better ;-) */

        function try_show() {
          if(document.getElementById("zOIrpOcCEKeu")) {
            show_questions(questionszOIrpOcCEKeu,  zOIrpOcCEKeu); 
          } else {
             setTimeout(try_show, 200);
          }
        };
    
        {
        // console.log(element);

        //console.log("zOIrpOcCEKeu");
        // console.log(document.getElementById("zOIrpOcCEKeu"));

        try_show();
        }
        </script></div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"d994c8a56ad24bb89189a000f63f67c2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "22.0em", "min_height": "10.0em", "min_width": "21.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "21.0em"}}, "99b3c93f496f42ad9b5cb15b3b338680": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d994c8a56ad24bb89189a000f63f67c2", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Click a button to start playing\n"}]}}, "bb2ddbbcdce943a981fd97f6a953bc99": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "18.8em", "min_height": "6.3em", "min_width": "12.5em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "124d5167ea594ce48f9f7755fb1879f7": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_bb2ddbbcdce943a981fd97f6a953bc99", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "                P1    P2\n--------------  ----  ----\nHigh Score:     --    --\nLast Score:     --    --\nAverage Score:  --    --\n"}]}}, "bfd804e697ff4efe90ace2787a0984bf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": "18.8em", "min_width": "25.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9d90d82a3930484391ac1f1585831183": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_bfd804e697ff4efe90ace2787a0984bf", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.core.display.Markdown object>", "text/markdown": "**Observations**"}}, {"output_type": "error", "ename": "AttributeError", "evalue": "'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'", "traceback": ["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m", "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)", "Cell \u001b[0;32mIn[1], line 3940\u001b[0m, in \u001b[0;36mComplexMoveInteractiveGridworld.__init__\u001b[0;34m(self, gridworld_game, init_board, has_fov, radius, fov_opaque, collect_fov_data, figsize, critter_names, players)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m-> 3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[1;32m   3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "Cell \u001b[0;32mIn[1], line 3941\u001b[0m, in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m   3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[0;32m-> 3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfov_eat_table_data\u001b[49m[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "\u001b[0;31mAttributeError\u001b[0m: 'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'"]}]}}, "b2d46884520748f2964f28420b61c514": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "44300459467943eb854b3a4e71f3e3c6": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "0f09f244d0624b87b7ff5ef1098711eb": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Up", "disabled": true, "icon": "", "layout": "IPY_MODEL_b2d46884520748f2964f28420b61c514", "style": "IPY_MODEL_44300459467943eb854b3a4e71f3e3c6", "tooltip": ""}}, "12160b19ca7c45e58fd0b095e656c646": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "2bacd2f455ef4fb885589570c9671694": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "87a650ca6eda46288d9ba0afee729b11": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Down", "disabled": true, "icon": "", "layout": "IPY_MODEL_12160b19ca7c45e58fd0b095e656c646", "style": "IPY_MODEL_2bacd2f455ef4fb885589570c9671694", "tooltip": ""}}, "3795762471b7449abc976e674d9c84ed": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "c42f2332f58944568f1a5aee56a8bd8f": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "6b2f00587c094f0884f886eb87139ad6": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Left", "disabled": true, "icon": "", "layout": "IPY_MODEL_3795762471b7449abc976e674d9c84ed", "style": "IPY_MODEL_c42f2332f58944568f1a5aee56a8bd8f", "tooltip": ""}}, "18b5369242b8415baa9d3497569942ad": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "c3944ab6370e43eb995711cae306964b": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "64d6b307b0e24669a8b43c7364fb27ce": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Right", "disabled": true, "icon": "", "layout": "IPY_MODEL_18b5369242b8415baa9d3497569942ad", "style": "IPY_MODEL_c3944ab6370e43eb995711cae306964b", "tooltip": ""}}, "b94550e15c8e4b1693b24f5d60773e3b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cf4325e1e8b943a3a2528593e1b52438": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "2fb89bf4df6e41418bd202601f23bfd2": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "First Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_b94550e15c8e4b1693b24f5d60773e3b", "style": "IPY_MODEL_cf4325e1e8b943a3a2528593e1b52438"}}, "e4c948dd1dd248a2ae678b3047b7a3e3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cde6ed15298448599c42115787dbc72c": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "106220994c0945008e3043ad164c0033": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "Second Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_e4c948dd1dd248a2ae678b3047b7a3e3", "style": "IPY_MODEL_cde6ed15298448599c42115787dbc72c"}}, "9feb2edcc8b243de9a099c46f0ee8f1f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "61a8fe4276de4cc78909d964ddf25618": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "baf5995595b94846953e68945140f1ba": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Confirm Move", "disabled": false, "icon": "", "layout": "IPY_MODEL_9feb2edcc8b243de9a099c46f0ee8f1f", "style": "IPY_MODEL_61a8fe4276de4cc78909d964ddf25618", "tooltip": ""}}, "f99d87d39f964aefab130edc6df0b9c3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "474a52f9c4d1418ea4f2573bb0a51aa2": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "e4fdbb12c7404cdbb5bb081e40a3dc61": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Start", "disabled": false, "icon": "", "layout": "IPY_MODEL_f99d87d39f964aefab130edc6df0b9c3", "style": "IPY_MODEL_474a52f9c4d1418ea4f2573bb0a51aa2", "tooltip": ""}}, "aa4ee6a332d84874a0ead5366ed92541": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0ee8a87dd79247d594500e783eea2ae9": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [500.0, 400.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_aa4ee6a332d84874a0ead5366ed92541", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_c82031cbfee047f394adb5a60813c63f", "toolbar_position": "left", "toolbar_visible": false}}, "7ea85b00c43c4a17af4fd4bc97245581": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c82031cbfee047f394adb5a60813c63f": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_7ea85b00c43c4a17af4fd4bc97245581", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "f51ace9e9dae4dc79eccccb0c13b3d10": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "88ba8f836c6e45598c6d71d02a111a83": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [150.0, 150.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_f51ace9e9dae4dc79eccccb0c13b3d10", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_4361a52e57a24369b5ee481332cda68f", "toolbar_position": "left", "toolbar_visible": false}}, "c135ba1bc18e49cba3e836b8c403ff3a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4361a52e57a24369b5ee481332cda68f": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_c135ba1bc18e49cba3e836b8c403ff3a", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "593557bf0af44c98aea45a915eca5a54": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "22a3906d023b476490380ff5d98dda4c": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_0f09f244d0624b87b7ff5ef1098711eb", "IPY_MODEL_87a650ca6eda46288d9ba0afee729b11"], "layout": "IPY_MODEL_593557bf0af44c98aea45a915eca5a54"}}, "eee96d2c2f7a4221984331427df5652b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1939eab43e1d45dfb04ca58a64b921eb": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_6b2f00587c094f0884f886eb87139ad6", "IPY_MODEL_22a3906d023b476490380ff5d98dda4c", "IPY_MODEL_64d6b307b0e24669a8b43c7364fb27ce"], "layout": "IPY_MODEL_eee96d2c2f7a4221984331427df5652b"}}, "bbcecce6d5ac44ac90a7a6ddc24a88b8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c6863701f91b4b5f86bfef396d4515a5": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_0ee8a87dd79247d594500e783eea2ae9", "IPY_MODEL_1939eab43e1d45dfb04ca58a64b921eb"], "layout": "IPY_MODEL_bbcecce6d5ac44ac90a7a6ddc24a88b8"}}, "2599f897992a4d4b97ceb18bf7ac2f55": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0ae3241588be44d6a5fdaf5c7b1d5d0f": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_c6863701f91b4b5f86bfef396d4515a5", "IPY_MODEL_99b3c93f496f42ad9b5cb15b3b338680"], "layout": "IPY_MODEL_2599f897992a4d4b97ceb18bf7ac2f55"}}, "7d2632bb995f4c8482710a15886c159b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a2d9f972c83043c4bed453d2fdc25825": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_124d5167ea594ce48f9f7755fb1879f7", "IPY_MODEL_e4fdbb12c7404cdbb5bb081e40a3dc61", "IPY_MODEL_88ba8f836c6e45598c6d71d02a111a83"], "layout": "IPY_MODEL_7d2632bb995f4c8482710a15886c159b"}}, "196f5478ba2346589eb58144b13d5884": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "50e8b5d9cbc04dcfadef7be8b6f279e0": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_0ae3241588be44d6a5fdaf5c7b1d5d0f", "IPY_MODEL_a2d9f972c83043c4bed453d2fdc25825"], "layout": "IPY_MODEL_196f5478ba2346589eb58144b13d5884"}}, "d76e2ce14c634012a4f65bcc684646f0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "22.0em", "min_height": "10.0em", "min_width": "21.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "21.0em"}}, "d9e3065fe36a481db6da5a83cbc99cb5": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d76e2ce14c634012a4f65bcc684646f0", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Click a button to start playing\n"}]}}, "af658ffd70fa4a8e817a32cb8f697731": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "18.8em", "min_height": "6.3em", "min_width": "12.5em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "63e1733fe6b74a07bae2e24281f15166": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_af658ffd70fa4a8e817a32cb8f697731", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "                P1    P2\n--------------  ----  ----\nHigh Score:     --    --\nLast Score:     --    --\nAverage Score:  --    --\n"}]}}, "6da560c7ce8047d39bd358757340de0c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": "18.8em", "min_width": "25.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8337d7ea99ee458c9d86fe383d762c02": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_6da560c7ce8047d39bd358757340de0c", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.core.display.Markdown object>", "text/markdown": "**Observations**"}}, {"output_type": "error", "ename": "AttributeError", "evalue": "'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'", "traceback": ["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m", "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)", "Cell \u001b[0;32mIn[1], line 3940\u001b[0m, in \u001b[0;36mComplexMoveInteractiveGridworld.__init__\u001b[0;34m(self, gridworld_game, init_board, has_fov, radius, fov_opaque, collect_fov_data, figsize, critter_names, players)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m-> 3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[1;32m   3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "Cell \u001b[0;32mIn[1], line 3941\u001b[0m, in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m   3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[0;32m-> 3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfov_eat_table_data\u001b[49m[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "\u001b[0;31mAttributeError\u001b[0m: 'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'"]}]}}, "7d929be2886748ea9834ab29e45be6b2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "9695f6850fc04a8b9c3754c5a03e6fc2": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "2ae6e63987a74ae49c93cd39363e056c": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Up", "disabled": false, "icon": "", "layout": "IPY_MODEL_7d929be2886748ea9834ab29e45be6b2", "style": "IPY_MODEL_9695f6850fc04a8b9c3754c5a03e6fc2", "tooltip": ""}}, "92511168c84244b69b524ccf97f12497": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "21c8c89c43774979b8d87c18a9c7f5c0": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "e61348ab4a5f4f8bb8723a0a8d87e7bc": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Down", "disabled": false, "icon": "", "layout": "IPY_MODEL_92511168c84244b69b524ccf97f12497", "style": "IPY_MODEL_21c8c89c43774979b8d87c18a9c7f5c0", "tooltip": ""}}, "ff1ca599f6234579949ee679eb3ac923": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "e0888165bf334456bac18d338dda1981": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "aca535584d6441fa9ec4a9066537c6cc": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Left", "disabled": false, "icon": "", "layout": "IPY_MODEL_ff1ca599f6234579949ee679eb3ac923", "style": "IPY_MODEL_e0888165bf334456bac18d338dda1981", "tooltip": ""}}, "c4d7f2f1875a4a58af043804e5fa1470": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "00153bd4b8d4465f8e226c261c79a2a1": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "1b1cdc001ff34b52b74f430492e9de1d": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Right", "disabled": false, "icon": "", "layout": "IPY_MODEL_c4d7f2f1875a4a58af043804e5fa1470", "style": "IPY_MODEL_00153bd4b8d4465f8e226c261c79a2a1", "tooltip": ""}}, "a07e0756679a4e8496a50d4d73547d6f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ef4544f1e9834a568b9df12516378c3a": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "5fdd1db5e3f1420b865c93edafcf35fa": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "First Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_a07e0756679a4e8496a50d4d73547d6f", "style": "IPY_MODEL_ef4544f1e9834a568b9df12516378c3a"}}, "86d1fd5eded64f9da438a5cd85856fbb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9507adf68e224b1eb7a8c5c59826712a": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "e0d0816ae6e842e3ba1aaa52657270a2": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "Second Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_86d1fd5eded64f9da438a5cd85856fbb", "style": "IPY_MODEL_9507adf68e224b1eb7a8c5c59826712a"}}, "4639d160f89a4d6392bb49552797f157": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "62dc656796cf4b72bf993a16f071d1a9": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "225bd1182cd843229eb61642ec481fe9": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Confirm Move", "disabled": false, "icon": "", "layout": "IPY_MODEL_4639d160f89a4d6392bb49552797f157", "style": "IPY_MODEL_62dc656796cf4b72bf993a16f071d1a9", "tooltip": ""}}, "11256ddc5bf64248b2c9d6b3f964f9f0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "e9838417a21f4e7d801005042e7f1116": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "3cd7f8ee42704a519dbd26d2d6617095": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Start", "disabled": false, "icon": "", "layout": "IPY_MODEL_11256ddc5bf64248b2c9d6b3f964f9f0", "style": "IPY_MODEL_e9838417a21f4e7d801005042e7f1116", "tooltip": ""}}, "f61c71c21c81455eab2722741f26f51d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a9794ce56e0042c5a0244c3974e77267": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [500.0, 400.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_f61c71c21c81455eab2722741f26f51d", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_93368b7cfc2a4bdcbef1f90bc9600886", "toolbar_position": "left", "toolbar_visible": false}}, "cb88c18d90b84d8aa004aa654142f4e4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "93368b7cfc2a4bdcbef1f90bc9600886": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_cb88c18d90b84d8aa004aa654142f4e4", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "c1ea8ae88cbb48d0ac0cff62c876f0b8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "efe7f8d2ba4446f5b17f7c99da94b24a": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [150.0, 150.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_c1ea8ae88cbb48d0ac0cff62c876f0b8", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_03c65fc27d4940ab9d7bc3618754d4e4", "toolbar_position": "left", "toolbar_visible": false}}, "ff35c3611c694a45af21e7f805864868": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "03c65fc27d4940ab9d7bc3618754d4e4": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_ff35c3611c694a45af21e7f805864868", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "9ee1cd454b5d449c82e09217550f6b8f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3677b0d7cefc4773a4cc4e4ed9be273f": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_2ae6e63987a74ae49c93cd39363e056c", "IPY_MODEL_e61348ab4a5f4f8bb8723a0a8d87e7bc"], "layout": "IPY_MODEL_9ee1cd454b5d449c82e09217550f6b8f"}}, "2c251a9463ba43d3a543cb46cac294f8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "663c3029b7f64ca5af9d010901fdf1e9": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_aca535584d6441fa9ec4a9066537c6cc", "IPY_MODEL_3677b0d7cefc4773a4cc4e4ed9be273f", "IPY_MODEL_1b1cdc001ff34b52b74f430492e9de1d"], "layout": "IPY_MODEL_2c251a9463ba43d3a543cb46cac294f8"}}, "c9bd835246f747199f594bf788aed860": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2ec69d5fd5dc4e97855d192d3c3304bd": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_a9794ce56e0042c5a0244c3974e77267", "IPY_MODEL_663c3029b7f64ca5af9d010901fdf1e9"], "layout": "IPY_MODEL_c9bd835246f747199f594bf788aed860"}}, "2d4a862e1bc04022bdca36daeb5ea37b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cb8e2615554e4a3fb3d9a9f0485253b5": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_2ec69d5fd5dc4e97855d192d3c3304bd", "IPY_MODEL_d9e3065fe36a481db6da5a83cbc99cb5"], "layout": "IPY_MODEL_2d4a862e1bc04022bdca36daeb5ea37b"}}, "f8d4766001494d5b9f254486648edb12": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e653d011c09c42b198296c44eef256c8": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_63e1733fe6b74a07bae2e24281f15166", "IPY_MODEL_3cd7f8ee42704a519dbd26d2d6617095", "IPY_MODEL_efe7f8d2ba4446f5b17f7c99da94b24a"], "layout": "IPY_MODEL_f8d4766001494d5b9f254486648edb12"}}, "169a214a8078414ea072aa46c98324c1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "550a5eefa71440f08dff17ee39a79c31": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_cb8e2615554e4a3fb3d9a9f0485253b5", "IPY_MODEL_e653d011c09c42b198296c44eef256c8"], "layout": "IPY_MODEL_169a214a8078414ea072aa46c98324c1"}}, "8b263162bbc747969e49f7ff6c7118d3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "22.0em", "min_height": "10.0em", "min_width": "21.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "21.0em"}}, "64bd38c554b2441192e61fa84dcd2794": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_8b263162bbc747969e49f7ff6c7118d3", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Click a button to start playing\n"}]}}, "ebe3c3fd694a4ae3b6a7c33ba98959b1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "18.8em", "min_height": "6.3em", "min_width": "12.5em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a104fbcd917a4a679e532f01a9f96196": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_ebe3c3fd694a4ae3b6a7c33ba98959b1", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "                P1    P2\n--------------  ----  ----\nHigh Score:     --    --\nLast Score:     --    --\nAverage Score:  --    --\n"}]}}, "3430034cc6504ceeb2db3e70710fe776": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": "18.8em", "min_width": "25.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f771d7438c164fcb91748bc155e82dd0": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_3430034cc6504ceeb2db3e70710fe776", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.core.display.Markdown object>", "text/markdown": "**Observations**"}}, {"output_type": "error", "ename": "AttributeError", "evalue": "'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'", "traceback": ["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m", "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)", "Cell \u001b[0;32mIn[1], line 3940\u001b[0m, in \u001b[0;36mComplexMoveInteractiveGridworld.__init__\u001b[0;34m(self, gridworld_game, init_board, has_fov, radius, fov_opaque, collect_fov_data, figsize, critter_names, players)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m-> 3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[1;32m   3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "Cell \u001b[0;32mIn[1], line 3941\u001b[0m, in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m   3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[0;32m-> 3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfov_eat_table_data\u001b[49m[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "\u001b[0;31mAttributeError\u001b[0m: 'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'"]}]}}, "5d9474a82ff94e9e8ea41a108597858e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "31fe48885a6f4e84b56d80b09898df04": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "52bdd7216bf8495facde98d868df8345": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Up", "disabled": false, "icon": "", "layout": "IPY_MODEL_5d9474a82ff94e9e8ea41a108597858e", "style": "IPY_MODEL_31fe48885a6f4e84b56d80b09898df04", "tooltip": ""}}, "6da1b964f476462eb3f3e0e20946ad36": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "148572db535d4435b337c6999680e0a5": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "976d5702cd7b439d86ddba5ec43e41a0": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Down", "disabled": false, "icon": "", "layout": "IPY_MODEL_6da1b964f476462eb3f3e0e20946ad36", "style": "IPY_MODEL_148572db535d4435b337c6999680e0a5", "tooltip": ""}}, "bb87d52900c04ffb86e9d16fbcf20b16": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "616720a21f06461fb65726b1e880fa65": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "743c3d71704f4027b0d53c2a8d458e14": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Left", "disabled": false, "icon": "", "layout": "IPY_MODEL_bb87d52900c04ffb86e9d16fbcf20b16", "style": "IPY_MODEL_616720a21f06461fb65726b1e880fa65", "tooltip": ""}}, "29d0e38a696549e5a0ae442013c823b9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "3eae41d6504c48a787a7f3c5306ab50c": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "d1c1829578f445949335eee9cc4b07e4": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Right", "disabled": false, "icon": "", "layout": "IPY_MODEL_29d0e38a696549e5a0ae442013c823b9", "style": "IPY_MODEL_3eae41d6504c48a787a7f3c5306ab50c", "tooltip": ""}}, "446efb1de74c4e1fa9a03ead7c8c23d3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1ac94a91061e46509729672872eaf253": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "31b9bfa2b01a4510b304b1e90708f500": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "First Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_446efb1de74c4e1fa9a03ead7c8c23d3", "style": "IPY_MODEL_1ac94a91061e46509729672872eaf253"}}, "f9268e39a9ea451e8ba838c5bf2618a0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "55b643aa434346349ace57ee5caf4d2f": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "da8c34b3123f4268a78a1dd939b27db0": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "Second Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_f9268e39a9ea451e8ba838c5bf2618a0", "style": "IPY_MODEL_55b643aa434346349ace57ee5caf4d2f"}}, "6e4f4e2346d948dba4d5deaff85aa180": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1e92fbb968284ab7aad50d53d2cd2331": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "e64e4a13150e4b78a3a24752e683047d": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Confirm Move", "disabled": false, "icon": "", "layout": "IPY_MODEL_6e4f4e2346d948dba4d5deaff85aa180", "style": "IPY_MODEL_1e92fbb968284ab7aad50d53d2cd2331", "tooltip": ""}}, "407614971bff4009aa154b9d4c373a78": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "ddca479a43ca410aa33145560a74d9fd": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "c5f57cff87a749558a357c732c54b7e1": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Start", "disabled": false, "icon": "", "layout": "IPY_MODEL_407614971bff4009aa154b9d4c373a78", "style": "IPY_MODEL_ddca479a43ca410aa33145560a74d9fd", "tooltip": ""}}, "8d4f83604bd14ca89da390ba020e8f25": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7e19680dfddd445e94cdbbb215a3c3b5": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [500.0, 400.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_8d4f83604bd14ca89da390ba020e8f25", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_bc07f0f534de43efbb1ec43618d164dc", "toolbar_position": "left", "toolbar_visible": false}}, "7af65fae6a7246f98d36ab7866041b42": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bc07f0f534de43efbb1ec43618d164dc": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_7af65fae6a7246f98d36ab7866041b42", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "0893df99d9d647709189c9dde6925ec6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f9d5a9b9b8ae4c20861fac6188ce4eeb": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [150.0, 150.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_0893df99d9d647709189c9dde6925ec6", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_23d83d1619b845dba8aa76b63239255d", "toolbar_position": "left", "toolbar_visible": false}}, "ae1c984cd3ae4d22a3759e631ec6fbc8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "23d83d1619b845dba8aa76b63239255d": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_ae1c984cd3ae4d22a3759e631ec6fbc8", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "3b5a9fd85f9d4fce985b7ebfa5ffc928": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "766b5ff9a06e4e489ab601e07d35f6a3": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_52bdd7216bf8495facde98d868df8345", "IPY_MODEL_976d5702cd7b439d86ddba5ec43e41a0"], "layout": "IPY_MODEL_3b5a9fd85f9d4fce985b7ebfa5ffc928"}}, "59929d57c9dd4126863d76d171308fb1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d2d03965a1ee4dd6a77a706de5b467f9": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_743c3d71704f4027b0d53c2a8d458e14", "IPY_MODEL_766b5ff9a06e4e489ab601e07d35f6a3", "IPY_MODEL_d1c1829578f445949335eee9cc4b07e4"], "layout": "IPY_MODEL_59929d57c9dd4126863d76d171308fb1"}}, "8987d95090de44eda4e6706d8dd8e853": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "727a3d34f992408d916cb4f5e43b14b1": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_7e19680dfddd445e94cdbbb215a3c3b5", "IPY_MODEL_d2d03965a1ee4dd6a77a706de5b467f9"], "layout": "IPY_MODEL_8987d95090de44eda4e6706d8dd8e853"}}, "d9981e800a9245eb80bcabf2fdbcd7af": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c98bd8e9486e4b068a6c670050037316": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_727a3d34f992408d916cb4f5e43b14b1", "IPY_MODEL_64bd38c554b2441192e61fa84dcd2794"], "layout": "IPY_MODEL_d9981e800a9245eb80bcabf2fdbcd7af"}}, "4d5f6c85651b45b9ab01d796f029331c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5b1c1e638bc34fad904c8a1da12f7e59": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_a104fbcd917a4a679e532f01a9f96196", "IPY_MODEL_c5f57cff87a749558a357c732c54b7e1", "IPY_MODEL_f9d5a9b9b8ae4c20861fac6188ce4eeb"], "layout": "IPY_MODEL_4d5f6c85651b45b9ab01d796f029331c"}}, "ff03db370da34b9285b4a00d99d4b363": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "eb68c99eff1e473f8874caa496cb1e6c": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_c98bd8e9486e4b068a6c670050037316", "IPY_MODEL_5b1c1e638bc34fad904c8a1da12f7e59"], "layout": "IPY_MODEL_ff03db370da34b9285b4a00d99d4b363"}}, "73a9cf1c6f384e5ba38de07c2570877d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "22.0em", "min_height": "10.0em", "min_width": "21.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "21.0em"}}, "9622068324d04e0aa7e6206886d97396": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_73a9cf1c6f384e5ba38de07c2570877d", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Click the start button to run the simulation\n"}]}}, "f224e02014ef4f028dff0ff1cb3d2ca1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "18.8em", "min_height": "6.3em", "min_width": "12.5em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dca6c448f6c94a8c8f9c0f4f16801364": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_f224e02014ef4f028dff0ff1cb3d2ca1", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "                P1    P2\n--------------  ----  ----\nHigh Score:     --    --\nLast Score:     --    --\nAverage Score:  --    --\n"}]}}, "b5dd1c4cf4f042f383a71eaa598c6f6e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": "18.8em", "min_width": "25.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "69f195d3353d4ce6a827311f06bdffe5": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_b5dd1c4cf4f042f383a71eaa598c6f6e", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.core.display.Markdown object>", "text/markdown": "**Observations**"}}, {"output_type": "error", "ename": "AttributeError", "evalue": "'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'", "traceback": ["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m", "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)", "Cell \u001b[0;32mIn[1], line 3940\u001b[0m, in \u001b[0;36mComplexMoveInteractiveGridworld.__init__\u001b[0;34m(self, gridworld_game, init_board, has_fov, radius, fov_opaque, collect_fov_data, figsize, critter_names, players)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m-> 3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[1;32m   3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "Cell \u001b[0;32mIn[1], line 3941\u001b[0m, in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m   3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[0;32m-> 3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfov_eat_table_data\u001b[49m[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "\u001b[0;31mAttributeError\u001b[0m: 'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'"]}]}}, "91cc9384a1cb45d780554199bbce452d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "47cfdc48224c447aaac85efd2756a704": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "d2b206d496a04ec78bc48f8027b7e4a8": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Up", "disabled": false, "icon": "", "layout": "IPY_MODEL_91cc9384a1cb45d780554199bbce452d", "style": "IPY_MODEL_47cfdc48224c447aaac85efd2756a704", "tooltip": ""}}, "669c794299794eae92cf186b1ae3dbde": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "b1c729b03be444368b72c5889896d0fd": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "934f1a9b084544cdba930f23ba5f5798": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Down", "disabled": false, "icon": "", "layout": "IPY_MODEL_669c794299794eae92cf186b1ae3dbde", "style": "IPY_MODEL_b1c729b03be444368b72c5889896d0fd", "tooltip": ""}}, "37e10090031e4d67a12e1ceaa3f656f4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "5e619fe7726c4bb5b6e43003f809bd3a": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "aeda793033d64a11902b22a4018266d3": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Left", "disabled": false, "icon": "", "layout": "IPY_MODEL_37e10090031e4d67a12e1ceaa3f656f4", "style": "IPY_MODEL_5e619fe7726c4bb5b6e43003f809bd3a", "tooltip": ""}}, "73b57469d9d14b978413682be1b7554c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "140df66a1e544a2e8e47b92bf7886343": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "ca344c97ef494d57870f2eec93f41240": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Right", "disabled": false, "icon": "", "layout": "IPY_MODEL_73b57469d9d14b978413682be1b7554c", "style": "IPY_MODEL_140df66a1e544a2e8e47b92bf7886343", "tooltip": ""}}, "d5649f719faa4e209c68a38c71f36388": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f95577625d8b415595701c9be7f447b2": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "640de11e6c9e4594ae527e82c61a74b6": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "First Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_d5649f719faa4e209c68a38c71f36388", "style": "IPY_MODEL_f95577625d8b415595701c9be7f447b2"}}, "477b8b20c9c441dfaa65794ec8073cf5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f801714249114e9d8917cdc75cb84920": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "315fb701bf1d4c1da6ac398cf1b3e298": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "Second Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_477b8b20c9c441dfaa65794ec8073cf5", "style": "IPY_MODEL_f801714249114e9d8917cdc75cb84920"}}, "96968f5e387c4f0fa98f164c344ee13c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9893d537e8c343a7872472760f5ca1eb": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "7b88c662fc9a4c45af452a463ec73dec": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Confirm Move", "disabled": false, "icon": "", "layout": "IPY_MODEL_96968f5e387c4f0fa98f164c344ee13c", "style": "IPY_MODEL_9893d537e8c343a7872472760f5ca1eb", "tooltip": ""}}, "8d8e9b32315144929cccc18862069beb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "a8bfef7b98e34d298b09ff3efbbf661e": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "ae07cc0e0a444084ac42f4285c142b14": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Start", "disabled": false, "icon": "", "layout": "IPY_MODEL_8d8e9b32315144929cccc18862069beb", "style": "IPY_MODEL_a8bfef7b98e34d298b09ff3efbbf661e", "tooltip": ""}}, "d57e29f055914f738668845e7141b9a0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "48915609fb2e49c3868839bb640a2e58": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [500.0, 400.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_d57e29f055914f738668845e7141b9a0", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_0bed4c61629745a1809dd63f7585c80a", "toolbar_position": "left", "toolbar_visible": false}}, "69c19a8feb554f2a9096a867335e3391": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0bed4c61629745a1809dd63f7585c80a": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_69c19a8feb554f2a9096a867335e3391", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "4e059a0c304c43eca18f9afe33e53d2e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ea79185de272463daf18e446e6555941": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [150.0, 150.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_4e059a0c304c43eca18f9afe33e53d2e", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_2f79ba6ec22f486c9feef88d86f29e4d", "toolbar_position": "left", "toolbar_visible": false}}, "57b95cb4eed7403097b067dfd3699495": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2f79ba6ec22f486c9feef88d86f29e4d": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_57b95cb4eed7403097b067dfd3699495", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "166838412f7a49eaa18b4c7211744820": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "66910430da794b8e844219be07b7451e": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_d2b206d496a04ec78bc48f8027b7e4a8", "IPY_MODEL_934f1a9b084544cdba930f23ba5f5798"], "layout": "IPY_MODEL_166838412f7a49eaa18b4c7211744820"}}, "c0b7890c04d74567aabd6bfab3dffdf2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "48869908ef144d958615669f5bec43bb": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_aeda793033d64a11902b22a4018266d3", "IPY_MODEL_66910430da794b8e844219be07b7451e", "IPY_MODEL_ca344c97ef494d57870f2eec93f41240"], "layout": "IPY_MODEL_c0b7890c04d74567aabd6bfab3dffdf2"}}, "9e317067b1a7416393cef65483f28fb6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3bd962826c444af8872d0ec3bd8e677a": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_48915609fb2e49c3868839bb640a2e58", "IPY_MODEL_9622068324d04e0aa7e6206886d97396"], "layout": "IPY_MODEL_9e317067b1a7416393cef65483f28fb6"}}, "c1da13aa2f494786903554cab7796b8a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "48a5330cc161408f9886f7cef5649f6f": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_dca6c448f6c94a8c8f9c0f4f16801364", "IPY_MODEL_ae07cc0e0a444084ac42f4285c142b14", "IPY_MODEL_ea79185de272463daf18e446e6555941"], "layout": "IPY_MODEL_c1da13aa2f494786903554cab7796b8a"}}, "cff9c7bae1f043ca86ab20589a7fec39": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "289f50a76dd04be39c42326ac7d9d459": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_3bd962826c444af8872d0ec3bd8e677a", "IPY_MODEL_48a5330cc161408f9886f7cef5649f6f"], "layout": "IPY_MODEL_cff9c7bae1f043ca86ab20589a7fec39"}}, "43bf62850dfd459a875962a38455791c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "528f5049937545c3af95229255d8ebff": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_weight": ""}}, "6c403c0acff34253a28449acbda34b26": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_43bf62850dfd459a875962a38455791c", "style": "IPY_MODEL_528f5049937545c3af95229255d8ebff", "tooltip": "happy"}}, "1b30213f3d95431f8a7789a943eaf033": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "7490a4f51cc545b795db677bc6c02233": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_weight": ""}}, "63983b062ac740e19734d7ab554c377b": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_1b30213f3d95431f8a7789a943eaf033", "style": "IPY_MODEL_7490a4f51cc545b795db677bc6c02233", "tooltip": "medium"}}, "78896f5e9f314f44891066c064a3a5eb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "2a99474141f64ae6adde2af9ef5cbe7f": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_weight": ""}}, "df624492733647edabae8f8f4525b0ac": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_78896f5e9f314f44891066c064a3a5eb", "style": "IPY_MODEL_2a99474141f64ae6adde2af9ef5cbe7f", "tooltip": "sad"}}, "4e74410563964b97b1251075c0962e0c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "502760eea5994436ad69d2cac42c3988": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "a2b6d252c0b6434992bc6e496e8813cb": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_4e74410563964b97b1251075c0962e0c", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_502760eea5994436ad69d2cac42c3988", "value": ""}}, "9ef53fbbd4a74910a9a6684a24756eef": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "73462d02dd6f4596a8f00969f60ad79c": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "fc034e93b503448088c2cdd018f29249": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_9ef53fbbd4a74910a9a6684a24756eef", "style": "IPY_MODEL_73462d02dd6f4596a8f00969f60ad79c", "tooltip": ""}}, "0fc9c062d635429f91cdd497171612fb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "22026dad98a54a9f96b5c7d4179d5613": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_a2b6d252c0b6434992bc6e496e8813cb", "IPY_MODEL_fc034e93b503448088c2cdd018f29249"], "layout": "IPY_MODEL_0fc9c062d635429f91cdd497171612fb"}}, "0d78981a3c334fb397755bcae3b57ba6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b339a55e09534785b43d0780b045fb00": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "878eeaf98fa045cfb882cfa86dbb3bec": {"model_name": "LabelModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_0d78981a3c334fb397755bcae3b57ba6", "placeholder": "\u200b", "style": "IPY_MODEL_b339a55e09534785b43d0780b045fb00", "value": "Thanks for your feedback!"}}, "2ce9aaf730fb4e7c94fce7cd6b63c9d4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "27867a6cf65144a5bfb0feb6e6f7d2be": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_6c403c0acff34253a28449acbda34b26", "IPY_MODEL_63983b062ac740e19734d7ab554c377b", "IPY_MODEL_df624492733647edabae8f8f4525b0ac"], "layout": "IPY_MODEL_2ce9aaf730fb4e7c94fce7cd6b63c9d4"}}, "99fc756482de4ad794deb7974bed9655": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "50fc9ae5cd604797bff943790fc08a42": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_27867a6cf65144a5bfb0feb6e6f7d2be", "IPY_MODEL_22026dad98a54a9f96b5c7d4179d5613", "IPY_MODEL_878eeaf98fa045cfb882cfa86dbb3bec"], "layout": "IPY_MODEL_99fc756482de4ad794deb7974bed9655"}}, "77157562e2104e20b1428fa8355efe46": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e091dc231bfd4424803dd8204117ce47": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_50fc9ae5cd604797bff943790fc08a42"], "layout": "IPY_MODEL_77157562e2104e20b1428fa8355efe46"}}, "2b4ba0021c8c41a6ab9acd2efaccca7b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "002133da544241c498b42da88e9195bf": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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Xz4+PoaDg4N1mSTD19fXmDt3bp7ryuvBgde2SzKcnZ2NcuXK2TwYzsvLy/jpp59yrPOpp56y9vHw8DCCgoKMKlWqGM8991yOfcjt4Xz/K3td+T2IcOnSpdanhpcuXdrw8PCwLvPx8cnxNOlsf/zxh+Hl5WXt6+bmZpQqVcr63n799dd5PojQMP7/qdSSDE9PT6NKlSpGlSpVjGnTphV4X999913DYrHY1Jv98ERJRr169Yz4+Pgc4271QYoFsXTpUptavLy8DDc3N+vPgYGBxp49e3Ide6sPIqxQoYLNZ9DBwcEoU6aM4erqatPu6emZ4yGN2bZt22YEBARY+zo6OhrlypWz2Ydrj1W2UaNGWZdbLBajTJkyNp/9Nm3aGElJSTnG3cjn+ueff7bZx+zash80mP0aPHiwdcy1xzN7TNmyZW2OkYuLS57vB4Dby//fpxAA7iDZf521WCwqVaqUKlSooKCgIDVq1Ejt2rXTgw8+aD0jcSOaNGmi5cuXa8OGDfr999914sQJnTt3Tm5ubgoJCVHHjh317LPP2jxnItvs2bMVGBiolStX6tChQzp69Kgk5XqJVGG57777FBMTo0mTJmndunU6e/asAgIC1KVLF7388svW26b+r4YNG+q3337ThAkTtH79eiUkJMjf318DBw7U+PHj852gLkmfffaZXnvtNX399dc6evSodcLzjVyWNWrUKIWHh2vatGnauHGjTp8+LXd3dzVu3Fh9+vTR008/ne9teotS9l/53377ba1du1bHjx+Xs7OzGjZsqB49eigiIsLmsrvCtH//fn3//ffasGGDtm/frkOHDumff/6Rg4OD/P39VatWLXXo0EFPPfWU/P39c11H48aN9ddff+m9997TqlWrtHfvXiUnJ8vf31/VqlVTt27d1L9//xzj3n33XT344IOaPXu2Nm/erPPnz8vT01MNGzbU448/rieeeOKW7+AWFham/fv364MPPtDq1av1559/KiEhQe7u7qpVq5ZCQ0PVuXNn68Mkpau3B169erU2bNigLVu26Pjx4zpz5oycnJwUEhKiNm3a6Nlnn1X16tVvqTYA5rAYhomzJQEAAACUaMwBAQAAAGAaAggAAAAA0xBAAAAAAJiGAAIAAADANAQQAAAAAKYhgAAAAAAwDQGkiBiGoaSkJNOehgwAAADcCQggRSQ5OVne3t5KTk4u7lIAAACA2wYBBAAAAIBpCCAAAAAATEMAAQAAAGAaAggAAAAA0xBAAAAAAJiGAAIAAADANAQQAAAAAKZxKu4CAAAAiophGMrMzFRGRkZxlwIUOycnJzk6OspisRRvHcW6dQAAgCJgGIYSEhJ09uxZZWZmFnc5wG3D0dFRfn5+8vb2LrYgQgABAAB259SpU0pISJCXl5e8vLzk5ORU7H/1BYqTYRjKyMhQUlKSTp48qUuXLqlixYrFUgsBBAAA2JXMzEwlJiaqfPny8vX1Le5ygNuKp6enXF1dde7cOfn5+cnR0dH0GuxmEnpmZqamTJmikJAQubq6KiQkRFOmTLnuadfDhw/LYrHk+XJ2djZpDwAAQGFIT0+XYRgqVapUcZcC3JZKlSolwzCUnp5eLNu3mzMgI0aM0Jw5czRo0CA1b95cmzdvVmRkpI4dO6bZs2fnOa58+fJatGhRjvZjx45p3Lhx6ty5c1GWDQAAigiXXAG5K+7fDbsIILGxsZo7d65Gjhyp6dOnS5IGDx4sLy8vzZw5U8OGDVO9evVyHVuqVCk99thjOdonTpwoSRo4cGCR1Q0AAACUNHZxCdbSpUtlGIYiIiJs2iMiImQYhpYtW3bD6/z4449Vrlw5de3atZCqBAAAAGAXASQmJkb+/v4KDg62aQ8ODpafn59iYmJuaH2//PKLDhw4oH79+snFxaUwSwUAACgU0dHRNvNWHRwcVLZsWXXs2FHr1q0r7vJytW7dOnXq1EmVK1eWm5ubAgIC1KZNG7366qvFXRpMZBeXYJ04cUIBAQG5LgsICFB8fPwNrW/hwoWSpAEDBly3b1pamtLS0nK0JyUl3dA2AQCAOab9uL+4S7Aa1aHGLa/jqaeeUuvWrZWZmamDBw9q7ty5uv/++/Xdd9+pffv2hVBl4Zg5c6ZGjhypRo0a6ZlnnpGvr6+OHTummJgYTZ48mRBSgthFAElNTZWnp2euy9zc3G4oDFy+fFnLly9XnTp1dM8991y3/+TJkzVhwoQCrx8AAKAwNW3a1GY+68MPP6zGjRvr7bffzjOAGIahS5cuycPDw5QaMzIy9PLLL+uee+7Rli1b5ORk+xX09OnTptRxraysLF25ckVubm6mb7uks4tLsDw8PHI9CyFdDRTu7u4FXtfq1auVkJBQoLMfkhQZGanExMQcr2PHjhV4mwAAAIWlUaNGKleunP7++29J///IgfHjx+vjjz9WvXr15Orqqg8++EDS1UcZTJs2TfXr15ebm5vKlCmjHj166K+//rKu8+uvv5bFYtHixYtzbO/UqVNydnbWiBEj8qzp3LlzSkhIUFhYWI7wIUn+/v452o4cOaInn3xSAQEBcnV1VWBgoB599FGbK1sMw9DMmTNVr149ubm5ydfXV3369NHBgwdt1pV9udp///tfvfvuuwoJCZGLi4u+++47SVf/mP3KK6+oZs2acnV1lZ+fn5544gkdP348x378+9//VtWqVeXq6qpy5cqpWbNmWr58eZ77jpzs4gxIpUqVtHPnzlyXxcfHq1GjRgVe18KFC+Xo6JjrnbFy4+rqKldX1wKvHwAAoCidP39e//zzj2rUsL2868svv9Tp06c1fPhwVaxY0bq8b9++WrVqlR5//HENHz5c58+f13vvvadmzZpp69atql69ujp16qRKlSpp4cKFevTRR23Wu3jxYmVkZOR751A/Pz95eHjo22+/1QsvvHDdJ3Dv27dPYWFhSk1N1b/+9S/Vrl1bZ86c0TfffKODBw9aL72PiIjQjBkz1LZtWw0ZMkQnT57UzJkztW7dOsXExKhq1ao2650xY4YuXbqkp556Sl5eXqpataquXLmiDh06aMeOHXrqqadUt25dHT16VLNnz1Z0dLS2b99ufaDlI488ou3bt2v48OGqXr26EhIStGPHDm3ZskW9e/cuyOGB7CSAhIaG6ocfflBcXJzNRPS4uDidOXNGoaGhBVrPqVOn9P3336tjx47F9mh6AACAG3Hx4kWdO3dOWVlZOnjwoCIjI5WVlaU+ffrY9Nu3b5/27NmjkJAQa9uKFSv02WefacWKFXrkkUes7QMHDlTt2rX18ssva8mSJXJ0dNQTTzyht956S8ePH1flypWtfRcuXKh69erl+33LwcFB48eP17hx4xQcHKymTZuqefPmat68udq1a5fjapV///vfSkxM1O+//27zh+SXXnpJhmFIkvbs2aMZM2bogQce0OrVq+XgcPXCnm7duql58+aKjIzUkiVLbNZ78uRJ7d+/X2XLlrW2TZ06Vb///rt++uknNWvWzNr+yCOP6J577tE777yjyZMnKzExURs3btRbb72lMWPG5H1AcF12cQlWnz59ZLFYFBUVZdMeFRUli8Vi/QVMT0/X3r17dfLk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zUfc8qqeeuoptW7dWpmZmTp48KDmzp2r+++/X999953at29/y+svap9//rkWL15segj5/fff1bp1a5UpU0YDBw5UcHCwzp07p927d+vjjz9W9+7dValSJVNrKikIIAAAAHewpk2b6rHHHrP+/PDDD6tx48Z6++238wwghmHo0qVL8vDwMKtM011vH1977TU5ODjo999/V0BAgM2yS5cuKT093YwybaSmptr1McnGJVgAAAB2pFGjRipXrpz+/vtvSdLhw4dlsVg0fvx4ffzxx6pXr55cXV31wQcfSJIyMzM1bdo01a9fX25ubipTpox69Oihv/76K8e6jxw5oh49esjT01NlypRRv379dPr06Rz9kpKSNG7cOIWGhsrHx0fu7u5q1KiRFi1aZNOvdevWWrx4sSTZXE52+PBha58lS5aoSZMmcnd3l7e3t7p06aLt27fbrOd6+5ibgwcPKiQkJEf4kCR3d3d5eXnZtKWkpOjll1/W3XffLTc3N/n5+aljx476+eefbfr9+OOPCg8PV+nSpVW6dGmFh4fnekmcxWLRY489pm+//Vb33nuv3N3dNW7cOOvyhQsX6t5771WpUqXk6empDh06aMuWLTbryMzM1FtvvaXatWvLw8NDXl5eqlOnjl555ZU89/t2wBkQAAAAO3L+/Hn9888/qlGjhk37l19+qdOnT2v48OGqWLGidXnfvn21atUqPf744xo+fLjOnz+v9957T82aNdPWrVtVvXp1SdI///yjli1b6syZM/r3v/+t4OBgff311+rcuXOOGk6cOKGPP/5YvXv31lNPPaUrV67o888/1xNPPKH09HQ9+eSTkqT//Oc/Sk9P1y+//GITTsqXLy9JmjZtmkaPHq3Q0FC98cYbSkpK0ty5c9WiRQtFR0fr3nvvLdA+5iY4OFgbNmzQL7/8oubNm+f7nl66dElt2rTR1q1b1bt3bz3zzDO6fPmyfvnlF23cuFEtWrSQJK1cuVK9e/dWtWrVNH78eEnSRx99pPvvv18rV67UQw89ZLPebdu26auvvtKwYcP0r3/9S35+fpKk559/Xu+++6569uypAQMGKDU1VR999JFat26tdevWWbf3+uuva8KECRo4cKAiIiJ05coV7d+/X9HR0fnuT3GzGIZhFHcR9igpKUne3t5KTEzMkaABAEDRuXz5suLi4hQcHCw3N7ecHW7XOSBeFW9oFdHR0WrTpo2mTZumxx57TFlZWTp48KAiIyP1008/KSoqSs8++6wOHz6s4OBgOTs7a8+ePQoJCbGuY8WKFerdu7dWrFihRx55xNoeHx+v2rVrq0uXLlqyZIkk6cUXX9Sbb76pL774Qt27d5d09TKnXr16aeXKlXrllVes8ziuXLkiBwcHOTn9/9+6DcNQ+/btdfz4ce3bt8/a/thjj2nx4sX636+kFy5cUOXKlXX33Xfrl19+sR7LuLg41alTRw0aNLCeEchvH/Py008/qV27dsrIyFDDhg3VokULNW3aVB06dLAGgWwTJ07USy+9pJkzZ+qZZ56xWWYYhiwWizIyMlS1alUZhqHdu3erTJkykq4Gt7p168rBwUFxcXHW98RisUiSNm7cqFatWlnXt3XrVt17772aOnWqnn/+eWv7xYsXVbduXVWsWNG6340aNVKlSpX09ddfX3d/r3Xd35EixiVYAAAAd7BRo0apfPny8vf3V1hYmGJiYvTiiy9q5MiRNv26dOmS44v5kiVLVKlSJbVu3Vrnzp2zvlxdXdW0aVOtXbvW2vfLL79USEiINXxIV79EX/slOZuLi4v1i/aVK1d04cIFnT9/Xu3bt9f+/fuVlJR03f368ccfdenSJY0aNcrmS3JwcLD69u2rX3/9VWfOnLnuPualVatW2rJli3r16qW///5bs2bN0mOPPaaAgACNHDnSZg7I8uXLFRQUpOHDh+dYT3aQ2LZtm+Lj4zVs2DBr+JCkMmXKaOjQoTp+/HiOS8caNGhgEz6kq8fE2dlZffr0sTkmly9fVvv27fXbb7/p4sWLkiQfHx/t3r1bf/75Z4H2+XbBJVgAAAB3sNGjR6tz585ycHCQt7e3ateuLXd39xz9qlWrlqNt7969OnHihPWSp9xkZWVZ/3rfoUOHHMtr1aqVo80wDE2fPl1z587V/v37c5zdSEhIuO4VInFxcZKk2rVr51iW3RYXF2dztiK3fczPPffco+XLlysrK0sHDhzQ+vXr9c4772jmzJny9fXVyy+/LEk6cOCA2rZtKweHvP92X9B6r71sLK9jkp6erqCgoDy3dfbsWZUuXVpvvPGGHnroIdWtW1chISFq06aNunfvri5duhTsDSgmBBAAAIA7WK1atQp0u93cQolhGAoODs53snb2X/hvxNSpU/XCCy/ogQce0Isvvih/f385Ozvrm2++0bRp05SVlXXD6yyI3PaxIBwcHFSzZk3VrFnTOodj4cKF1gBSVPI6Jh4eHvryyy/zHFehQgVJUrNmzXTo0CF9++23WrdunX788Uf997//VefOnfXVV1/lG5iKEwEEAACghAoJCVF0dLTCw8Pl7Oycb9/g4GCbuRvZcrtb1pIlSxQcHKw1a9bYBJj169fn6JtXwAkODpYk7dmzR6GhobluM7tPYSpXrpyqVatmc1lT9erVtXv3buvZoOvV27Nnz1zrveuuu667/ZCQEH333XeqW7euNWjkx9PTU71791bv3r1lGIbGjBmjd955R9HR0Wrbtu11xxeH2zMWAQAAoMj1799fFy9e1KRJk3Jdfu0ci27duunAgQNatWqVtc0wDL399ts5xjk6OkqSzZmO8+fP66OPPsrRt1SpUpKuTta+VocOHeTu7q6oqCilpaVZ248cOaKlS5eqWbNmOSaL34i1a9cqMzMzR/vff/+tv/76y+bSst69e+vo0aN67733cvTPvrwsNDRUAQEBev/995WQkGBdnpCQoPfff1+VK1dW48aNr1tX//79JUnjxo3LcemaZHtMzp07Z7PMYrGoYcOGknK+n7cTzoAAAACUUH379tWXX36pCRMmaMuWLerQoYM8PT115MgRffvtt6pTp44++eQTSdLYsWP16aefqm/fvnrmmWcUHBysr776KtfngHTv3l0vvfSSunbtqu7du+vMmTP64IMPFBAQkKP/Pffco/fff1/PPPOMOnfuLCcnJz344IMqW7asJk2apNGjR6tFixZ69NFHlZycrPfee0+GYSgqKuqW9j0iIkIJCQnWORROTk7av3+/Fi5cqCtXrmjixInWvs8995y++OILjRgxQps2bVLLli2ttw9u1KiRxo0bJycnJ02fPl29e/fWfffdZ73V8EcffaSTJ09q5cqV1mCWn2bNmmns2LF66623tGfPHj300EPy9fXVsWPHFB0dLcMwtGnTJklXL78LCwtTkyZNVLFiRR0+fFjvvfeeKlSooHbt2t3S+1OUCCAAAAAllMVi0ZIlS9SmTRt99NFHevXVV2UYhgICAhQWFqZ//etf1r7lypXTTz/9pIiICM2dO1fOzs7q1KmTFixYkONSoRdffFHp6elauHChNmzYoODgYL3wwgsqXbq0Bg0aZNN3wIAB2rZt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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [800.0, 600.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_2b4ba0021c8c41a6ab9acd2efaccca7b", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_eea6b35c9d08441bab84d85df29ffeed", "toolbar_position": "left", "toolbar_visible": false}}, "1c002a666c83400c93b66e55159e15f9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "eea6b35c9d08441bab84d85df29ffeed": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_1c002a666c83400c93b66e55159e15f9", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "0c4b70e9dc77408ab31cb34bd5528b03": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "22.0em", "min_height": "10.0em", "min_width": "21.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "21.0em"}}, "dbf9315f324b43d5a9e8a290c93ddb46": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_0c4b70e9dc77408ab31cb34bd5528b03", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Click the start button to run the simulation\n"}]}}, "ffb4f0facf0e4baa8c154a2aa2c84ea8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "18.8em", "min_height": "6.3em", "min_width": "12.5em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1aba2637541346df9e94fb1a85a8d6ad": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_ffb4f0facf0e4baa8c154a2aa2c84ea8", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "                P1    P2\n--------------  ----  ----\nHigh Score:     --    --\nLast Score:     --    --\nAverage Score:  --    --\n"}]}}, "9b19635ef9a046b6b8d505a5291f2776": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": "18.8em", "min_width": "25.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4ea6a8f52c9446bfb1cdd59973557a3a": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_9b19635ef9a046b6b8d505a5291f2776", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.core.display.Markdown object>", "text/markdown": "**Observations**"}}, {"output_type": "error", "ename": "AttributeError", "evalue": "'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'", "traceback": ["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m", "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)", "Cell \u001b[0;32mIn[1], line 3940\u001b[0m, in \u001b[0;36mComplexMoveInteractiveGridworld.__init__\u001b[0;34m(self, gridworld_game, init_board, has_fov, radius, fov_opaque, collect_fov_data, figsize, critter_names, players)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m-> 3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[1;32m   3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "Cell \u001b[0;32mIn[1], line 3941\u001b[0m, in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m   3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[0;32m-> 3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfov_eat_table_data\u001b[49m[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "\u001b[0;31mAttributeError\u001b[0m: 'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'"]}]}}, "196a221cc9ba41ecbbe30de9fce372c0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "6f53f52e35cf4b40bf76f7d09e9fc1a9": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "b2f1ba59545d4eee813b58f28dcf0891": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Up", "disabled": false, "icon": "", "layout": "IPY_MODEL_196a221cc9ba41ecbbe30de9fce372c0", "style": "IPY_MODEL_6f53f52e35cf4b40bf76f7d09e9fc1a9", "tooltip": ""}}, "0fa015e8cb074e8f999a2dc9d61ab32d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "689eda75f01045728831ee1cc5162b54": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "25ea41d5a07043b8917a831cf685769b": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Down", "disabled": false, "icon": "", "layout": "IPY_MODEL_0fa015e8cb074e8f999a2dc9d61ab32d", "style": "IPY_MODEL_689eda75f01045728831ee1cc5162b54", "tooltip": ""}}, "5e1a42be168641529a554f842ba98ccf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "bb3c011a846e484d9eee1247dfc5ed6b": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "af4624740e5f4a23b80398598e595a99": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Left", "disabled": false, "icon": "", "layout": "IPY_MODEL_5e1a42be168641529a554f842ba98ccf", "style": "IPY_MODEL_bb3c011a846e484d9eee1247dfc5ed6b", "tooltip": ""}}, "99f5a81aa96741baa7b801aee12f8015": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "6457012ff2774079a16c99adfaa7c49d": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "bbceed5a9dfb43a3a2374b2863e0ac66": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Right", "disabled": false, "icon": "", "layout": "IPY_MODEL_99f5a81aa96741baa7b801aee12f8015", "style": "IPY_MODEL_6457012ff2774079a16c99adfaa7c49d", "tooltip": ""}}, "95950806f92c4d3ab23b502c048c4809": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e855d20649214f83a398a10492a270e2": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "8be6b886354c45dc8f6c09e3d3a10697": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "First Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_95950806f92c4d3ab23b502c048c4809", "style": "IPY_MODEL_e855d20649214f83a398a10492a270e2"}}, "0c7baeaf382a4accada3c39692514f97": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "eb8f138b211b49a3861daa68e5d056e6": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "0e21077b80d24636aca95a6852215498": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "Second Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_0c7baeaf382a4accada3c39692514f97", "style": "IPY_MODEL_eb8f138b211b49a3861daa68e5d056e6"}}, "c9ca26f090e14521a47efb29d75b455b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a0098a0727514544a3dea602b25432ed": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "9d21f9f80e5e4c81b1987a4f3df41e1b": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Confirm Move", "disabled": false, "icon": "", "layout": "IPY_MODEL_c9ca26f090e14521a47efb29d75b455b", "style": "IPY_MODEL_a0098a0727514544a3dea602b25432ed", "tooltip": ""}}, "1ff30780b80e4420800435d9da25dd86": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "ab6b78fd7df8446e9fe97883ee113af5": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "1b6c0284035b4e70867a62c0080eb3f0": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Start", "disabled": false, "icon": "", "layout": "IPY_MODEL_1ff30780b80e4420800435d9da25dd86", "style": "IPY_MODEL_ab6b78fd7df8446e9fe97883ee113af5", "tooltip": ""}}, "14ee6d8750f74b268c17418c2ad80295": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d20f35cea85a4e34969fae0ca7488550": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [500.0, 400.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_14ee6d8750f74b268c17418c2ad80295", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_92adf665a0114a16b6c7df17340b6d67", "toolbar_position": "left", "toolbar_visible": false}}, "64555d4346834bbab5a39929074b2ffe": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "92adf665a0114a16b6c7df17340b6d67": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_64555d4346834bbab5a39929074b2ffe", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "640fbc8366d849aca6a1ca6fe859f227": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "60863361aefd451d989dff5034df0765": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [150.0, 150.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_640fbc8366d849aca6a1ca6fe859f227", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_2bba04651d76423f8fe8d02d2714c622", "toolbar_position": "left", "toolbar_visible": false}}, "73f5600bb12c465cb92ceb9f40af6ec1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2bba04651d76423f8fe8d02d2714c622": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_73f5600bb12c465cb92ceb9f40af6ec1", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "a5a0bda53d0a45ed951ef85ec259255a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f0151f538d664d539517d10e132ad9a6": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_b2f1ba59545d4eee813b58f28dcf0891", "IPY_MODEL_25ea41d5a07043b8917a831cf685769b"], "layout": "IPY_MODEL_a5a0bda53d0a45ed951ef85ec259255a"}}, "d2559027870d468b89b421e0e5cfaacd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d8bd8ea21a054952976f7c75daebbd10": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_af4624740e5f4a23b80398598e595a99", "IPY_MODEL_f0151f538d664d539517d10e132ad9a6", "IPY_MODEL_bbceed5a9dfb43a3a2374b2863e0ac66"], "layout": "IPY_MODEL_d2559027870d468b89b421e0e5cfaacd"}}, "5f2e04a860544037b0c1c430a428c2cb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "31fc40e8d6f64a0eb2b3713ad9d07b4d": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_d20f35cea85a4e34969fae0ca7488550", "IPY_MODEL_dbf9315f324b43d5a9e8a290c93ddb46"], "layout": "IPY_MODEL_5f2e04a860544037b0c1c430a428c2cb"}}, "106e112f946840c69d59a7c473a89c70": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e7ea9177b38b4f47a269be5e76e5f57e": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_1aba2637541346df9e94fb1a85a8d6ad", "IPY_MODEL_1b6c0284035b4e70867a62c0080eb3f0", "IPY_MODEL_60863361aefd451d989dff5034df0765"], "layout": "IPY_MODEL_106e112f946840c69d59a7c473a89c70"}}, "089d9c9c9dda4a7d95d13c8d3ff43101": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c144908150fa42c180831458ca2f1fa5": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_31fc40e8d6f64a0eb2b3713ad9d07b4d", "IPY_MODEL_e7ea9177b38b4f47a269be5e76e5f57e"], "layout": "IPY_MODEL_089d9c9c9dda4a7d95d13c8d3ff43101"}}, "a7493aedcd574606b2d7be695514c502": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "22.0em", "min_height": "10.0em", "min_width": "21.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "21.0em"}}, "5cb98ce6334d4d0ea3c163f77ac5e7b7": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_a7493aedcd574606b2d7be695514c502", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Click the start button to run the simulation\n"}]}}, "10635339a3d54cd5912ef9263122052d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "18.8em", "min_height": "6.3em", "min_width": "12.5em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1cc01540dae04a729024cb3d225bcb6b": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_10635339a3d54cd5912ef9263122052d", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "                P1    P2\n--------------  ----  ----\nHigh Score:     --    --\nLast Score:     --    --\nAverage Score:  --    --\n"}]}}, "30e51957d9e24f9abdd9aab045e4ec86": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": "18.8em", "min_width": "25.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c24c72a342e84169b4862b88d5e56f05": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_30e51957d9e24f9abdd9aab045e4ec86", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.core.display.Markdown object>", "text/markdown": "**Observations**"}}, {"output_type": "error", "ename": "AttributeError", "evalue": "'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'", "traceback": ["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m", "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)", "Cell \u001b[0;32mIn[1], line 3940\u001b[0m, in \u001b[0;36mComplexMoveInteractiveGridworld.__init__\u001b[0;34m(self, gridworld_game, init_board, has_fov, radius, fov_opaque, collect_fov_data, figsize, critter_names, players)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m-> 3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[1;32m   3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "Cell \u001b[0;32mIn[1], line 3941\u001b[0m, in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m   3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[0;32m-> 3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfov_eat_table_data\u001b[49m[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "\u001b[0;31mAttributeError\u001b[0m: 'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'"]}]}}, "16fda253f39e48489a10cc33d3b7f16d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "ed619b8c5c264a0ea8dc1fb75eafb395": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "5c659c021bb84b38bf8bd4bfb77299a7": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Up", "disabled": false, "icon": "", "layout": "IPY_MODEL_16fda253f39e48489a10cc33d3b7f16d", "style": "IPY_MODEL_ed619b8c5c264a0ea8dc1fb75eafb395", "tooltip": ""}}, "d316358cbd444a06a06a19aa963973f2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "b93c5bea5be742349f9b98effa39ebfb": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "bdac51037be94bf3aee6e90c4e573444": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Down", "disabled": false, "icon": "", "layout": "IPY_MODEL_d316358cbd444a06a06a19aa963973f2", "style": "IPY_MODEL_b93c5bea5be742349f9b98effa39ebfb", "tooltip": ""}}, "9039737655364889b74b9a521a248e70": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "aa51844f2c2e4cb08fd43c04a2df22ec": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "fbda44dea444475f8f7b94e3e1dbc6ed": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Left", "disabled": false, "icon": "", "layout": "IPY_MODEL_9039737655364889b74b9a521a248e70", "style": "IPY_MODEL_aa51844f2c2e4cb08fd43c04a2df22ec", "tooltip": ""}}, "4070cd98620d4b24bdf07b029ef59faa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "5f5279cef82145e88c710c7a0a2e32dc": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "64fa8fc6c6a549bfbd3a49b7cb5be104": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Right", "disabled": false, "icon": "", "layout": "IPY_MODEL_4070cd98620d4b24bdf07b029ef59faa", "style": "IPY_MODEL_5f5279cef82145e88c710c7a0a2e32dc", "tooltip": ""}}, "8387efc68d7d43bcb9acb0770f08219e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a1645adc1fe8428997e6c65494ab06f0": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "3abc8a1747c34a7894391d9d8e3cf90e": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "First Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_8387efc68d7d43bcb9acb0770f08219e", "style": "IPY_MODEL_a1645adc1fe8428997e6c65494ab06f0"}}, "a929aba544d44ba2bfe3ba8de77e28ad": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "64ec4d0f496e4f128b96bba3d87e81e0": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "ac80c5b0a6524aa08b98bdf5e08c4caf": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "Second Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_a929aba544d44ba2bfe3ba8de77e28ad", "style": "IPY_MODEL_64ec4d0f496e4f128b96bba3d87e81e0"}}, "6328bc37912347fbb958d534935ff287": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "70c25fe730084e9b8e207a73b4b22aa4": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "5375ad44288d4fadb38c39cafbee5c4b": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Confirm Move", "disabled": false, "icon": "", "layout": "IPY_MODEL_6328bc37912347fbb958d534935ff287", "style": "IPY_MODEL_70c25fe730084e9b8e207a73b4b22aa4", "tooltip": ""}}, "df6c60d0cca8463c873d2cd552a53fbd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "732745cd7dea474b80e5c024bdb9bdc9": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "39cff9d5fe7b4e3b922ed49159ec2c8f": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Start", "disabled": false, "icon": "", "layout": "IPY_MODEL_df6c60d0cca8463c873d2cd552a53fbd", "style": "IPY_MODEL_732745cd7dea474b80e5c024bdb9bdc9", "tooltip": ""}}, "322f3c84c2c34781a3ac12fe21a0c630": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1399d20777ce4d5a92ed40e5de269005": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [500.0, 400.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_322f3c84c2c34781a3ac12fe21a0c630", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_b5537b0c6483464c92ba0cb52b8dd061", "toolbar_position": "left", "toolbar_visible": false}}, "c7af80fe62974f9cb4cc6163fb0860c9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b5537b0c6483464c92ba0cb52b8dd061": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_c7af80fe62974f9cb4cc6163fb0860c9", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "94b9397b0d9a4cc89813a250f83ff606": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a0c8e66e333d4030bc9e7066044dcd8d": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [150.0, 150.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_94b9397b0d9a4cc89813a250f83ff606", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_5d11fcb8751c485b9a1c69f6dd492ccc", "toolbar_position": "left", "toolbar_visible": false}}, "0c1f7c5ad3a041728aea446051e5022e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5d11fcb8751c485b9a1c69f6dd492ccc": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_0c1f7c5ad3a041728aea446051e5022e", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "636474a14eb54d308b0977fab55a12dc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5ee5ca2462f94bcc9038adcae185c165": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_5c659c021bb84b38bf8bd4bfb77299a7", "IPY_MODEL_bdac51037be94bf3aee6e90c4e573444"], "layout": "IPY_MODEL_636474a14eb54d308b0977fab55a12dc"}}, "695029b607b445edb71b2342e190e33e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "50dfb8e6241946efb9606e0bf42b066f": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_fbda44dea444475f8f7b94e3e1dbc6ed", "IPY_MODEL_5ee5ca2462f94bcc9038adcae185c165", "IPY_MODEL_64fa8fc6c6a549bfbd3a49b7cb5be104"], "layout": "IPY_MODEL_695029b607b445edb71b2342e190e33e"}}, "16dd2430817a43c1b074d1392fe44cd0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "02398a57d4084cf4a30ee54174a662e4": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_1399d20777ce4d5a92ed40e5de269005", "IPY_MODEL_5cb98ce6334d4d0ea3c163f77ac5e7b7"], "layout": "IPY_MODEL_16dd2430817a43c1b074d1392fe44cd0"}}, "46a6ad63833e4b199da120a9956e6fb2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c9822ce8320840549c75e6acf0db99c6": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_1cc01540dae04a729024cb3d225bcb6b", "IPY_MODEL_39cff9d5fe7b4e3b922ed49159ec2c8f", "IPY_MODEL_a0c8e66e333d4030bc9e7066044dcd8d"], "layout": "IPY_MODEL_46a6ad63833e4b199da120a9956e6fb2"}}, "63d5c2b619b64ff88f8a7c98db49019f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4576a6c2f43c424fa0ece2b51134cfc8": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_02398a57d4084cf4a30ee54174a662e4", "IPY_MODEL_c9822ce8320840549c75e6acf0db99c6"], "layout": "IPY_MODEL_63d5c2b619b64ff88f8a7c98db49019f"}}, "eb5adf335bd24b6eb98acc3f7546fb27": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "16a9c96660a24d6ab4aeacea13cab6d7": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_weight": ""}}, "f39fb315a1d846d492d48bb982ee078f": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_eb5adf335bd24b6eb98acc3f7546fb27", "style": "IPY_MODEL_16a9c96660a24d6ab4aeacea13cab6d7", "tooltip": "happy"}}, "2e13282cbb7f443ab910deff573035f7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "5c5d8b8a63bf424e97703ac5cf133f3c": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_weight": ""}}, "100f9c1db540400e9ffdece150dd95ab": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_2e13282cbb7f443ab910deff573035f7", "style": "IPY_MODEL_5c5d8b8a63bf424e97703ac5cf133f3c", "tooltip": "medium"}}, "da30263216c743e7947c60fa9a58388b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "ba1b8e87bb70435ea702e6afaef65b1d": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_weight": ""}}, "7a170e30144d49f4b65bf9f3c0956335": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_da30263216c743e7947c60fa9a58388b", "style": "IPY_MODEL_ba1b8e87bb70435ea702e6afaef65b1d", "tooltip": "sad"}}, "a9ffcd39dcff47aeab6cf3359faa118f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "22e7e5407c5942649182a9b76db6d887": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "ce7daf51a16f484ea6b383bb8c9a0e10": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_a9ffcd39dcff47aeab6cf3359faa118f", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_22e7e5407c5942649182a9b76db6d887", "value": ""}}, "7d47365cfaf1493d907e51bbff1e29b4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "c1a60530661942dc8b75c108dc2a746b": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "404076563d8d4f33b97935b1150886f8": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_7d47365cfaf1493d907e51bbff1e29b4", "style": "IPY_MODEL_c1a60530661942dc8b75c108dc2a746b", "tooltip": ""}}, "12ae003e2b384d9e939ded5500157457": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "90d7245f9e3f4d809aabae5cd69fdafd": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_ce7daf51a16f484ea6b383bb8c9a0e10", "IPY_MODEL_404076563d8d4f33b97935b1150886f8"], "layout": "IPY_MODEL_12ae003e2b384d9e939ded5500157457"}}, "d11c53fa48ba4a0ebccf8055642f057a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b137ab8446ce422f93c13cc7798be3ef": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "755016c5ae954120be3ba947408be84e": {"model_name": "LabelModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_d11c53fa48ba4a0ebccf8055642f057a", "placeholder": "\u200b", "style": "IPY_MODEL_b137ab8446ce422f93c13cc7798be3ef", "value": "Thanks for your feedback!"}}, "91f5b881ad3647eaa99013f6ce5d1bfe": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dbb9456a2e1e4632b2b5fd294a84d2e8": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_f39fb315a1d846d492d48bb982ee078f", "IPY_MODEL_100f9c1db540400e9ffdece150dd95ab", "IPY_MODEL_7a170e30144d49f4b65bf9f3c0956335"], "layout": "IPY_MODEL_91f5b881ad3647eaa99013f6ce5d1bfe"}}, "f12dd058080f4201bf0fbc96fa60e810": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2769c2077a6740c3afa81dd77a044f37": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_dbb9456a2e1e4632b2b5fd294a84d2e8", "IPY_MODEL_90d7245f9e3f4d809aabae5cd69fdafd", "IPY_MODEL_755016c5ae954120be3ba947408be84e"], "layout": "IPY_MODEL_f12dd058080f4201bf0fbc96fa60e810"}}, "f1e2943e16dd4bfc86c8ae3bbd5e76b0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b617a1526951436f8b33eb1591f59700": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_2769c2077a6740c3afa81dd77a044f37"], "layout": "IPY_MODEL_f1e2943e16dd4bfc86c8ae3bbd5e76b0"}}, "2a3565183fcd486fa230c7c3497dd920": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "22.0em", "min_height": "10.0em", "min_width": "21.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "21.0em"}}, "bbade4f0420f4a9e888f661396fcf0b7": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_2a3565183fcd486fa230c7c3497dd920", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Click the start button to run the simulation\n"}]}}, "e7758b879ef94b769546db7174357bb3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": "18.8em", "min_height": "6.3em", "min_width": "12.5em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "102e19e816284bc18bd3c1cc505e45ae": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_e7758b879ef94b769546db7174357bb3", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "                P1    P2\n--------------  ----  ----\nHigh Score:     --    --\nLast Score:     --    --\nAverage Score:  --    --\n"}]}}, "c510efa9c6964f9e8eb17772890e64d3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": "18.8em", "min_width": "25.0em", "object_fit": null, "object_position": null, "order": null, "overflow": "auto", "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f6f083e146b4479580d073b602940b61": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_c510efa9c6964f9e8eb17772890e64d3", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.core.display.Markdown object>", "text/markdown": "**Observations**"}}, {"output_type": "error", "ename": "AttributeError", "evalue": "'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'", "traceback": ["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m", "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)", "Cell \u001b[0;32mIn[1], line 3940\u001b[0m, in \u001b[0;36mComplexMoveInteractiveGridworld.__init__\u001b[0;34m(self, gridworld_game, init_board, has_fov, radius, fov_opaque, collect_fov_data, figsize, critter_names, players)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m-> 3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[1;32m   3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "Cell \u001b[0;32mIn[1], line 3941\u001b[0m, in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m   3938\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_display:\n\u001b[1;32m   3939\u001b[0m   printmd(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m**Observations**\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m   3940\u001b[0m   table_data \u001b[38;5;241m=\u001b[39m [[\u001b[38;5;28mstr\u001b[39m(ii),\n\u001b[0;32m-> 3941\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfov_eat_table_data\u001b[49m[\u001b[38;5;241m0\u001b[39m,ii]),\n\u001b[1;32m   3942\u001b[0m                  \u001b[38;5;28mstr\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfov_eat_table_data[\u001b[38;5;241m1\u001b[39m,ii])] \u001b[38;5;28;01mfor\u001b[39;00m ii \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;241m11\u001b[39m)]\n\u001b[1;32m   3943\u001b[0m   table \u001b[38;5;241m=\u001b[39m ([[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood in Percept\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Not Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mFood Eaten\u001b[39m\u001b[38;5;124m'\u001b[39m]] \u001b[38;5;241m+\u001b[39m\n\u001b[1;32m   3944\u001b[0m            table_data)\n\u001b[1;32m   3945\u001b[0m   \u001b[38;5;28mprint\u001b[39m(tabulate(table))\n", "\u001b[0;31mAttributeError\u001b[0m: 'ComplexMoveInteractiveGridworld' object has no attribute 'fov_eat_table_data'"]}]}}, "acc2af53df4e49f7b548037bdfc54097": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "89b1176be45846ce8b7dcf9dc6e5d29e": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "5ecc82fd08fd462689981185abcd3b5b": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Up", "disabled": false, "icon": "", "layout": "IPY_MODEL_acc2af53df4e49f7b548037bdfc54097", "style": "IPY_MODEL_89b1176be45846ce8b7dcf9dc6e5d29e", "tooltip": ""}}, "691bc9c7e3914448b536022f2ed026b7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "05824a7915a94bde950765ae2c4fda6a": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "723e3dbf73a94ed6b44fc0a656892c49": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Down", "disabled": false, "icon": "", "layout": "IPY_MODEL_691bc9c7e3914448b536022f2ed026b7", "style": "IPY_MODEL_05824a7915a94bde950765ae2c4fda6a", "tooltip": ""}}, "1e2b882230bb40b19d29322afff50b53": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "0ee0624d990641e2b4635c9a54b0b5fc": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "b43fbbad2553407fa7a8d7851f00a870": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Left", "disabled": false, "icon": "", "layout": "IPY_MODEL_1e2b882230bb40b19d29322afff50b53", "style": "IPY_MODEL_0ee0624d990641e2b4635c9a54b0b5fc", "tooltip": ""}}, "f686dd2a3ca846309610cc22b5883871": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "84830bd01d244d1a8e0d4a240cc852d7": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "d1605b8f964846039daa2ed8a42cfa87": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Right", "disabled": false, "icon": "", "layout": "IPY_MODEL_f686dd2a3ca846309610cc22b5883871", "style": "IPY_MODEL_84830bd01d244d1a8e0d4a240cc852d7", "tooltip": ""}}, "28580f06462743d5afeaa4667df7b512": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b7493b7042d64d24815368b16abe47ae": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "740a1574c1cb4deb80fe5ad6e5884aa2": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "First Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_28580f06462743d5afeaa4667df7b512", "style": "IPY_MODEL_b7493b7042d64d24815368b16abe47ae"}}, "f5abc1ed1fa64a90b87d473ab627422e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "faa435f0dc1d47fb956932f258be79fd": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "c9f3b8676b9a460a91bbf00dbc81a48a": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["Stay", "Up", "Down", "Left", "Right"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "Second Move Part:", "description_tooltip": null, "disabled": false, "index": 0, "layout": "IPY_MODEL_f5abc1ed1fa64a90b87d473ab627422e", "style": "IPY_MODEL_faa435f0dc1d47fb956932f258be79fd"}}, "d3fad642c05347dabe635a0b62414793": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "94c7929b290543dfab13acfb48495b91": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "59791989f1604ff0a610c6687604d1b9": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Confirm Move", "disabled": false, "icon": "", "layout": "IPY_MODEL_d3fad642c05347dabe635a0b62414793", "style": "IPY_MODEL_94c7929b290543dfab13acfb48495b91", "tooltip": ""}}, "08a6d581f0ff4da99a7949a4f8ed02a1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "6.3em"}}, "83d0910fed5a4112bf07f81a2a6dbac5": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "1b43cbd877d041e0b72f8786a9ca74b5": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Start", "disabled": false, "icon": "", "layout": "IPY_MODEL_08a6d581f0ff4da99a7949a4f8ed02a1", "style": "IPY_MODEL_83d0910fed5a4112bf07f81a2a6dbac5", "tooltip": ""}}, "ab72d4dcba354619ad4ab730d0dd5e95": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4296d0368d8f48128815f1d5f6357245": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [500.0, 400.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_ab72d4dcba354619ad4ab730d0dd5e95", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_0282855cfc324c8d99cc16b89dcdc0de", "toolbar_position": "left", "toolbar_visible": false}}, "36e3d62a4d6f417d907b2d4b348ec211": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0282855cfc324c8d99cc16b89dcdc0de": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_36e3d62a4d6f417d907b2d4b348ec211", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "41a78f409f6f4c8fb4ada194c7b43d91": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9822d93ee1604e1ebc937d4c4bbf458b": {"model_name": "MPLCanvasModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_cursor": "default", "_data_url": "data:image/png;base64,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", "_dom_classes": [], "_figure_label": "Figure", "_image_mode": "full", "_message": "", "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "MPLCanvasModel", "_rubberband_height": 0, "_rubberband_width": 0, "_rubberband_x": 0, "_rubberband_y": 0, "_size": [150.0, 150.0], "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "MPLCanvasView", "capture_scroll": false, "footer_visible": false, "header_visible": false, "layout": "IPY_MODEL_41a78f409f6f4c8fb4ada194c7b43d91", "pan_zoom_throttle": 33.0, "resizable": false, "toolbar": "IPY_MODEL_868f7693691b468f9b6b6cd317014c7d", "toolbar_position": "left", "toolbar_visible": false}}, "3ecf1988711a49ff86114e6b1d1a9850": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "868f7693691b468f9b6b6cd317014c7d": {"model_name": "ToolbarModel", "model_module": "jupyter-matplotlib", "model_module_version": "^0.11", "state": {"_current_action": "", "_dom_classes": [], "_model_module": "jupyter-matplotlib", "_model_module_version": "^0.11", "_model_name": "ToolbarModel", "_view_count": null, "_view_module": "jupyter-matplotlib", "_view_module_version": "^0.11", "_view_name": "ToolbarView", "button_style": "", "collapsed": true, "layout": "IPY_MODEL_3ecf1988711a49ff86114e6b1d1a9850", "orientation": "vertical", "toolitems": [["Home", "Reset original view", "home", "home"], ["Back", "Back to previous view", "arrow-left", "back"], ["Forward", "Forward to next view", "arrow-right", "forward"], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "arrows", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "square-o", "zoom"], ["Download", "Download plot", "floppy-o", "save_figure"]]}}, "13c41b89fe7d4cafbee8ffe9f7f0f86e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a13017baa1e14860a1e521892087418f": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_5ecc82fd08fd462689981185abcd3b5b", "IPY_MODEL_723e3dbf73a94ed6b44fc0a656892c49"], "layout": "IPY_MODEL_13c41b89fe7d4cafbee8ffe9f7f0f86e"}}, "605c2a9950b64110b75ef168578e4f07": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c2c85d4ec24547f48ced004ff7f2f0a0": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_b43fbbad2553407fa7a8d7851f00a870", "IPY_MODEL_a13017baa1e14860a1e521892087418f", "IPY_MODEL_d1605b8f964846039daa2ed8a42cfa87"], "layout": "IPY_MODEL_605c2a9950b64110b75ef168578e4f07"}}, "8d13d0d53b184020856b4f26c103c1b4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e90540f932fb457d925ff4c5cb3eec69": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_4296d0368d8f48128815f1d5f6357245", "IPY_MODEL_bbade4f0420f4a9e888f661396fcf0b7"], "layout": "IPY_MODEL_8d13d0d53b184020856b4f26c103c1b4"}}, "2dfa3c1749a540dfb0c058e6161c5781": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6270d92e0b9145c8862a086f77a98f30": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_102e19e816284bc18bd3c1cc505e45ae", "IPY_MODEL_1b43cbd877d041e0b72f8786a9ca74b5", "IPY_MODEL_9822d93ee1604e1ebc937d4c4bbf458b"], "layout": "IPY_MODEL_2dfa3c1749a540dfb0c058e6161c5781"}}, "de4fec0a9b1c4c8eb22a2ef686a397fd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3925268701bb42888e53392f19a962ac": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_e90540f932fb457d925ff4c5cb3eec69", "IPY_MODEL_6270d92e0b9145c8862a086f77a98f30"], "layout": "IPY_MODEL_de4fec0a9b1c4c8eb22a2ef686a397fd"}}, "7f11818ff0094990a54ae70bd01067fc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "5f6caec97a3d4f01a0dc3e467334f2c6": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_weight": ""}}, "b4f498ef0a174769acb29b376c090b25": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_7f11818ff0094990a54ae70bd01067fc", "style": "IPY_MODEL_5f6caec97a3d4f01a0dc3e467334f2c6", "tooltip": "happy"}}, "d44e12eb85714c42afecf5d2b54249b8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "631cf32a55ab4a83bc4ecfc61cab8c0f": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_weight": ""}}, "f103fccc6b7d44abba22dd684aff8d1e": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_d44e12eb85714c42afecf5d2b54249b8", "style": "IPY_MODEL_631cf32a55ab4a83bc4ecfc61cab8c0f", "tooltip": "medium"}}, "ce37b493a5d748808dd90e9a449637cc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "7a9f3b990ce9441e8c761a86b3d1fd79": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_weight": ""}}, "8f71a20c0b90406ca141be33c5b6824b": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_ce37b493a5d748808dd90e9a449637cc", "style": "IPY_MODEL_7a9f3b990ce9441e8c761a86b3d1fd79", "tooltip": "sad"}}, "b61767c297f943e39c5c16853bed66a6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "216c06d687fa491a9831966770f557c8": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "36eafbf08bdb41a2898a87f97bed074e": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_b61767c297f943e39c5c16853bed66a6", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_216c06d687fa491a9831966770f557c8", "value": ""}}, "b4656d230fc942548dadf95afba6a977": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "78bb2ae80f0b4fcfb963ac0eb7f2344a": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "2fde8724941d42b3ad2ec80fd6091e68": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_b4656d230fc942548dadf95afba6a977", "style": "IPY_MODEL_78bb2ae80f0b4fcfb963ac0eb7f2344a", "tooltip": ""}}, "70f4cdf3bc9744a3bc35e14c2ab4c8f6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b227cf511600413fab4ce97ac48ca499": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_36eafbf08bdb41a2898a87f97bed074e", "IPY_MODEL_2fde8724941d42b3ad2ec80fd6091e68"], "layout": "IPY_MODEL_70f4cdf3bc9744a3bc35e14c2ab4c8f6"}}, "b54943c4797842f3bc197c45d186cea6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1c3c11ef23ed47269df65fd5b45e5ee1": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "367fd85902014d9587fff1ab8e6312ac": {"model_name": "LabelModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_b54943c4797842f3bc197c45d186cea6", "placeholder": "\u200b", "style": "IPY_MODEL_1c3c11ef23ed47269df65fd5b45e5ee1", "value": "Thanks for your feedback!"}}, "e0e5be5fb0094a3e8d9d406f8c044b12": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ab75610d9aca490c90e733113e43c931": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_b4f498ef0a174769acb29b376c090b25", "IPY_MODEL_f103fccc6b7d44abba22dd684aff8d1e", "IPY_MODEL_8f71a20c0b90406ca141be33c5b6824b"], "layout": "IPY_MODEL_e0e5be5fb0094a3e8d9d406f8c044b12"}}, "c72a9a939c5040d6a2aa4c594b879f7e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bb5788fbe85046f295fb5f4c4b6638aa": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_ab75610d9aca490c90e733113e43c931", "IPY_MODEL_b227cf511600413fab4ce97ac48ca499", "IPY_MODEL_367fd85902014d9587fff1ab8e6312ac"], "layout": "IPY_MODEL_c72a9a939c5040d6a2aa4c594b879f7e"}}, "3e3c0dd8b9e24a5fbde39e66b2c8bd11": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c1f0507712da4b3f8930260a7fdc5fce": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_bb5788fbe85046f295fb5f4c4b6638aa"], "layout": "IPY_MODEL_3e3c0dd8b9e24a5fbde39e66b2c8bd11"}}}, "version_major": 2, "version_minor": 0}
</script>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./sequences/P1C3_RealEvolution/student"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
</div></main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="P1C3_Sequence2.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title"><strong>1.3.2: Why Sex</strong></p>
</div>
</a>
<a class="right-next" href="P1C3_Sequence4.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title"><strong>1.3.4: Learning and Evolution</strong></p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>